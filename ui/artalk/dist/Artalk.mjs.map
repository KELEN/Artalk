{"version":3,"file":"Artalk.mjs","sources":["../src/api/v2.ts","../src/api/fetch.ts","../src/api/handler.ts","../src/api/index.ts","../../../node_modules/.pnpm/marked@12.0.2/node_modules/marked/lib/marked.esm.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/she.js","../../../node_modules/.pnpm/assignment@2.0.0/node_modules/assignment/assignment.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/lowercase.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/toMap.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/attributes.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/elements.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/parser.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/sanitizer.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/defaults.js","../../../node_modules/.pnpm/insane@2.6.2/node_modules/insane/insane.js","../src/lib/sanitizer.ts","../../../node_modules/.pnpm/hanabi@0.4.0/node_modules/hanabi/dist/hanabi.js","../src/lib/highlight.ts","../src/lib/marked-renderer.ts","../src/lib/marked.ts","../src/lib/merge-deep.ts","../src/data.ts","../src/lib/utils.ts","../src/i18n/en.ts","../src/i18n/zh-CN.ts","../src/i18n/external.ts","../src/i18n/index.ts","../src/lib/event-manager.ts","../src/defaults.ts","../src/config.ts","../src/lib/watch-conf.ts","../src/context.ts","../src/lib/ui.ts","../src/components/checker/captcha-renders.ts","../src/components/checker/captcha.ts","../src/components/checker/admin.ts","../src/components/dialog.ts","../src/components/checker/index.ts","../src/lib/component.ts","../src/editor/editor.html?raw","../src/editor/ui.ts","../src/plugins/editor/_plug.ts","../src/plugins/editor/mover.ts","../src/editor/state.ts","../src/editor/editor.ts","../src/layer/sidebar-layer.html?raw","../src/layer/sidebar-layer.ts","../src/list/list.html?raw","../src/list/nest.ts","../src/list/layout/nest.ts","../src/list/layout/flat.ts","../src/list/layout/index.ts","../src/lib/detect.ts","../src/comment/height-limit.ts","../src/comment/comment.html?raw","../src/comment/renders/avatar.ts","../src/comment/renders/header.ts","../src/comment/renders/content.ts","../src/comment/renders/reply-at.ts","../src/comment/renders/reply-to.ts","../src/comment/renders/pending.ts","../src/components/action-btn.ts","../src/comment/renders/actions.ts","../src/comment/renders/index.ts","../src/comment/render.ts","../src/comment/actions.ts","../src/comment/comment-node.ts","../src/list/comment.ts","../src/components/read-more-btn.ts","../src/list/paginator/read-more.ts","../src/components/pagination.ts","../src/list/paginator/up-down.ts","../src/list/page.ts","../src/list/list.ts","../src/layer/scrollbar-helper.ts","../src/layer/layer.ts","../src/layer/wrap.ts","../src/layer/layer-manager.ts","../src/lib/user.ts","../src/service.ts","../src/plugins/stat.ts","../src/plugins/markdown.ts","../src/plugins/editor/local-storage.ts","../src/plugins/editor/textarea.ts","../src/plugins/editor/submit-btn.ts","../src/plugins/editor/submit-add.ts","../src/plugins/editor/submit.ts","../src/plugins/editor/state-reply.ts","../src/plugins/editor/state-edit.ts","../src/plugins/editor/closable.ts","../src/plugins/editor/header-event.ts","../src/plugins/editor/header-user.ts","../src/plugins/editor/emoticons.ts","../src/plugins/editor/upload.ts","../src/plugins/editor/preview.ts","../src/plugins/editor/index.ts","../src/plugins/editor/_kit.ts","../src/plugins/editor-kit.ts","../src/plugins/list/with-editor.ts","../src/plugins/list/unread.ts","../src/plugins/list/count.ts","../src/plugins/list/unread-badge.ts","../src/plugins/list/goto-dispatcher.ts","../src/plugins/list/goto-focus.ts","../src/plugins/list/copyright.ts","../src/plugins/list/no-comment.ts","../src/plugins/list/dropdown.ts","../src/plugins/list/time-ticking.ts","../src/components/error-dialog.ts","../src/plugins/list/error-dialog.ts","../src/plugins/list/loading.ts","../src/plugins/list/fetch.ts","../src/plugins/list/reach-bottom.ts","../src/plugins/list/goto-first.ts","../src/plugins/list/index.ts","../src/plugins/notifies.ts","../src/plugins/version-check.ts","../src/plugins/admin-only-elem.ts","../src/plugins/dark-mode.ts","../src/plugins/index.ts","../src/load.ts","../src/artalk.ts","../src/main.ts"],"sourcesContent":["/* eslint-disable */\r\n/* tslint:disable */\r\n/*\r\n * ---------------------------------------------------------------\r\n * ## THIS FILE WAS GENERATED VIA SWAGGER-TYPESCRIPT-API        ##\r\n * ##                                                           ##\r\n * ## AUTHOR: acacode                                           ##\r\n * ## SOURCE: https://github.com/acacode/swagger-typescript-api ##\r\n * ---------------------------------------------------------------\r\n */\r\n\r\nexport interface AuthAuthProviderInfo {\r\n  icon: string\r\n  label: string\r\n  name: string\r\n  path?: string\r\n}\r\n\r\nexport interface CommonApiVersionData {\r\n  app: string\r\n  commit_hash: string\r\n  version: string\r\n}\r\n\r\nexport interface CommonConfData {\r\n  frontend_conf: CommonMap\r\n  version: CommonApiVersionData\r\n}\r\n\r\nexport interface CommonJSONResult {\r\n  /** Data */\r\n  data: any\r\n  /** Message */\r\n  msg: string\r\n}\r\n\r\nexport type CommonMap = Record<string, any>\r\n\r\nexport interface EntityCookedComment {\r\n  badge_color: string\r\n  badge_name: string\r\n  content: string\r\n  content_marked: string\r\n  date: string\r\n  email_encrypted: string\r\n  id: number\r\n  ip_region: string\r\n  is_allow_reply: boolean\r\n  is_collapsed: boolean\r\n  is_pending: boolean\r\n  is_pinned: boolean\r\n  is_verified: boolean\r\n  link: string\r\n  nick: string\r\n  page_key: string\r\n  page_url: string\r\n  rid: number\r\n  site_name: string\r\n  ua: string\r\n  user_id: number\r\n  visible: boolean\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface EntityCookedNotify {\r\n  comment_id: number\r\n  id: number\r\n  is_emailed: boolean\r\n  is_read: boolean\r\n  read_link: string\r\n  user_id: number\r\n}\r\n\r\nexport interface EntityCookedPage {\r\n  admin_only: boolean\r\n  date: string\r\n  id: number\r\n  key: string\r\n  pv: number\r\n  site_name: string\r\n  title: string\r\n  url: string\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface EntityCookedSite {\r\n  first_url: string\r\n  id: number\r\n  name: string\r\n  urls: string[]\r\n  urls_raw: string\r\n}\r\n\r\nexport interface EntityCookedUser {\r\n  badge_color: string\r\n  badge_name: string\r\n  email: string\r\n  id: number\r\n  is_admin: boolean\r\n  link: string\r\n  name: string\r\n  receive_email: boolean\r\n}\r\n\r\nexport interface EntityCookedUserForAdmin {\r\n  badge_color: string\r\n  badge_name: string\r\n  comment_count: number\r\n  email: string\r\n  id: number\r\n  is_admin: boolean\r\n  is_in_conf: boolean\r\n  last_ip: string\r\n  last_ua: string\r\n  link: string\r\n  name: string\r\n  receive_email: boolean\r\n}\r\n\r\nexport type HandlerMap = Record<string, any>\r\n\r\nexport interface HandlerParamsCaptchaVerify {\r\n  /** The captcha value to check */\r\n  value: string\r\n}\r\n\r\nexport interface HandlerParamsCommentCreate {\r\n  /** The comment content */\r\n  content: string\r\n  /** The comment email */\r\n  email: string\r\n  /** The comment link */\r\n  link?: string\r\n  /** The comment name */\r\n  name: string\r\n  /** The comment page_key */\r\n  page_key: string\r\n  /** The comment page_title */\r\n  page_title?: string\r\n  /** The comment rid */\r\n  rid?: number\r\n  /** The site name of your content scope */\r\n  site_name: string\r\n  /** The comment ua */\r\n  ua?: string\r\n}\r\n\r\nexport interface HandlerParamsCommentUpdate {\r\n  /** The comment content */\r\n  content: string\r\n  /** The comment email */\r\n  email?: string\r\n  /** The comment ip */\r\n  ip?: string\r\n  /** The comment is_collapsed */\r\n  is_collapsed: boolean\r\n  /** The comment is_pending */\r\n  is_pending: boolean\r\n  /** The comment is_pinned */\r\n  is_pinned: boolean\r\n  /** The comment link */\r\n  link?: string\r\n  /** The comment nick */\r\n  nick?: string\r\n  /** The comment page_key */\r\n  page_key: string\r\n  /** The comment rid */\r\n  rid: number\r\n  /** The site name of your content scope */\r\n  site_name: string\r\n  /** The comment ua */\r\n  ua?: string\r\n}\r\n\r\nexport interface HandlerParamsEmailSend {\r\n  /** The body of email */\r\n  body: string\r\n  /** The subject of email */\r\n  subject: string\r\n  /** The email address of the receiver */\r\n  to_addr: string\r\n}\r\n\r\nexport interface HandlerParamsNotifyReadAll {\r\n  /** The user email */\r\n  email: string\r\n  /** The username */\r\n  name: string\r\n}\r\n\r\nexport interface HandlerParamsPageFetchAll {\r\n  /** If not empty, only fetch pages of this site */\r\n  site_name?: string\r\n}\r\n\r\nexport interface HandlerParamsPagePV {\r\n  /** The page key */\r\n  page_key: string\r\n  /** The page title */\r\n  page_title?: string\r\n  /** The site name of your content scope */\r\n  site_name?: string\r\n}\r\n\r\nexport interface HandlerParamsPageUpdate {\r\n  /** Updated page admin_only option */\r\n  admin_only: boolean\r\n  /** Updated page key */\r\n  key: string\r\n  /** The site name of your content scope */\r\n  site_name: string\r\n  /** Updated page title */\r\n  title: string\r\n}\r\n\r\nexport interface HandlerParamsSettingApply {\r\n  /** The content of the config file in YAML format */\r\n  yaml: string\r\n}\r\n\r\nexport interface HandlerParamsSiteCreate {\r\n  /** The site name */\r\n  name: string\r\n  /** The site urls */\r\n  urls: string[]\r\n}\r\n\r\nexport interface HandlerParamsSiteUpdate {\r\n  /** Updated site name */\r\n  name: string\r\n  /** Updated site urls */\r\n  urls: string[]\r\n}\r\n\r\nexport interface HandlerParamsTransferImport {\r\n  /** Automatically answer yes for all questions */\r\n  assumeyes?: boolean\r\n  /** The JSON data */\r\n  json_data?: string\r\n  /** The JSON file path */\r\n  json_file?: string\r\n  /** The target site name */\r\n  target_site_name?: string\r\n  /** The target site url */\r\n  target_site_url?: string\r\n  /** Keep domain */\r\n  url_keep_domain?: boolean\r\n  /** Enable URL resolver */\r\n  url_resolver?: boolean\r\n}\r\n\r\nexport interface HandlerParamsUserCreate {\r\n  /** The user badge color (hex format) */\r\n  badge_color?: string\r\n  /** The user badge name */\r\n  badge_name?: string\r\n  /** The user email */\r\n  email: string\r\n  /** The user is an admin */\r\n  is_admin: boolean\r\n  /** The user link */\r\n  link?: string\r\n  /** The user name */\r\n  name: string\r\n  /** The user password */\r\n  password?: string\r\n  /** The user receive email */\r\n  receive_email: boolean\r\n}\r\n\r\nexport interface HandlerParamsUserLogin {\r\n  /** The user email */\r\n  email: string\r\n  /** The username */\r\n  name?: string\r\n  /** The user password */\r\n  password: string\r\n}\r\n\r\nexport interface HandlerParamsUserUpdate {\r\n  /** The user badge color (hex format) */\r\n  badge_color?: string\r\n  /** The user badge name */\r\n  badge_name?: string\r\n  /** The user email */\r\n  email: string\r\n  /** The user is an admin */\r\n  is_admin: boolean\r\n  /** The user link */\r\n  link?: string\r\n  /** The user name */\r\n  name: string\r\n  /** The user password */\r\n  password?: string\r\n  /** The user receive email */\r\n  receive_email: boolean\r\n}\r\n\r\nexport interface HandlerParamsVote {\r\n  /** The user email */\r\n  email?: string\r\n  /** The username */\r\n  name?: string\r\n}\r\n\r\nexport interface HandlerRequestAuthDataMergeApply {\r\n  user_name: string\r\n}\r\n\r\nexport interface HandlerRequestAuthEmailLogin {\r\n  code?: string\r\n  email: string\r\n  password?: string\r\n}\r\n\r\nexport interface HandlerRequestAuthEmailRegister {\r\n  code: string\r\n  email: string\r\n  link?: string\r\n  name?: string\r\n  password: string\r\n}\r\n\r\nexport interface HandlerRequestAuthEmailSend {\r\n  email: string\r\n}\r\n\r\nexport interface HandlerResponseAdminUserList {\r\n  count: number\r\n  users: EntityCookedUserForAdmin[]\r\n}\r\n\r\nexport interface HandlerResponseAuthDataMergeApply {\r\n  deleted_user_count: number\r\n  update_comments_count: number\r\n  update_notifies_count: number\r\n  update_votes_count: number\r\n  /** Empty if login user is target user no need to re-login */\r\n  user_token: string\r\n}\r\n\r\nexport interface HandlerResponseAuthDataMergeCheck {\r\n  need_merge: boolean\r\n  user_names: string[]\r\n}\r\n\r\nexport interface HandlerResponseCaptchaGet {\r\n  img_data: string\r\n}\r\n\r\nexport interface HandlerResponseCaptchaStatus {\r\n  is_pass: boolean\r\n}\r\n\r\nexport interface HandlerResponseCommentCreate {\r\n  badge_color: string\r\n  badge_name: string\r\n  content: string\r\n  content_marked: string\r\n  date: string\r\n  email_encrypted: string\r\n  id: number\r\n  ip_region: string\r\n  is_allow_reply: boolean\r\n  is_collapsed: boolean\r\n  is_pending: boolean\r\n  is_pinned: boolean\r\n  is_verified: boolean\r\n  link: string\r\n  nick: string\r\n  page_key: string\r\n  page_url: string\r\n  rid: number\r\n  site_name: string\r\n  ua: string\r\n  user_id: number\r\n  visible: boolean\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface HandlerResponseCommentGet {\r\n  /** The comment detail */\r\n  comment: EntityCookedComment\r\n  /** The reply comment if exists (like reply) */\r\n  reply_comment: EntityCookedComment\r\n}\r\n\r\nexport interface HandlerResponseCommentList {\r\n  comments: EntityCookedComment[]\r\n  count: number\r\n  page: EntityCookedPage\r\n  roots_count: number\r\n}\r\n\r\nexport interface HandlerResponseCommentUpdate {\r\n  badge_color: string\r\n  badge_name: string\r\n  content: string\r\n  content_marked: string\r\n  date: string\r\n  email_encrypted: string\r\n  id: number\r\n  ip_region: string\r\n  is_allow_reply: boolean\r\n  is_collapsed: boolean\r\n  is_pending: boolean\r\n  is_pinned: boolean\r\n  is_verified: boolean\r\n  link: string\r\n  nick: string\r\n  page_key: string\r\n  page_url: string\r\n  rid: number\r\n  site_name: string\r\n  ua: string\r\n  user_id: number\r\n  visible: boolean\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface HandlerResponseConfAuthProviders {\r\n  anonymous: boolean\r\n  providers: AuthAuthProviderInfo[]\r\n}\r\n\r\nexport interface HandlerResponseConfDomain {\r\n  /** Is the domain trusted */\r\n  is_trusted: boolean\r\n  /** The origin of the domain */\r\n  origin: string\r\n}\r\n\r\nexport interface HandlerResponseNotifyList {\r\n  count: number\r\n  notifies: EntityCookedNotify[]\r\n}\r\n\r\nexport interface HandlerResponsePageFetch {\r\n  admin_only: boolean\r\n  date: string\r\n  id: number\r\n  key: string\r\n  pv: number\r\n  site_name: string\r\n  title: string\r\n  url: string\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface HandlerResponsePageFetchStatus {\r\n  /** The number of pages that have been fetched */\r\n  done: number\r\n  /** If the task is in progress */\r\n  is_progress: boolean\r\n  /** The message of the task status */\r\n  msg: string\r\n  /** The total number of pages */\r\n  total: number\r\n}\r\n\r\nexport interface HandlerResponsePageList {\r\n  count: number\r\n  pages: EntityCookedPage[]\r\n}\r\n\r\nexport interface HandlerResponsePagePV {\r\n  pv: number\r\n}\r\n\r\nexport interface HandlerResponsePageUpdate {\r\n  admin_only: boolean\r\n  date: string\r\n  id: number\r\n  key: string\r\n  pv: number\r\n  site_name: string\r\n  title: string\r\n  url: string\r\n  vote_down: number\r\n  vote_up: number\r\n}\r\n\r\nexport interface HandlerResponseSettingGet {\r\n  yaml: string\r\n}\r\n\r\nexport interface HandlerResponseSettingTemplate {\r\n  yaml: string\r\n}\r\n\r\nexport interface HandlerResponseSiteCreate {\r\n  first_url: string\r\n  id: number\r\n  name: string\r\n  urls: string[]\r\n  urls_raw: string\r\n}\r\n\r\nexport interface HandlerResponseSiteList {\r\n  count: number\r\n  sites: EntityCookedSite[]\r\n}\r\n\r\nexport interface HandlerResponseSiteUpdate {\r\n  first_url: string\r\n  id: number\r\n  name: string\r\n  urls: string[]\r\n  urls_raw: string\r\n}\r\n\r\nexport interface HandlerResponseTransferExport {\r\n  /** The exported data which is a JSON string */\r\n  artrans: string\r\n}\r\n\r\nexport interface HandlerResponseTransferUpload {\r\n  /** The uploaded file name which can be used to import */\r\n  filename: string\r\n}\r\n\r\nexport interface HandlerResponseUpload {\r\n  file_name: string\r\n  file_type: string\r\n  public_url: string\r\n}\r\n\r\nexport interface HandlerResponseUserCreate {\r\n  badge_color: string\r\n  badge_name: string\r\n  comment_count: number\r\n  email: string\r\n  id: number\r\n  is_admin: boolean\r\n  is_in_conf: boolean\r\n  last_ip: string\r\n  last_ua: string\r\n  link: string\r\n  name: string\r\n  receive_email: boolean\r\n}\r\n\r\nexport interface HandlerResponseUserInfo {\r\n  is_login: boolean\r\n  notifies: EntityCookedNotify[]\r\n  notifies_count: number\r\n  user: EntityCookedUser\r\n}\r\n\r\nexport interface HandlerResponseUserLogin {\r\n  token: string\r\n  user: EntityCookedUser\r\n}\r\n\r\nexport interface HandlerResponseUserStatus {\r\n  is_admin: boolean\r\n  is_login: boolean\r\n}\r\n\r\nexport interface HandlerResponseUserUpdate {\r\n  badge_color: string\r\n  badge_name: string\r\n  comment_count: number\r\n  email: string\r\n  id: number\r\n  is_admin: boolean\r\n  is_in_conf: boolean\r\n  last_ip: string\r\n  last_ua: string\r\n  link: string\r\n  name: string\r\n  receive_email: boolean\r\n}\r\n\r\nexport interface HandlerResponseVote {\r\n  down: number\r\n  up: number\r\n}\r\n\r\nexport type QueryParamsType = Record<string | number, any>\r\nexport type ResponseFormat = keyof Omit<Body, 'body' | 'bodyUsed'>\r\n\r\nexport interface FullRequestParams extends Omit<RequestInit, 'body'> {\r\n  /** set parameter to `true` for call `securityWorker` for this request */\r\n  secure?: boolean\r\n  /** request path */\r\n  path: string\r\n  /** content type of request body */\r\n  type?: ContentType\r\n  /** query params */\r\n  query?: QueryParamsType\r\n  /** format of response (i.e. response.json() -> format: \"json\") */\r\n  format?: ResponseFormat\r\n  /** request body */\r\n  body?: unknown\r\n  /** base url */\r\n  baseUrl?: string\r\n  /** request cancellation token */\r\n  cancelToken?: CancelToken\r\n}\r\n\r\nexport type RequestParams = Omit<FullRequestParams, 'body' | 'method' | 'query' | 'path'>\r\n\r\nexport interface ApiConfig<SecurityDataType = unknown> {\r\n  baseUrl?: string\r\n  baseApiParams?: Omit<RequestParams, 'baseUrl' | 'cancelToken' | 'signal'>\r\n  securityWorker?: (\r\n    securityData: SecurityDataType | null,\r\n  ) => Promise<RequestParams | void> | RequestParams | void\r\n  customFetch?: typeof fetch\r\n}\r\n\r\nexport interface HttpResponse<D extends unknown, E extends unknown = unknown> extends Response {\r\n  data: D\r\n  error: E\r\n}\r\n\r\ntype CancelToken = Symbol | string | number\r\n\r\nexport enum ContentType {\r\n  Json = 'application/json',\r\n  FormData = 'multipart/form-data',\r\n  UrlEncoded = 'application/x-www-form-urlencoded',\r\n  Text = 'text/plain',\r\n}\r\n\r\nexport class HttpClient<SecurityDataType = unknown> {\r\n  public baseUrl: string = '/api/v2'\r\n  private securityData: SecurityDataType | null = null\r\n  private securityWorker?: ApiConfig<SecurityDataType>['securityWorker']\r\n  private abortControllers = new Map<CancelToken, AbortController>()\r\n  private customFetch = (...fetchParams: Parameters<typeof fetch>) => fetch(...fetchParams)\r\n\r\n  private baseApiParams: RequestParams = {\r\n    credentials: 'same-origin',\r\n    headers: {},\r\n    redirect: 'follow',\r\n    referrerPolicy: 'no-referrer',\r\n  }\r\n\r\n  constructor(apiConfig: ApiConfig<SecurityDataType> = {}) {\r\n    Object.assign(this, apiConfig)\r\n  }\r\n\r\n  public setSecurityData = (data: SecurityDataType | null) => {\r\n    this.securityData = data\r\n  }\r\n\r\n  protected encodeQueryParam(key: string, value: any) {\r\n    const encodedKey = encodeURIComponent(key)\r\n    return `${encodedKey}=${encodeURIComponent(typeof value === 'number' ? value : `${value}`)}`\r\n  }\r\n\r\n  protected addQueryParam(query: QueryParamsType, key: string) {\r\n    return this.encodeQueryParam(key, query[key])\r\n  }\r\n\r\n  protected addArrayQueryParam(query: QueryParamsType, key: string) {\r\n    const value = query[key]\r\n    return value.map((v: any) => this.encodeQueryParam(key, v)).join('&')\r\n  }\r\n\r\n  protected toQueryString(rawQuery?: QueryParamsType): string {\r\n    const query = rawQuery || {}\r\n    const keys = Object.keys(query).filter((key) => 'undefined' !== typeof query[key])\r\n    return keys\r\n      .map((key) =>\r\n        Array.isArray(query[key])\r\n          ? this.addArrayQueryParam(query, key)\r\n          : this.addQueryParam(query, key),\r\n      )\r\n      .join('&')\r\n  }\r\n\r\n  protected addQueryParams(rawQuery?: QueryParamsType): string {\r\n    const queryString = this.toQueryString(rawQuery)\r\n    return queryString ? `?${queryString}` : ''\r\n  }\r\n\r\n  private contentFormatters: Record<ContentType, (input: any) => any> = {\r\n    [ContentType.Json]: (input: any) =>\r\n      input !== null && (typeof input === 'object' || typeof input === 'string')\r\n        ? JSON.stringify(input)\r\n        : input,\r\n    [ContentType.Text]: (input: any) =>\r\n      input !== null && typeof input !== 'string' ? JSON.stringify(input) : input,\r\n    [ContentType.FormData]: (input: any) =>\r\n      Object.keys(input || {}).reduce((formData, key) => {\r\n        const property = input[key]\r\n        formData.append(\r\n          key,\r\n          property instanceof Blob\r\n            ? property\r\n            : typeof property === 'object' && property !== null\r\n            ? JSON.stringify(property)\r\n            : `${property}`,\r\n        )\r\n        return formData\r\n      }, new FormData()),\r\n    [ContentType.UrlEncoded]: (input: any) => this.toQueryString(input),\r\n  }\r\n\r\n  protected mergeRequestParams(params1: RequestParams, params2?: RequestParams): RequestParams {\r\n    return {\r\n      ...this.baseApiParams,\r\n      ...params1,\r\n      ...(params2 || {}),\r\n      headers: {\r\n        ...(this.baseApiParams.headers || {}),\r\n        ...(params1.headers || {}),\r\n        ...((params2 && params2.headers) || {}),\r\n      },\r\n    }\r\n  }\r\n\r\n  protected createAbortSignal = (cancelToken: CancelToken): AbortSignal | undefined => {\r\n    if (this.abortControllers.has(cancelToken)) {\r\n      const abortController = this.abortControllers.get(cancelToken)\r\n      if (abortController) {\r\n        return abortController.signal\r\n      }\r\n      return void 0\r\n    }\r\n\r\n    const abortController = new AbortController()\r\n    this.abortControllers.set(cancelToken, abortController)\r\n    return abortController.signal\r\n  }\r\n\r\n  public abortRequest = (cancelToken: CancelToken) => {\r\n    const abortController = this.abortControllers.get(cancelToken)\r\n\r\n    if (abortController) {\r\n      abortController.abort()\r\n      this.abortControllers.delete(cancelToken)\r\n    }\r\n  }\r\n\r\n  public request = async <T = any, E = any>({\r\n    body,\r\n    secure,\r\n    path,\r\n    type,\r\n    query,\r\n    format,\r\n    baseUrl,\r\n    cancelToken,\r\n    ...params\r\n  }: FullRequestParams): Promise<HttpResponse<T, E>> => {\r\n    const secureParams =\r\n      ((typeof secure === 'boolean' ? secure : this.baseApiParams.secure) &&\r\n        this.securityWorker &&\r\n        (await this.securityWorker(this.securityData))) ||\r\n      {}\r\n    const requestParams = this.mergeRequestParams(params, secureParams)\r\n    const queryString = query && this.toQueryString(query)\r\n    const payloadFormatter = this.contentFormatters[type || ContentType.Json]\r\n    const responseFormat = format || requestParams.format\r\n\r\n    return this.customFetch(\r\n      `${baseUrl || this.baseUrl || ''}${path}${queryString ? `?${queryString}` : ''}`,\r\n      {\r\n        ...requestParams,\r\n        headers: {\r\n          ...(requestParams.headers || {}),\r\n          ...(type && type !== ContentType.FormData ? { 'Content-Type': type } : {}),\r\n        },\r\n        signal: (cancelToken ? this.createAbortSignal(cancelToken) : requestParams.signal) || null,\r\n        body: typeof body === 'undefined' || body === null ? null : payloadFormatter(body),\r\n      },\r\n    ).then(async (response) => {\r\n      const r = response as HttpResponse<T, E>\r\n      r.data = null as unknown as T\r\n      r.error = null as unknown as E\r\n\r\n      const data = !responseFormat\r\n        ? r\r\n        : await response[responseFormat]()\r\n            .then((data) => {\r\n              if (r.ok) {\r\n                r.data = data\r\n              } else {\r\n                r.error = data\r\n              }\r\n              return r\r\n            })\r\n            .catch((e) => {\r\n              r.error = e\r\n              return r\r\n            })\r\n\r\n      if (cancelToken) {\r\n        this.abortControllers.delete(cancelToken)\r\n      }\r\n\r\n      if (!response.ok) throw data\r\n      return data\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * @title Artalk API\r\n * @version 2.0\r\n * @license MIT (https://github.com/ArtalkJS/Artalk/blob/master/LICENSE)\r\n * @baseUrl /api/v2\r\n * @contact API Support <artalkjs@gmail.com> (https://artalk.js.org)\r\n *\r\n * Artalk is a modern comment system based on Golang.\r\n */\r\nexport class Api<SecurityDataType extends unknown> extends HttpClient<SecurityDataType> {\r\n  auth = {\r\n    /**\r\n * @description Login by email with verify code (Need send email verify code first) or password\r\n *\r\n * @tags Auth\r\n * @name LoginByEmail\r\n * @summary Login by email\r\n * @request POST:/auth/email/login\r\n * @response `200` `HandlerResponseUserLogin` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    loginByEmail: (data: HandlerRequestAuthEmailLogin, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseUserLogin,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/auth/email/login`,\r\n        method: 'POST',\r\n        body: data,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Register by email and verify code (if user exists, will update user, like forget password. Need send email verify code first)\r\n *\r\n * @tags Auth\r\n * @name RegisterByEmail\r\n * @summary Register by email\r\n * @request POST:/auth/email/register\r\n * @response `200` `HandlerResponseUserLogin` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    registerByEmail: (data: HandlerRequestAuthEmailRegister, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseUserLogin,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/auth/email/register`,\r\n        method: 'POST',\r\n        body: data,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Send email including verify code to user\r\n *\r\n * @tags Auth\r\n * @name SendVerifyEmail\r\n * @summary Send verify email\r\n * @request POST:/auth/email/send\r\n * @response `200` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    sendVerifyEmail: (data: HandlerRequestAuthEmailSend, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap & {\r\n          msg?: string\r\n        },\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/auth/email/send`,\r\n        method: 'POST',\r\n        body: data,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Get all users with same email, if there are more than one user with same email, need merge\r\n *\r\n * @tags Auth\r\n * @name CheckDataMerge\r\n * @summary Check data merge\r\n * @request GET:/auth/merge\r\n * @secure\r\n * @response `200` `HandlerResponseAuthDataMergeCheck` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    checkDataMerge: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseAuthDataMergeCheck,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/auth/merge`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description This function is to solve the problem of multiple users with the same email address, should be called after user login and then check, and perform data merge.\r\n *\r\n * @tags Auth\r\n * @name ApplyDataMerge\r\n * @summary Apply data merge\r\n * @request POST:/auth/merge\r\n * @secure\r\n * @response `200` `HandlerResponseAuthDataMergeApply` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    applyDataMerge: (data: HandlerRequestAuthDataMergeApply, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseAuthDataMergeApply,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/auth/merge`,\r\n        method: 'POST',\r\n        body: data,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  cache = {\r\n    /**\r\n * @description Flush all cache on the server\r\n *\r\n * @tags Cache\r\n * @name FlushCache\r\n * @summary Flush Cache\r\n * @request POST:/cache/flush\r\n * @secure\r\n * @response `200` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n */\r\n    flushCache: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap & {\r\n          msg?: string\r\n        },\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/cache/flush`,\r\n        method: 'POST',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Cache warming helps you to pre-load the cache to improve the performance of the first request\r\n *\r\n * @tags Cache\r\n * @name WarmUpCache\r\n * @summary Warm-Up Cache\r\n * @request POST:/cache/warm_up\r\n * @secure\r\n * @response `200` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n */\r\n    warmUpCache: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap & {\r\n          msg?: string\r\n        },\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/cache/warm_up`,\r\n        method: 'POST',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  captcha = {\r\n    /**\r\n * @description Get a base64 encoded captcha image or a HTML page to verify for user\r\n *\r\n * @tags Captcha\r\n * @name GetCaptcha\r\n * @summary Get Captcha\r\n * @request GET:/captcha\r\n * @response `200` `HandlerResponseCaptchaGet` OK\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getCaptcha: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseCaptchaGet,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/captcha`,\r\n        method: 'GET',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Get the status of the user's captcha verification\r\n     *\r\n     * @tags Captcha\r\n     * @name GetCaptchaStatus\r\n     * @summary Get Captcha Status\r\n     * @request GET:/captcha/status\r\n     * @response `200` `HandlerResponseCaptchaStatus` OK\r\n     */\r\n    getCaptchaStatus: (params: RequestParams = {}) =>\r\n      this.request<HandlerResponseCaptchaStatus, any>({\r\n        path: `/captcha/status`,\r\n        method: 'GET',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Verify user enters correct captcha code\r\n *\r\n * @tags Captcha\r\n * @name VerifyCaptcha\r\n * @summary Verify Captcha\r\n * @request POST:/captcha/verify\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    img_data?: string,\r\n\r\n})` Forbidden\r\n */\r\n    verifyCaptcha: (data: HandlerParamsCaptchaVerify, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          img_data?: string\r\n        }\r\n      >({\r\n        path: `/captcha/verify`,\r\n        method: 'POST',\r\n        body: data,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  comments = {\r\n    /**\r\n * @description Get a list of comments by some conditions\r\n *\r\n * @tags Comment\r\n * @name GetComments\r\n * @summary Get Comment List\r\n * @request GET:/comments\r\n * @secure\r\n * @response `200` `HandlerResponseCommentList` OK\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getComments: (\r\n      query: {\r\n        /** The user email */\r\n        email?: string\r\n        /** Enable flat_mode */\r\n        flat_mode?: boolean\r\n        /** The limit for pagination */\r\n        limit?: number\r\n        /** The username */\r\n        name?: string\r\n        /** The offset for pagination */\r\n        offset?: number\r\n        /** The comment page_key */\r\n        page_key: string\r\n        /** The scope of comments */\r\n        scope?: 'page' | 'user' | 'site'\r\n        /** Search keywords */\r\n        search?: string\r\n        /** The site name of your content scope */\r\n        site_name?: string\r\n        /** Sort by condition */\r\n        sort_by?: 'date_asc' | 'date_desc' | 'vote'\r\n        /** Message center show type */\r\n        type?: 'all' | 'mentions' | 'mine' | 'pending'\r\n        /** Only show comments by admin */\r\n        view_only_admin?: boolean\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseCommentList,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/comments`,\r\n        method: 'GET',\r\n        query: query,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Create a new comment\r\n *\r\n * @tags Comment\r\n * @name CreateComment\r\n * @summary Create Comment\r\n * @request POST:/comments\r\n * @secure\r\n * @response `200` `HandlerResponseCommentCreate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    createComment: (comment: HandlerParamsCommentCreate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseCommentCreate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/comments`,\r\n        method: 'POST',\r\n        body: comment,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Get the detail of a comment by comment id\r\n *\r\n * @tags Comment\r\n * @name GetComment\r\n * @summary Get a comment\r\n * @request GET:/comments/{id}\r\n * @response `200` `HandlerResponseCommentGet` OK\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getComment: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseCommentGet,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/comments/${id}`,\r\n        method: 'GET',\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Update a specific comment\r\n *\r\n * @tags Comment\r\n * @name UpdateComment\r\n * @summary Update Comment\r\n * @request PUT:/comments/{id}\r\n * @secure\r\n * @response `200` `HandlerResponseCommentUpdate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    updateComment: (id: number, comment: HandlerParamsCommentUpdate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseCommentUpdate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/comments/${id}`,\r\n        method: 'PUT',\r\n        body: comment,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Delete a specific comment\r\n *\r\n * @tags Comment\r\n * @name DeleteComment\r\n * @summary Delete Comment\r\n * @request DELETE:/comments/{id}\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    deleteComment: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/comments/${id}`,\r\n        method: 'DELETE',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  conf = {\r\n    /**\r\n     * @description Get System Configs for UI\r\n     *\r\n     * @tags System\r\n     * @name Conf\r\n     * @summary Get System Configs\r\n     * @request GET:/conf\r\n     * @response `200` `CommonConfData` OK\r\n     */\r\n    conf: (params: RequestParams = {}) =>\r\n      this.request<CommonConfData, any>({\r\n        path: `/conf`,\r\n        method: 'GET',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Get social login providers\r\n *\r\n * @tags System\r\n * @name GetSocialLoginProviders\r\n * @summary Get Social Login Providers\r\n * @request GET:/conf/auth/providers\r\n * @response `200` `HandlerResponseConfAuthProviders` OK\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n */\r\n    getSocialLoginProviders: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseConfAuthProviders,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/conf/auth/providers`,\r\n        method: 'GET',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Get Domain Info\r\n     *\r\n     * @tags System\r\n     * @name GetDomain\r\n     * @summary Get Domain Info\r\n     * @request GET:/conf/domain\r\n     * @response `200` `HandlerResponseConfDomain` OK\r\n     */\r\n    getDomain: (\r\n      query?: {\r\n        /** Domain URL */\r\n        url?: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<HandlerResponseConfDomain, any>({\r\n        path: `/conf/domain`,\r\n        method: 'GET',\r\n        query: query,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  notifies = {\r\n    /**\r\n * @description Get a list of notifies for user\r\n *\r\n * @tags Notify\r\n * @name GetNotifies\r\n * @summary Get Notifies\r\n * @request GET:/notifies\r\n * @response `200` `HandlerResponseNotifyList` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getNotifies: (\r\n      query: {\r\n        /** The user email */\r\n        email: string\r\n        /** The user name */\r\n        name: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseNotifyList,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/notifies`,\r\n        method: 'GET',\r\n        query: query,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Mark all notifies as read for user\r\n *\r\n * @tags Notify\r\n * @name MarkAllNotifyRead\r\n * @summary Mark All Notifies as Read\r\n * @request POST:/notifies/read\r\n * @response `200` `HandlerMap` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    markAllNotifyRead: (options: HandlerParamsNotifyReadAll, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/notifies/read`,\r\n        method: 'POST',\r\n        body: options,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Mark specific notification as read for user\r\n *\r\n * @tags Notify\r\n * @name MarkNotifyRead\r\n * @summary Mark Notify as Read\r\n * @request POST:/notifies/{comment_id}/{notify_key}\r\n * @response `200` `HandlerMap` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    markNotifyRead: (commentId: number, notifyKey: string, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/notifies/${commentId}/${notifyKey}`,\r\n        method: 'POST',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  pages = {\r\n    /**\r\n * @description Get a list of pages by some conditions\r\n *\r\n * @tags Page\r\n * @name GetPages\r\n * @summary Get Page List\r\n * @request GET:/pages\r\n * @secure\r\n * @response `200` `HandlerResponsePageList` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n */\r\n    getPages: (\r\n      query?: {\r\n        /** The limit for pagination */\r\n        limit?: number\r\n        /** The offset for pagination */\r\n        offset?: number\r\n        /** The site name of your content scope */\r\n        site_name?: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponsePageList,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/pages`,\r\n        method: 'GET',\r\n        query: query,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Fetch the data of all pages\r\n *\r\n * @tags Page\r\n * @name FetchAllPages\r\n * @summary Fetch All Pages Data\r\n * @request POST:/pages/fetch\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    fetchAllPages: (options: HandlerParamsPageFetchAll, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/pages/fetch`,\r\n        method: 'POST',\r\n        body: options,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Get the status of the task of fetching all pages\r\n     *\r\n     * @tags Page\r\n     * @name GetPageFetchStatus\r\n     * @summary Get Pages Fetch Status\r\n     * @request GET:/pages/fetch/status\r\n     * @secure\r\n     * @response `200` `HandlerResponsePageFetchStatus` OK\r\n     */\r\n    getPageFetchStatus: (params: RequestParams = {}) =>\r\n      this.request<HandlerResponsePageFetchStatus, any>({\r\n        path: `/pages/fetch/status`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Increase and get the number of page views\r\n     *\r\n     * @tags Page\r\n     * @name LogPv\r\n     * @summary Increase Page Views (PV)\r\n     * @request POST:/pages/pv\r\n     * @response `200` `HandlerResponsePagePV` OK\r\n     */\r\n    logPv: (page: HandlerParamsPagePV, params: RequestParams = {}) =>\r\n      this.request<HandlerResponsePagePV, any>({\r\n        path: `/pages/pv`,\r\n        method: 'POST',\r\n        body: page,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Update a specific page\r\n *\r\n * @tags Page\r\n * @name UpdatePage\r\n * @summary Update Page\r\n * @request PUT:/pages/{id}\r\n * @secure\r\n * @response `200` `HandlerResponsePageUpdate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    updatePage: (id: number, page: HandlerParamsPageUpdate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponsePageUpdate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/pages/${id}`,\r\n        method: 'PUT',\r\n        body: page,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Delete a specific page\r\n *\r\n * @tags Page\r\n * @name DeletePage\r\n * @summary Delete Page\r\n * @request DELETE:/pages/{id}\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    deletePage: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/pages/${id}`,\r\n        method: 'DELETE',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Fetch the data of a specific page\r\n *\r\n * @tags Page\r\n * @name FetchPage\r\n * @summary Fetch Page Data\r\n * @request POST:/pages/{id}/fetch\r\n * @secure\r\n * @response `200` `HandlerResponsePageFetch` OK\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    fetchPage: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponsePageFetch,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/pages/${id}/fetch`,\r\n        method: 'POST',\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  sendEmail = {\r\n    /**\r\n * @description Send an email to test the email sender\r\n *\r\n * @tags System\r\n * @name SendEmail\r\n * @summary Send Email\r\n * @request POST:/send_email\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `HandlerMap` Internal Server Error\r\n */\r\n    sendEmail: (email: HandlerParamsEmailSend, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        | (HandlerMap & {\r\n            msg?: string\r\n          })\r\n        | HandlerMap\r\n      >({\r\n        path: `/send_email`,\r\n        method: 'POST',\r\n        body: email,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  settings = {\r\n    /**\r\n * @description Get settings from app config file\r\n *\r\n * @tags System\r\n * @name GetSettings\r\n * @summary Get Settings\r\n * @request GET:/settings\r\n * @secure\r\n * @response `200` `HandlerResponseSettingGet` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getSettings: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseSettingGet,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/settings`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Apply settings and restart the server\r\n *\r\n * @tags System\r\n * @name ApplySettings\r\n * @summary Save and apply Settings\r\n * @request PUT:/settings\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    applySettings: (settings: HandlerParamsSettingApply, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/settings`,\r\n        method: 'PUT',\r\n        body: settings,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Get config templates in different languages for rendering the settings page in the frontend\r\n     *\r\n     * @tags System\r\n     * @name GetSettingsTemplate\r\n     * @summary Get Settings Template\r\n     * @request GET:/settings/template/{locale}\r\n     * @secure\r\n     * @response `200` `HandlerResponseSettingTemplate` OK\r\n     */\r\n    getSettingsTemplate: (locale: string, params: RequestParams = {}) =>\r\n      this.request<HandlerResponseSettingTemplate, any>({\r\n        path: `/settings/template/${locale}`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  sites = {\r\n    /**\r\n     * @description Get a list of sites by some conditions\r\n     *\r\n     * @tags Site\r\n     * @name GetSites\r\n     * @summary Get Site List\r\n     * @request GET:/sites\r\n     * @secure\r\n     * @response `200` `HandlerResponseSiteList` OK\r\n     */\r\n    getSites: (params: RequestParams = {}) =>\r\n      this.request<HandlerResponseSiteList, any>({\r\n        path: `/sites`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Create a new site\r\n *\r\n * @tags Site\r\n * @name CreateSite\r\n * @summary Create Site\r\n * @request POST:/sites\r\n * @secure\r\n * @response `200` `HandlerResponseSiteCreate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    createSite: (site: HandlerParamsSiteCreate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseSiteCreate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/sites`,\r\n        method: 'POST',\r\n        body: site,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Update a specific site\r\n     *\r\n     * @tags Site\r\n     * @name UpdateSite\r\n     * @summary Update Site\r\n     * @request PUT:/sites/{id}\r\n     * @secure\r\n     * @response `200` `HandlerResponseSiteUpdate` OK\r\n     */\r\n    updateSite: (id: number, site: HandlerParamsSiteUpdate, params: RequestParams = {}) =>\r\n      this.request<HandlerResponseSiteUpdate, any>({\r\n        path: `/sites/${id}`,\r\n        method: 'PUT',\r\n        body: site,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Delete a specific site\r\n *\r\n * @tags Site\r\n * @name DeleteSite\r\n * @summary Site Delete\r\n * @request DELETE:/sites/{id}\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    deleteSite: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/sites/${id}`,\r\n        method: 'DELETE',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  stats = {\r\n    /**\r\n * @description Get the statistics of various data analysis\r\n *\r\n * @tags Statistic\r\n * @name GetStats\r\n * @summary Statistic\r\n * @request GET:/stats/{type}\r\n * @response `200` `CommonJSONResult` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    getStats: (\r\n      type:\r\n        | 'latest_comments'\r\n        | 'latest_pages'\r\n        | 'pv_most_pages'\r\n        | 'comment_most_pages'\r\n        | 'page_pv'\r\n        | 'site_pv'\r\n        | 'page_comment'\r\n        | 'site_comment'\r\n        | 'rand_comments'\r\n        | 'rand_pages',\r\n      query?: {\r\n        /** The limit for pagination */\r\n        limit?: number\r\n        /** multiple page keys separated by commas */\r\n        page_keys?: string\r\n        /** The site name of your content scope */\r\n        site_name?: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        CommonJSONResult,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/stats/${type}`,\r\n        method: 'GET',\r\n        query: query,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  transfer = {\r\n    /**\r\n * @description Export data from Artalk\r\n *\r\n * @tags Transfer\r\n * @name ExportArtrans\r\n * @summary Export Artrans\r\n * @request GET:/transfer/export\r\n * @secure\r\n * @response `200` `HandlerResponseTransferExport` OK\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    exportArtrans: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseTransferExport,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/transfer/export`,\r\n        method: 'GET',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Import data to Artalk\r\n     *\r\n     * @tags Transfer\r\n     * @name ImportArtrans\r\n     * @summary Import Artrans\r\n     * @request POST:/transfer/import\r\n     * @secure\r\n     * @response `200` `string` OK\r\n     */\r\n    importArtrans: (data: HandlerParamsTransferImport, params: RequestParams = {}) =>\r\n      this.request<string, any>({\r\n        path: `/transfer/import`,\r\n        method: 'POST',\r\n        body: data,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Upload a file to prepare to import\r\n *\r\n * @tags Transfer\r\n * @name UploadArtrans\r\n * @summary Upload Artrans\r\n * @request POST:/transfer/upload\r\n * @secure\r\n * @response `200` `(HandlerResponseTransferUpload & {\r\n    filename?: string,\r\n\r\n})` OK\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    uploadArtrans: (\r\n      data: {\r\n        /**\r\n         * Upload file in preparation for import task\r\n         * @format binary\r\n         */\r\n        file: File\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseTransferUpload & {\r\n          filename?: string\r\n        },\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/transfer/upload`,\r\n        method: 'POST',\r\n        body: data,\r\n        secure: true,\r\n        type: ContentType.FormData,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  upload = {\r\n    /**\r\n * @description Upload file from this endpoint\r\n *\r\n * @tags Upload\r\n * @name Upload\r\n * @summary Upload\r\n * @request POST:/upload\r\n * @secure\r\n * @response `200` `HandlerResponseUpload` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    upload: (\r\n      data: {\r\n        /**\r\n         * Upload file\r\n         * @format binary\r\n         */\r\n        file: File\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseUpload,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/upload`,\r\n        method: 'POST',\r\n        body: data,\r\n        secure: true,\r\n        type: ContentType.FormData,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  user = {\r\n    /**\r\n * @description Get user info to prepare for login or check current user status\r\n *\r\n * @tags Auth\r\n * @name GetUser\r\n * @summary Get User Info\r\n * @request GET:/user\r\n * @secure\r\n * @response `200` `HandlerResponseUserInfo` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n */\r\n    getUser: (\r\n      query?: {\r\n        /** The user email */\r\n        email?: string\r\n        /** The username */\r\n        name?: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseUserInfo,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/user`,\r\n        method: 'GET',\r\n        query: query,\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Login user by name or email\r\n *\r\n * @tags Auth\r\n * @name Login\r\n * @summary Get Access Token\r\n * @request POST:/user/access_token\r\n * @response `200` `HandlerResponseUserLogin` OK\r\n * @response `400` `(HandlerMap & {\r\n    data?: {\r\n    need_name_select?: (string)[],\r\n\r\n},\r\n    msg?: string,\r\n\r\n})` Multiple users with the same email address are matched\r\n * @response `401` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Unauthorized\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    login: (user: HandlerParamsUserLogin, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseUserLogin,\r\n        | (HandlerMap & {\r\n            data?: {\r\n              need_name_select?: string[]\r\n            }\r\n            msg?: string\r\n          })\r\n        | (HandlerMap & {\r\n            msg?: string\r\n          })\r\n      >({\r\n        path: `/user/access_token`,\r\n        method: 'POST',\r\n        body: user,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n     * @description Get user login status by header Authorization\r\n     *\r\n     * @tags Auth\r\n     * @name GetUserStatus\r\n     * @summary Get Login Status\r\n     * @request GET:/user/status\r\n     * @secure\r\n     * @response `200` `HandlerResponseUserStatus` OK\r\n     */\r\n    getUserStatus: (\r\n      query?: {\r\n        /** The user email */\r\n        email?: string\r\n        /** The username */\r\n        name?: string\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<HandlerResponseUserStatus, any>({\r\n        path: `/user/status`,\r\n        method: 'GET',\r\n        query: query,\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  users = {\r\n    /**\r\n * @description Create a new user\r\n *\r\n * @tags User\r\n * @name CreateUser\r\n * @summary Create User\r\n * @request POST:/users\r\n * @secure\r\n * @response `200` `HandlerResponseUserCreate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    createUser: (user: HandlerParamsUserCreate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseUserCreate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/users`,\r\n        method: 'POST',\r\n        body: user,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Update a specific user\r\n *\r\n * @tags User\r\n * @name UpdateUser\r\n * @summary Update User\r\n * @request PUT:/users/{id}\r\n * @secure\r\n * @response `200` `HandlerResponseUserUpdate` OK\r\n * @response `400` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Bad Request\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    updateUser: (id: number, user: HandlerParamsUserUpdate, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerResponseUserUpdate,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/users/${id}`,\r\n        method: 'PUT',\r\n        body: user,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Delete a specific user\r\n *\r\n * @tags User\r\n * @name DeleteUser\r\n * @summary Delete User\r\n * @request DELETE:/users/{id}\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    deleteUser: (id: number, params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/users/${id}`,\r\n        method: 'DELETE',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Get a list of users by some conditions\r\n *\r\n * @tags User\r\n * @name GetUsers\r\n * @summary Get User List\r\n * @request GET:/users/{type}\r\n * @secure\r\n * @response `200` `HandlerResponseAdminUserList` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n */\r\n    getUsers: (\r\n      type?: 'all' | 'admin' | 'in_conf',\r\n      query?: {\r\n        /** The limit for pagination */\r\n        limit?: number\r\n        /** The offset for pagination */\r\n        offset?: number\r\n      },\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseAdminUserList,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/users/${type}`,\r\n        method: 'GET',\r\n        query: query,\r\n        secure: true,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  version = {\r\n    /**\r\n     * @description Get the version of Artalk\r\n     *\r\n     * @tags System\r\n     * @name GetVersion\r\n     * @summary Get Version Info\r\n     * @request GET:/version\r\n     * @response `200` `CommonApiVersionData` OK\r\n     */\r\n    getVersion: (params: RequestParams = {}) =>\r\n      this.request<CommonApiVersionData, any>({\r\n        path: `/version`,\r\n        method: 'GET',\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n  votes = {\r\n    /**\r\n * @description Sync the number of votes in the `comments` or `pages` data tables to keep them the same as the `votes` table\r\n *\r\n * @tags Vote\r\n * @name SyncVotes\r\n * @summary Sync Vote Data\r\n * @request POST:/votes/sync\r\n * @secure\r\n * @response `200` `HandlerMap` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n */\r\n    syncVotes: (params: RequestParams = {}) =>\r\n      this.request<\r\n        HandlerMap,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/votes/sync`,\r\n        method: 'POST',\r\n        secure: true,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n\r\n    /**\r\n * @description Vote for a specific comment or page\r\n *\r\n * @tags Vote\r\n * @name Vote\r\n * @summary Vote\r\n * @request POST:/votes/{type}/{target_id}\r\n * @response `200` `HandlerResponseVote` OK\r\n * @response `403` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Forbidden\r\n * @response `404` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Not Found\r\n * @response `500` `(HandlerMap & {\r\n    msg?: string,\r\n\r\n})` Internal Server Error\r\n */\r\n    vote: (\r\n      type: 'comment_up' | 'comment_down' | 'page_up' | 'page_down',\r\n      targetId: number,\r\n      vote: HandlerParamsVote,\r\n      params: RequestParams = {},\r\n    ) =>\r\n      this.request<\r\n        HandlerResponseVote,\r\n        HandlerMap & {\r\n          msg?: string\r\n        }\r\n      >({\r\n        path: `/votes/${type}/${targetId}`,\r\n        method: 'POST',\r\n        body: vote,\r\n        type: ContentType.Json,\r\n        format: 'json',\r\n        ...params,\r\n      }),\r\n  }\r\n}\r\n","import { ApiOptions } from './options'\r\nimport { FetchError } from '@/types'\r\n\r\nexport const Fetch = async (\r\n  opts: ApiOptions,\r\n  input: string | URL | Request,\r\n  init?: RequestInit,\r\n) => {\r\n  const apiToken = opts.getApiToken && opts.getApiToken()\r\n\r\n  const headers = new Headers({\r\n    Authorization: apiToken ? `Bearer ${apiToken}` : '',\r\n    ...init?.headers,\r\n  })\r\n\r\n  if (!headers.get('Authorization')) headers.delete('Authorization')\r\n\r\n  // 请求操作\r\n  const resp = await fetch(input, {\r\n    ...init,\r\n    headers,\r\n  })\r\n\r\n  if (!resp.ok) {\r\n    // Deserialize response body (if it is JSON, otherwise returns `{}`)\r\n    const json: any = (await resp.json().catch(() => {})) || {}\r\n\r\n    let retry = false\r\n    opts.handlers &&\r\n      (await opts.handlers.get().reduce(async (promise, item) => {\r\n        await promise\r\n        if (json[item.action] === true) {\r\n          await item.handler(json)\r\n          retry = true\r\n        }\r\n      }, Promise.resolve()))\r\n\r\n    if (retry) return Fetch(opts, input, init)\r\n    throw createError(resp.status, json)\r\n  }\r\n\r\n  return resp\r\n}\r\n\r\nexport class FetchException extends Error implements FetchError {\r\n  code: number = 0\r\n  message: string = 'fetch error'\r\n  data?: any\r\n}\r\n\r\nfunction createError(code: number, data: any): FetchException {\r\n  const err = new FetchException()\r\n  err.message = data.msg || data.message || 'fetch error'\r\n  err.code = code\r\n  err.data = data\r\n  console.error(err)\r\n  return err\r\n}\r\n","export interface ApiHandlerPayload {\r\n  need_captcha: { img_data?: string; iframe?: string }\r\n  need_login: object\r\n  need_auth_login: object\r\n}\r\n\r\ntype PayloadKey = keyof ApiHandlerPayload\r\n\r\nexport interface ApiHandler<T extends PayloadKey = PayloadKey> {\r\n  action: T\r\n  handler: (data: ApiHandlerPayload[T]) => Promise<void>\r\n}\r\n\r\nexport interface ApiHandlers {\r\n  add: <T extends PayloadKey>(\r\n    action: T,\r\n    handler: (data: ApiHandlerPayload[T]) => Promise<void>,\r\n  ) => void\r\n  get: () => ApiHandler[]\r\n}\r\n\r\nexport function createApiHandlers(): ApiHandlers {\r\n  const handlers: ApiHandler[] = []\r\n  return {\r\n    add: (action, handler) => {\r\n      handlers.push({ action, handler })\r\n    },\r\n    get: () => handlers,\r\n  }\r\n}\r\n","import { ApiOptions } from './options'\r\nimport { Api as ApiV2 } from './v2'\r\nimport { Fetch } from './fetch'\r\n\r\nexport * from './options'\r\nexport * from './handler'\r\n\r\nexport class Api extends ApiV2<void> {\r\n  private _opts: ApiOptions\r\n\r\n  constructor(opts: ApiOptions) {\r\n    super({\r\n      baseUrl: opts.baseURL,\r\n      customFetch: (input, init) => Fetch(opts, input, init),\r\n    })\r\n\r\n    this._opts = opts\r\n  }\r\n\r\n  /**\r\n   * Get user info as params for request\r\n   *\r\n   * @returns Request params with user info\r\n   */\r\n  getUserFields() {\r\n    const user = this._opts.userInfo\r\n    if (!user?.name || !user?.email) return undefined\r\n    return { name: user.name, email: user.email }\r\n  }\r\n}\r\n","/**\n * marked v12.0.2 - a markdown parser\n * Copyright (c) 2011-2024, Christopher Jeffrey. (MIT Licensed)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\n/**\n * Gets the original marked default options.\n */\nfunction _getDefaults() {\n    return {\n        async: false,\n        breaks: false,\n        extensions: null,\n        gfm: true,\n        hooks: null,\n        pedantic: false,\n        renderer: null,\n        silent: false,\n        tokenizer: null,\n        walkTokens: null\n    };\n}\nlet _defaults = _getDefaults();\nfunction changeDefaults(newDefaults) {\n    _defaults = newDefaults;\n}\n\n/**\n * Helpers\n */\nconst escapeTest = /[&<>\"']/;\nconst escapeReplace = new RegExp(escapeTest.source, 'g');\nconst escapeTestNoEncode = /[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/;\nconst escapeReplaceNoEncode = new RegExp(escapeTestNoEncode.source, 'g');\nconst escapeReplacements = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;'\n};\nconst getEscapeReplacement = (ch) => escapeReplacements[ch];\nfunction escape$1(html, encode) {\n    if (encode) {\n        if (escapeTest.test(html)) {\n            return html.replace(escapeReplace, getEscapeReplacement);\n        }\n    }\n    else {\n        if (escapeTestNoEncode.test(html)) {\n            return html.replace(escapeReplaceNoEncode, getEscapeReplacement);\n        }\n    }\n    return html;\n}\nconst unescapeTest = /&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig;\nfunction unescape(html) {\n    // explicitly match decimal, hex, and named HTML entities\n    return html.replace(unescapeTest, (_, n) => {\n        n = n.toLowerCase();\n        if (n === 'colon')\n            return ':';\n        if (n.charAt(0) === '#') {\n            return n.charAt(1) === 'x'\n                ? String.fromCharCode(parseInt(n.substring(2), 16))\n                : String.fromCharCode(+n.substring(1));\n        }\n        return '';\n    });\n}\nconst caret = /(^|[^\\[])\\^/g;\nfunction edit(regex, opt) {\n    let source = typeof regex === 'string' ? regex : regex.source;\n    opt = opt || '';\n    const obj = {\n        replace: (name, val) => {\n            let valSource = typeof val === 'string' ? val : val.source;\n            valSource = valSource.replace(caret, '$1');\n            source = source.replace(name, valSource);\n            return obj;\n        },\n        getRegex: () => {\n            return new RegExp(source, opt);\n        }\n    };\n    return obj;\n}\nfunction cleanUrl(href) {\n    try {\n        href = encodeURI(href).replace(/%25/g, '%');\n    }\n    catch (e) {\n        return null;\n    }\n    return href;\n}\nconst noopTest = { exec: () => null };\nfunction splitCells(tableRow, count) {\n    // ensure that every cell-delimiting pipe has a space\n    // before it to distinguish it from an escaped pipe\n    const row = tableRow.replace(/\\|/g, (match, offset, str) => {\n        let escaped = false;\n        let curr = offset;\n        while (--curr >= 0 && str[curr] === '\\\\')\n            escaped = !escaped;\n        if (escaped) {\n            // odd number of slashes means | is escaped\n            // so we leave it alone\n            return '|';\n        }\n        else {\n            // add space before unescaped |\n            return ' |';\n        }\n    }), cells = row.split(/ \\|/);\n    let i = 0;\n    // First/last cell in a row cannot be empty if it has no leading/trailing pipe\n    if (!cells[0].trim()) {\n        cells.shift();\n    }\n    if (cells.length > 0 && !cells[cells.length - 1].trim()) {\n        cells.pop();\n    }\n    if (count) {\n        if (cells.length > count) {\n            cells.splice(count);\n        }\n        else {\n            while (cells.length < count)\n                cells.push('');\n        }\n    }\n    for (; i < cells.length; i++) {\n        // leading or trailing whitespace is ignored per the gfm spec\n        cells[i] = cells[i].trim().replace(/\\\\\\|/g, '|');\n    }\n    return cells;\n}\n/**\n * Remove trailing 'c's. Equivalent to str.replace(/c*$/, '').\n * /c*$/ is vulnerable to REDOS.\n *\n * @param str\n * @param c\n * @param invert Remove suffix of non-c chars instead. Default falsey.\n */\nfunction rtrim(str, c, invert) {\n    const l = str.length;\n    if (l === 0) {\n        return '';\n    }\n    // Length of suffix matching the invert condition.\n    let suffLen = 0;\n    // Step left until we fail to match the invert condition.\n    while (suffLen < l) {\n        const currChar = str.charAt(l - suffLen - 1);\n        if (currChar === c && !invert) {\n            suffLen++;\n        }\n        else if (currChar !== c && invert) {\n            suffLen++;\n        }\n        else {\n            break;\n        }\n    }\n    return str.slice(0, l - suffLen);\n}\nfunction findClosingBracket(str, b) {\n    if (str.indexOf(b[1]) === -1) {\n        return -1;\n    }\n    let level = 0;\n    for (let i = 0; i < str.length; i++) {\n        if (str[i] === '\\\\') {\n            i++;\n        }\n        else if (str[i] === b[0]) {\n            level++;\n        }\n        else if (str[i] === b[1]) {\n            level--;\n            if (level < 0) {\n                return i;\n            }\n        }\n    }\n    return -1;\n}\n\nfunction outputLink(cap, link, raw, lexer) {\n    const href = link.href;\n    const title = link.title ? escape$1(link.title) : null;\n    const text = cap[1].replace(/\\\\([\\[\\]])/g, '$1');\n    if (cap[0].charAt(0) !== '!') {\n        lexer.state.inLink = true;\n        const token = {\n            type: 'link',\n            raw,\n            href,\n            title,\n            text,\n            tokens: lexer.inlineTokens(text)\n        };\n        lexer.state.inLink = false;\n        return token;\n    }\n    return {\n        type: 'image',\n        raw,\n        href,\n        title,\n        text: escape$1(text)\n    };\n}\nfunction indentCodeCompensation(raw, text) {\n    const matchIndentToCode = raw.match(/^(\\s+)(?:```)/);\n    if (matchIndentToCode === null) {\n        return text;\n    }\n    const indentToCode = matchIndentToCode[1];\n    return text\n        .split('\\n')\n        .map(node => {\n        const matchIndentInNode = node.match(/^\\s+/);\n        if (matchIndentInNode === null) {\n            return node;\n        }\n        const [indentInNode] = matchIndentInNode;\n        if (indentInNode.length >= indentToCode.length) {\n            return node.slice(indentToCode.length);\n        }\n        return node;\n    })\n        .join('\\n');\n}\n/**\n * Tokenizer\n */\nclass _Tokenizer {\n    options;\n    rules; // set by the lexer\n    lexer; // set by the lexer\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    space(src) {\n        const cap = this.rules.block.newline.exec(src);\n        if (cap && cap[0].length > 0) {\n            return {\n                type: 'space',\n                raw: cap[0]\n            };\n        }\n    }\n    code(src) {\n        const cap = this.rules.block.code.exec(src);\n        if (cap) {\n            const text = cap[0].replace(/^ {1,4}/gm, '');\n            return {\n                type: 'code',\n                raw: cap[0],\n                codeBlockStyle: 'indented',\n                text: !this.options.pedantic\n                    ? rtrim(text, '\\n')\n                    : text\n            };\n        }\n    }\n    fences(src) {\n        const cap = this.rules.block.fences.exec(src);\n        if (cap) {\n            const raw = cap[0];\n            const text = indentCodeCompensation(raw, cap[3] || '');\n            return {\n                type: 'code',\n                raw,\n                lang: cap[2] ? cap[2].trim().replace(this.rules.inline.anyPunctuation, '$1') : cap[2],\n                text\n            };\n        }\n    }\n    heading(src) {\n        const cap = this.rules.block.heading.exec(src);\n        if (cap) {\n            let text = cap[2].trim();\n            // remove trailing #s\n            if (/#$/.test(text)) {\n                const trimmed = rtrim(text, '#');\n                if (this.options.pedantic) {\n                    text = trimmed.trim();\n                }\n                else if (!trimmed || / $/.test(trimmed)) {\n                    // CommonMark requires space before trailing #s\n                    text = trimmed.trim();\n                }\n            }\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[1].length,\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    hr(src) {\n        const cap = this.rules.block.hr.exec(src);\n        if (cap) {\n            return {\n                type: 'hr',\n                raw: cap[0]\n            };\n        }\n    }\n    blockquote(src) {\n        const cap = this.rules.block.blockquote.exec(src);\n        if (cap) {\n            // precede setext continuation with 4 spaces so it isn't a setext\n            let text = cap[0].replace(/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g, '\\n    $1');\n            text = rtrim(text.replace(/^ *>[ \\t]?/gm, ''), '\\n');\n            const top = this.lexer.state.top;\n            this.lexer.state.top = true;\n            const tokens = this.lexer.blockTokens(text);\n            this.lexer.state.top = top;\n            return {\n                type: 'blockquote',\n                raw: cap[0],\n                tokens,\n                text\n            };\n        }\n    }\n    list(src) {\n        let cap = this.rules.block.list.exec(src);\n        if (cap) {\n            let bull = cap[1].trim();\n            const isordered = bull.length > 1;\n            const list = {\n                type: 'list',\n                raw: '',\n                ordered: isordered,\n                start: isordered ? +bull.slice(0, -1) : '',\n                loose: false,\n                items: []\n            };\n            bull = isordered ? `\\\\d{1,9}\\\\${bull.slice(-1)}` : `\\\\${bull}`;\n            if (this.options.pedantic) {\n                bull = isordered ? bull : '[*+-]';\n            }\n            // Get next list item\n            const itemRegex = new RegExp(`^( {0,3}${bull})((?:[\\t ][^\\\\n]*)?(?:\\\\n|$))`);\n            let raw = '';\n            let itemContents = '';\n            let endsWithBlankLine = false;\n            // Check if current bullet point can start a new List Item\n            while (src) {\n                let endEarly = false;\n                if (!(cap = itemRegex.exec(src))) {\n                    break;\n                }\n                if (this.rules.block.hr.test(src)) { // End list if bullet was actually HR (possibly move into itemRegex?)\n                    break;\n                }\n                raw = cap[0];\n                src = src.substring(raw.length);\n                let line = cap[2].split('\\n', 1)[0].replace(/^\\t+/, (t) => ' '.repeat(3 * t.length));\n                let nextLine = src.split('\\n', 1)[0];\n                let indent = 0;\n                if (this.options.pedantic) {\n                    indent = 2;\n                    itemContents = line.trimStart();\n                }\n                else {\n                    indent = cap[2].search(/[^ ]/); // Find first non-space char\n                    indent = indent > 4 ? 1 : indent; // Treat indented code blocks (> 4 spaces) as having only 1 indent\n                    itemContents = line.slice(indent);\n                    indent += cap[1].length;\n                }\n                let blankLine = false;\n                if (!line && /^ *$/.test(nextLine)) { // Items begin with at most one blank line\n                    raw += nextLine + '\\n';\n                    src = src.substring(nextLine.length + 1);\n                    endEarly = true;\n                }\n                if (!endEarly) {\n                    const nextBulletRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \\t][^\\\\n]*)?(?:\\\\n|$))`);\n                    const hrRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`);\n                    const fencesBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}(?:\\`\\`\\`|~~~)`);\n                    const headingBeginRegex = new RegExp(`^ {0,${Math.min(3, indent - 1)}}#`);\n                    // Check if following lines should be included in List Item\n                    while (src) {\n                        const rawLine = src.split('\\n', 1)[0];\n                        nextLine = rawLine;\n                        // Re-align to follow commonmark nesting rules\n                        if (this.options.pedantic) {\n                            nextLine = nextLine.replace(/^ {1,4}(?=( {4})*[^ ])/g, '  ');\n                        }\n                        // End list item if found code fences\n                        if (fencesBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new heading\n                        if (headingBeginRegex.test(nextLine)) {\n                            break;\n                        }\n                        // End list item if found start of new bullet\n                        if (nextBulletRegex.test(nextLine)) {\n                            break;\n                        }\n                        // Horizontal rule found\n                        if (hrRegex.test(src)) {\n                            break;\n                        }\n                        if (nextLine.search(/[^ ]/) >= indent || !nextLine.trim()) { // Dedent if possible\n                            itemContents += '\\n' + nextLine.slice(indent);\n                        }\n                        else {\n                            // not enough indentation\n                            if (blankLine) {\n                                break;\n                            }\n                            // paragraph continuation unless last line was a different block level element\n                            if (line.search(/[^ ]/) >= 4) { // indented code block\n                                break;\n                            }\n                            if (fencesBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (headingBeginRegex.test(line)) {\n                                break;\n                            }\n                            if (hrRegex.test(line)) {\n                                break;\n                            }\n                            itemContents += '\\n' + nextLine;\n                        }\n                        if (!blankLine && !nextLine.trim()) { // Check if current line is blank\n                            blankLine = true;\n                        }\n                        raw += rawLine + '\\n';\n                        src = src.substring(rawLine.length + 1);\n                        line = nextLine.slice(indent);\n                    }\n                }\n                if (!list.loose) {\n                    // If the previous item ended with a blank line, the list is loose\n                    if (endsWithBlankLine) {\n                        list.loose = true;\n                    }\n                    else if (/\\n *\\n *$/.test(raw)) {\n                        endsWithBlankLine = true;\n                    }\n                }\n                let istask = null;\n                let ischecked;\n                // Check for task list items\n                if (this.options.gfm) {\n                    istask = /^\\[[ xX]\\] /.exec(itemContents);\n                    if (istask) {\n                        ischecked = istask[0] !== '[ ] ';\n                        itemContents = itemContents.replace(/^\\[[ xX]\\] +/, '');\n                    }\n                }\n                list.items.push({\n                    type: 'list_item',\n                    raw,\n                    task: !!istask,\n                    checked: ischecked,\n                    loose: false,\n                    text: itemContents,\n                    tokens: []\n                });\n                list.raw += raw;\n            }\n            // Do not consume newlines at end of final item. Alternatively, make itemRegex *start* with any newlines to simplify/speed up endsWithBlankLine logic\n            list.items[list.items.length - 1].raw = raw.trimEnd();\n            (list.items[list.items.length - 1]).text = itemContents.trimEnd();\n            list.raw = list.raw.trimEnd();\n            // Item child tokens handled here at end because we needed to have the final item to trim it first\n            for (let i = 0; i < list.items.length; i++) {\n                this.lexer.state.top = false;\n                list.items[i].tokens = this.lexer.blockTokens(list.items[i].text, []);\n                if (!list.loose) {\n                    // Check if list should be loose\n                    const spacers = list.items[i].tokens.filter(t => t.type === 'space');\n                    const hasMultipleLineBreaks = spacers.length > 0 && spacers.some(t => /\\n.*\\n/.test(t.raw));\n                    list.loose = hasMultipleLineBreaks;\n                }\n            }\n            // Set all items to loose if list is loose\n            if (list.loose) {\n                for (let i = 0; i < list.items.length; i++) {\n                    list.items[i].loose = true;\n                }\n            }\n            return list;\n        }\n    }\n    html(src) {\n        const cap = this.rules.block.html.exec(src);\n        if (cap) {\n            const token = {\n                type: 'html',\n                block: true,\n                raw: cap[0],\n                pre: cap[1] === 'pre' || cap[1] === 'script' || cap[1] === 'style',\n                text: cap[0]\n            };\n            return token;\n        }\n    }\n    def(src) {\n        const cap = this.rules.block.def.exec(src);\n        if (cap) {\n            const tag = cap[1].toLowerCase().replace(/\\s+/g, ' ');\n            const href = cap[2] ? cap[2].replace(/^<(.*)>$/, '$1').replace(this.rules.inline.anyPunctuation, '$1') : '';\n            const title = cap[3] ? cap[3].substring(1, cap[3].length - 1).replace(this.rules.inline.anyPunctuation, '$1') : cap[3];\n            return {\n                type: 'def',\n                tag,\n                raw: cap[0],\n                href,\n                title\n            };\n        }\n    }\n    table(src) {\n        const cap = this.rules.block.table.exec(src);\n        if (!cap) {\n            return;\n        }\n        if (!/[:|]/.test(cap[2])) {\n            // delimiter row must have a pipe (|) or colon (:) otherwise it is a setext heading\n            return;\n        }\n        const headers = splitCells(cap[1]);\n        const aligns = cap[2].replace(/^\\||\\| *$/g, '').split('|');\n        const rows = cap[3] && cap[3].trim() ? cap[3].replace(/\\n[ \\t]*$/, '').split('\\n') : [];\n        const item = {\n            type: 'table',\n            raw: cap[0],\n            header: [],\n            align: [],\n            rows: []\n        };\n        if (headers.length !== aligns.length) {\n            // header and align columns must be equal, rows can be different.\n            return;\n        }\n        for (const align of aligns) {\n            if (/^ *-+: *$/.test(align)) {\n                item.align.push('right');\n            }\n            else if (/^ *:-+: *$/.test(align)) {\n                item.align.push('center');\n            }\n            else if (/^ *:-+ *$/.test(align)) {\n                item.align.push('left');\n            }\n            else {\n                item.align.push(null);\n            }\n        }\n        for (const header of headers) {\n            item.header.push({\n                text: header,\n                tokens: this.lexer.inline(header)\n            });\n        }\n        for (const row of rows) {\n            item.rows.push(splitCells(row, item.header.length).map(cell => {\n                return {\n                    text: cell,\n                    tokens: this.lexer.inline(cell)\n                };\n            }));\n        }\n        return item;\n    }\n    lheading(src) {\n        const cap = this.rules.block.lheading.exec(src);\n        if (cap) {\n            return {\n                type: 'heading',\n                raw: cap[0],\n                depth: cap[2].charAt(0) === '=' ? 1 : 2,\n                text: cap[1],\n                tokens: this.lexer.inline(cap[1])\n            };\n        }\n    }\n    paragraph(src) {\n        const cap = this.rules.block.paragraph.exec(src);\n        if (cap) {\n            const text = cap[1].charAt(cap[1].length - 1) === '\\n'\n                ? cap[1].slice(0, -1)\n                : cap[1];\n            return {\n                type: 'paragraph',\n                raw: cap[0],\n                text,\n                tokens: this.lexer.inline(text)\n            };\n        }\n    }\n    text(src) {\n        const cap = this.rules.block.text.exec(src);\n        if (cap) {\n            return {\n                type: 'text',\n                raw: cap[0],\n                text: cap[0],\n                tokens: this.lexer.inline(cap[0])\n            };\n        }\n    }\n    escape(src) {\n        const cap = this.rules.inline.escape.exec(src);\n        if (cap) {\n            return {\n                type: 'escape',\n                raw: cap[0],\n                text: escape$1(cap[1])\n            };\n        }\n    }\n    tag(src) {\n        const cap = this.rules.inline.tag.exec(src);\n        if (cap) {\n            if (!this.lexer.state.inLink && /^<a /i.test(cap[0])) {\n                this.lexer.state.inLink = true;\n            }\n            else if (this.lexer.state.inLink && /^<\\/a>/i.test(cap[0])) {\n                this.lexer.state.inLink = false;\n            }\n            if (!this.lexer.state.inRawBlock && /^<(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = true;\n            }\n            else if (this.lexer.state.inRawBlock && /^<\\/(pre|code|kbd|script)(\\s|>)/i.test(cap[0])) {\n                this.lexer.state.inRawBlock = false;\n            }\n            return {\n                type: 'html',\n                raw: cap[0],\n                inLink: this.lexer.state.inLink,\n                inRawBlock: this.lexer.state.inRawBlock,\n                block: false,\n                text: cap[0]\n            };\n        }\n    }\n    link(src) {\n        const cap = this.rules.inline.link.exec(src);\n        if (cap) {\n            const trimmedUrl = cap[2].trim();\n            if (!this.options.pedantic && /^</.test(trimmedUrl)) {\n                // commonmark requires matching angle brackets\n                if (!(/>$/.test(trimmedUrl))) {\n                    return;\n                }\n                // ending angle bracket cannot be escaped\n                const rtrimSlash = rtrim(trimmedUrl.slice(0, -1), '\\\\');\n                if ((trimmedUrl.length - rtrimSlash.length) % 2 === 0) {\n                    return;\n                }\n            }\n            else {\n                // find closing parenthesis\n                const lastParenIndex = findClosingBracket(cap[2], '()');\n                if (lastParenIndex > -1) {\n                    const start = cap[0].indexOf('!') === 0 ? 5 : 4;\n                    const linkLen = start + cap[1].length + lastParenIndex;\n                    cap[2] = cap[2].substring(0, lastParenIndex);\n                    cap[0] = cap[0].substring(0, linkLen).trim();\n                    cap[3] = '';\n                }\n            }\n            let href = cap[2];\n            let title = '';\n            if (this.options.pedantic) {\n                // split pedantic href and title\n                const link = /^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/.exec(href);\n                if (link) {\n                    href = link[1];\n                    title = link[3];\n                }\n            }\n            else {\n                title = cap[3] ? cap[3].slice(1, -1) : '';\n            }\n            href = href.trim();\n            if (/^</.test(href)) {\n                if (this.options.pedantic && !(/>$/.test(trimmedUrl))) {\n                    // pedantic allows starting angle bracket without ending angle bracket\n                    href = href.slice(1);\n                }\n                else {\n                    href = href.slice(1, -1);\n                }\n            }\n            return outputLink(cap, {\n                href: href ? href.replace(this.rules.inline.anyPunctuation, '$1') : href,\n                title: title ? title.replace(this.rules.inline.anyPunctuation, '$1') : title\n            }, cap[0], this.lexer);\n        }\n    }\n    reflink(src, links) {\n        let cap;\n        if ((cap = this.rules.inline.reflink.exec(src))\n            || (cap = this.rules.inline.nolink.exec(src))) {\n            const linkString = (cap[2] || cap[1]).replace(/\\s+/g, ' ');\n            const link = links[linkString.toLowerCase()];\n            if (!link) {\n                const text = cap[0].charAt(0);\n                return {\n                    type: 'text',\n                    raw: text,\n                    text\n                };\n            }\n            return outputLink(cap, link, cap[0], this.lexer);\n        }\n    }\n    emStrong(src, maskedSrc, prevChar = '') {\n        let match = this.rules.inline.emStrongLDelim.exec(src);\n        if (!match)\n            return;\n        // _ can't be between two alphanumerics. \\p{L}\\p{N} includes non-english alphabet/numbers as well\n        if (match[3] && prevChar.match(/[\\p{L}\\p{N}]/u))\n            return;\n        const nextChar = match[1] || match[2] || '';\n        if (!nextChar || !prevChar || this.rules.inline.punctuation.exec(prevChar)) {\n            // unicode Regex counts emoji as 1 char; spread into array for proper count (used multiple times below)\n            const lLength = [...match[0]].length - 1;\n            let rDelim, rLength, delimTotal = lLength, midDelimTotal = 0;\n            const endReg = match[0][0] === '*' ? this.rules.inline.emStrongRDelimAst : this.rules.inline.emStrongRDelimUnd;\n            endReg.lastIndex = 0;\n            // Clip maskedSrc to same section of string as src (move to lexer?)\n            maskedSrc = maskedSrc.slice(-1 * src.length + lLength);\n            while ((match = endReg.exec(maskedSrc)) != null) {\n                rDelim = match[1] || match[2] || match[3] || match[4] || match[5] || match[6];\n                if (!rDelim)\n                    continue; // skip single * in __abc*abc__\n                rLength = [...rDelim].length;\n                if (match[3] || match[4]) { // found another Left Delim\n                    delimTotal += rLength;\n                    continue;\n                }\n                else if (match[5] || match[6]) { // either Left or Right Delim\n                    if (lLength % 3 && !((lLength + rLength) % 3)) {\n                        midDelimTotal += rLength;\n                        continue; // CommonMark Emphasis Rules 9-10\n                    }\n                }\n                delimTotal -= rLength;\n                if (delimTotal > 0)\n                    continue; // Haven't found enough closing delimiters\n                // Remove extra characters. *a*** -> *a*\n                rLength = Math.min(rLength, rLength + delimTotal + midDelimTotal);\n                // char length can be >1 for unicode characters;\n                const lastCharLength = [...match[0]][0].length;\n                const raw = src.slice(0, lLength + match.index + lastCharLength + rLength);\n                // Create `em` if smallest delimiter has odd char count. *a***\n                if (Math.min(lLength, rLength) % 2) {\n                    const text = raw.slice(1, -1);\n                    return {\n                        type: 'em',\n                        raw,\n                        text,\n                        tokens: this.lexer.inlineTokens(text)\n                    };\n                }\n                // Create 'strong' if smallest delimiter has even char count. **a***\n                const text = raw.slice(2, -2);\n                return {\n                    type: 'strong',\n                    raw,\n                    text,\n                    tokens: this.lexer.inlineTokens(text)\n                };\n            }\n        }\n    }\n    codespan(src) {\n        const cap = this.rules.inline.code.exec(src);\n        if (cap) {\n            let text = cap[2].replace(/\\n/g, ' ');\n            const hasNonSpaceChars = /[^ ]/.test(text);\n            const hasSpaceCharsOnBothEnds = /^ /.test(text) && / $/.test(text);\n            if (hasNonSpaceChars && hasSpaceCharsOnBothEnds) {\n                text = text.substring(1, text.length - 1);\n            }\n            text = escape$1(text, true);\n            return {\n                type: 'codespan',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n    br(src) {\n        const cap = this.rules.inline.br.exec(src);\n        if (cap) {\n            return {\n                type: 'br',\n                raw: cap[0]\n            };\n        }\n    }\n    del(src) {\n        const cap = this.rules.inline.del.exec(src);\n        if (cap) {\n            return {\n                type: 'del',\n                raw: cap[0],\n                text: cap[2],\n                tokens: this.lexer.inlineTokens(cap[2])\n            };\n        }\n    }\n    autolink(src) {\n        const cap = this.rules.inline.autolink.exec(src);\n        if (cap) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[1]);\n                href = 'mailto:' + text;\n            }\n            else {\n                text = escape$1(cap[1]);\n                href = text;\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    url(src) {\n        let cap;\n        if (cap = this.rules.inline.url.exec(src)) {\n            let text, href;\n            if (cap[2] === '@') {\n                text = escape$1(cap[0]);\n                href = 'mailto:' + text;\n            }\n            else {\n                // do extended autolink path validation\n                let prevCapZero;\n                do {\n                    prevCapZero = cap[0];\n                    cap[0] = this.rules.inline._backpedal.exec(cap[0])?.[0] ?? '';\n                } while (prevCapZero !== cap[0]);\n                text = escape$1(cap[0]);\n                if (cap[1] === 'www.') {\n                    href = 'http://' + cap[0];\n                }\n                else {\n                    href = cap[0];\n                }\n            }\n            return {\n                type: 'link',\n                raw: cap[0],\n                text,\n                href,\n                tokens: [\n                    {\n                        type: 'text',\n                        raw: text,\n                        text\n                    }\n                ]\n            };\n        }\n    }\n    inlineText(src) {\n        const cap = this.rules.inline.text.exec(src);\n        if (cap) {\n            let text;\n            if (this.lexer.state.inRawBlock) {\n                text = cap[0];\n            }\n            else {\n                text = escape$1(cap[0]);\n            }\n            return {\n                type: 'text',\n                raw: cap[0],\n                text\n            };\n        }\n    }\n}\n\n/**\n * Block-Level Grammar\n */\nconst newline = /^(?: *(?:\\n|$))+/;\nconst blockCode = /^( {4}[^\\n]+(?:\\n(?: *(?:\\n|$))*)?)+/;\nconst fences = /^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/;\nconst hr = /^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/;\nconst heading = /^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/;\nconst bullet = /(?:[*+-]|\\d{1,9}[.)])/;\nconst lheading = edit(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/)\n    .replace(/bull/g, bullet) // lists can interrupt\n    .replace(/blockCode/g, / {4}/) // indented code blocks can interrupt\n    .replace(/fences/g, / {0,3}(?:`{3,}|~{3,})/) // fenced code blocks can interrupt\n    .replace(/blockquote/g, / {0,3}>/) // blockquote can interrupt\n    .replace(/heading/g, / {0,3}#{1,6}/) // ATX heading can interrupt\n    .replace(/html/g, / {0,3}<[^\\n>]+>\\n/) // block html can interrupt\n    .getRegex();\nconst _paragraph = /^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/;\nconst blockText = /^[^\\n]+/;\nconst _blockLabel = /(?!\\s*\\])(?:\\\\.|[^\\[\\]\\\\])+/;\nconst def = edit(/^ {0,3}\\[(label)\\]: *(?:\\n *)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n *)?| *\\n *)(title))? *(?:\\n+|$)/)\n    .replace('label', _blockLabel)\n    .replace('title', /(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/)\n    .getRegex();\nconst list = edit(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/)\n    .replace(/bull/g, bullet)\n    .getRegex();\nconst _tag = 'address|article|aside|base|basefont|blockquote|body|caption'\n    + '|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption'\n    + '|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe'\n    + '|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option'\n    + '|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title'\n    + '|tr|track|ul';\nconst _comment = /<!--(?:-?>|[\\s\\S]*?(?:-->|$))/;\nconst html = edit('^ {0,3}(?:' // optional indentation\n    + '<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)' // (1)\n    + '|comment[^\\\\n]*(\\\\n+|$)' // (2)\n    + '|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)' // (3)\n    + '|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)' // (4)\n    + '|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)' // (5)\n    + '|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (6)\n    + '|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) open tag\n    + '|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n *)+\\\\n|$)' // (7) closing tag\n    + ')', 'i')\n    .replace('comment', _comment)\n    .replace('tag', _tag)\n    .replace('attribute', / +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst paragraph = edit(_paragraph)\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n    .replace('|table', '')\n    .replace('blockquote', ' {0,3}>')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockquote = edit(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/)\n    .replace('paragraph', paragraph)\n    .getRegex();\n/**\n * Normal Block Grammar\n */\nconst blockNormal = {\n    blockquote,\n    code: blockCode,\n    def,\n    fences,\n    heading,\n    hr,\n    html,\n    lheading,\n    list,\n    newline,\n    paragraph,\n    table: noopTest,\n    text: blockText\n};\n/**\n * GFM Block Grammar\n */\nconst gfmTable = edit('^ *([^\\\\n ].*)\\\\n' // Header\n    + ' {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)' // Align\n    + '(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)') // Cells\n    .replace('hr', hr)\n    .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n    .replace('blockquote', ' {0,3}>')\n    .replace('code', ' {4}[^\\\\n]')\n    .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n    .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n    .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n    .replace('tag', _tag) // tables can be interrupted by type (6) html blocks\n    .getRegex();\nconst blockGfm = {\n    ...blockNormal,\n    table: gfmTable,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' {0,3}#{1,6}(?:\\\\s|$)')\n        .replace('|lheading', '') // setext headings don't interrupt commonmark paragraphs\n        .replace('table', gfmTable) // interrupt paragraphs with table\n        .replace('blockquote', ' {0,3}>')\n        .replace('fences', ' {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n')\n        .replace('list', ' {0,3}(?:[*+-]|1[.)]) ') // only lists starting from 1 can interrupt\n        .replace('html', '</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)')\n        .replace('tag', _tag) // pars can be interrupted by type (6) html blocks\n        .getRegex()\n};\n/**\n * Pedantic grammar (original John Gruber's loose markdown specification)\n */\nconst blockPedantic = {\n    ...blockNormal,\n    html: edit('^ *(?:comment *(?:\\\\n|\\\\s*$)'\n        + '|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)' // closed tag\n        + '|<tag(?:\"[^\"]*\"|\\'[^\\']*\\'|\\\\s[^\\'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))')\n        .replace('comment', _comment)\n        .replace(/tag/g, '(?!(?:'\n        + 'a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub'\n        + '|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)'\n        + '\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b')\n        .getRegex(),\n    def: /^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,\n    heading: /^(#{1,6})(.*)(?:\\n+|$)/,\n    fences: noopTest, // fences not supported\n    lheading: /^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,\n    paragraph: edit(_paragraph)\n        .replace('hr', hr)\n        .replace('heading', ' *#{1,6} *[^\\n]')\n        .replace('lheading', lheading)\n        .replace('|table', '')\n        .replace('blockquote', ' {0,3}>')\n        .replace('|fences', '')\n        .replace('|list', '')\n        .replace('|html', '')\n        .replace('|tag', '')\n        .getRegex()\n};\n/**\n * Inline-Level Grammar\n */\nconst escape = /^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/;\nconst inlineCode = /^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/;\nconst br = /^( {2,}|\\\\)\\n(?!\\s*$)/;\nconst inlineText = /^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/;\n// list of unicode punctuation marks, plus any missing characters from CommonMark spec\nconst _punctuation = '\\\\p{P}\\\\p{S}';\nconst punctuation = edit(/^((?![*_])[\\spunctuation])/, 'u')\n    .replace(/punctuation/g, _punctuation).getRegex();\n// sequences em should skip over [title](link), `code`, <html>\nconst blockSkip = /\\[[^[\\]]*?\\]\\([^\\(\\)]*?\\)|`[^`]*?`|<[^<>]*?>/g;\nconst emStrongLDelim = edit(/^(?:\\*+(?:((?!\\*)[punct])|[^\\s*]))|^_+(?:((?!_)[punct])|([^\\s_]))/, 'u')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst emStrongRDelimAst = edit('^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)' // Skip orphan inside strong\n    + '|[^*]+(?=[^*])' // Consume to delim\n    + '|(?!\\\\*)[punct](\\\\*+)(?=[\\\\s]|$)' // (1) #*** can only be a Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?!\\\\*)(?=[punct\\\\s]|$)' // (2) a***#, a*** can only be a Right Delimiter\n    + '|(?!\\\\*)[punct\\\\s](\\\\*+)(?=[^punct\\\\s])' // (3) #***a, ***a can only be Left Delimiter\n    + '|[\\\\s](\\\\*+)(?!\\\\*)(?=[punct])' // (4) ***# can only be Left Delimiter\n    + '|(?!\\\\*)[punct](\\\\*+)(?!\\\\*)(?=[punct])' // (5) #***# can be either Left or Right Delimiter\n    + '|[^punct\\\\s](\\\\*+)(?=[^punct\\\\s])', 'gu') // (6) a***a can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\n// (6) Not allowed for _\nconst emStrongRDelimUnd = edit('^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)' // Skip orphan inside strong\n    + '|[^_]+(?=[^_])' // Consume to delim\n    + '|(?!_)[punct](_+)(?=[\\\\s]|$)' // (1) #___ can only be a Right Delimiter\n    + '|[^punct\\\\s](_+)(?!_)(?=[punct\\\\s]|$)' // (2) a___#, a___ can only be a Right Delimiter\n    + '|(?!_)[punct\\\\s](_+)(?=[^punct\\\\s])' // (3) #___a, ___a can only be Left Delimiter\n    + '|[\\\\s](_+)(?!_)(?=[punct])' // (4) ___# can only be Left Delimiter\n    + '|(?!_)[punct](_+)(?!_)(?=[punct])', 'gu') // (5) #___# can be either Left or Right Delimiter\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst anyPunctuation = edit(/\\\\([punct])/, 'gu')\n    .replace(/punct/g, _punctuation)\n    .getRegex();\nconst autolink = edit(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/)\n    .replace('scheme', /[a-zA-Z][a-zA-Z0-9+.-]{1,31}/)\n    .replace('email', /[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/)\n    .getRegex();\nconst _inlineComment = edit(_comment).replace('(?:-->|$)', '-->').getRegex();\nconst tag = edit('^comment'\n    + '|^</[a-zA-Z][\\\\w:-]*\\\\s*>' // self-closing tag\n    + '|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>' // open tag\n    + '|^<\\\\?[\\\\s\\\\S]*?\\\\?>' // processing instruction, e.g. <?php ?>\n    + '|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>' // declaration, e.g. <!DOCTYPE html>\n    + '|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>') // CDATA section\n    .replace('comment', _inlineComment)\n    .replace('attribute', /\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/)\n    .getRegex();\nconst _inlineLabel = /(?:\\[(?:\\\\.|[^\\[\\]\\\\])*\\]|\\\\.|`[^`]*`|[^\\[\\]\\\\`])*?/;\nconst link = edit(/^!?\\[(label)\\]\\(\\s*(href)(?:\\s+(title))?\\s*\\)/)\n    .replace('label', _inlineLabel)\n    .replace('href', /<(?:\\\\.|[^\\n<>\\\\])+>|[^\\s\\x00-\\x1f]*/)\n    .replace('title', /\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/)\n    .getRegex();\nconst reflink = edit(/^!?\\[(label)\\]\\[(ref)\\]/)\n    .replace('label', _inlineLabel)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst nolink = edit(/^!?\\[(ref)\\](?:\\[\\])?/)\n    .replace('ref', _blockLabel)\n    .getRegex();\nconst reflinkSearch = edit('reflink|nolink(?!\\\\()', 'g')\n    .replace('reflink', reflink)\n    .replace('nolink', nolink)\n    .getRegex();\n/**\n * Normal Inline Grammar\n */\nconst inlineNormal = {\n    _backpedal: noopTest, // only used for GFM url\n    anyPunctuation,\n    autolink,\n    blockSkip,\n    br,\n    code: inlineCode,\n    del: noopTest,\n    emStrongLDelim,\n    emStrongRDelimAst,\n    emStrongRDelimUnd,\n    escape,\n    link,\n    nolink,\n    punctuation,\n    reflink,\n    reflinkSearch,\n    tag,\n    text: inlineText,\n    url: noopTest\n};\n/**\n * Pedantic Inline Grammar\n */\nconst inlinePedantic = {\n    ...inlineNormal,\n    link: edit(/^!?\\[(label)\\]\\((.*?)\\)/)\n        .replace('label', _inlineLabel)\n        .getRegex(),\n    reflink: edit(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/)\n        .replace('label', _inlineLabel)\n        .getRegex()\n};\n/**\n * GFM Inline Grammar\n */\nconst inlineGfm = {\n    ...inlineNormal,\n    escape: edit(escape).replace('])', '~|])').getRegex(),\n    url: edit(/^((?:ftp|https?):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/, 'i')\n        .replace('email', /[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/)\n        .getRegex(),\n    _backpedal: /(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,\n    del: /^(~~?)(?=[^\\s~])([\\s\\S]*?[^\\s~])\\1(?=[^~]|$)/,\n    text: /^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|https?:\\/\\/|ftp:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/\n};\n/**\n * GFM + Line Breaks Inline Grammar\n */\nconst inlineBreaks = {\n    ...inlineGfm,\n    br: edit(br).replace('{2,}', '*').getRegex(),\n    text: edit(inlineGfm.text)\n        .replace('\\\\b_', '\\\\b_| {2,}\\\\n')\n        .replace(/\\{2,\\}/g, '*')\n        .getRegex()\n};\n/**\n * exports\n */\nconst block = {\n    normal: blockNormal,\n    gfm: blockGfm,\n    pedantic: blockPedantic\n};\nconst inline = {\n    normal: inlineNormal,\n    gfm: inlineGfm,\n    breaks: inlineBreaks,\n    pedantic: inlinePedantic\n};\n\n/**\n * Block Lexer\n */\nclass _Lexer {\n    tokens;\n    options;\n    state;\n    tokenizer;\n    inlineQueue;\n    constructor(options) {\n        // TokenList cannot be created in one go\n        this.tokens = [];\n        this.tokens.links = Object.create(null);\n        this.options = options || _defaults;\n        this.options.tokenizer = this.options.tokenizer || new _Tokenizer();\n        this.tokenizer = this.options.tokenizer;\n        this.tokenizer.options = this.options;\n        this.tokenizer.lexer = this;\n        this.inlineQueue = [];\n        this.state = {\n            inLink: false,\n            inRawBlock: false,\n            top: true\n        };\n        const rules = {\n            block: block.normal,\n            inline: inline.normal\n        };\n        if (this.options.pedantic) {\n            rules.block = block.pedantic;\n            rules.inline = inline.pedantic;\n        }\n        else if (this.options.gfm) {\n            rules.block = block.gfm;\n            if (this.options.breaks) {\n                rules.inline = inline.breaks;\n            }\n            else {\n                rules.inline = inline.gfm;\n            }\n        }\n        this.tokenizer.rules = rules;\n    }\n    /**\n     * Expose Rules\n     */\n    static get rules() {\n        return {\n            block,\n            inline\n        };\n    }\n    /**\n     * Static Lex Method\n     */\n    static lex(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.lex(src);\n    }\n    /**\n     * Static Lex Inline Method\n     */\n    static lexInline(src, options) {\n        const lexer = new _Lexer(options);\n        return lexer.inlineTokens(src);\n    }\n    /**\n     * Preprocessing\n     */\n    lex(src) {\n        src = src\n            .replace(/\\r\\n|\\r/g, '\\n');\n        this.blockTokens(src, this.tokens);\n        for (let i = 0; i < this.inlineQueue.length; i++) {\n            const next = this.inlineQueue[i];\n            this.inlineTokens(next.src, next.tokens);\n        }\n        this.inlineQueue = [];\n        return this.tokens;\n    }\n    blockTokens(src, tokens = []) {\n        if (this.options.pedantic) {\n            src = src.replace(/\\t/g, '    ').replace(/^ +$/gm, '');\n        }\n        else {\n            src = src.replace(/^( *)(\\t+)/gm, (_, leading, tabs) => {\n                return leading + '    '.repeat(tabs.length);\n            });\n        }\n        let token;\n        let lastToken;\n        let cutSrc;\n        let lastParagraphClipped;\n        while (src) {\n            if (this.options.extensions\n                && this.options.extensions.block\n                && this.options.extensions.block.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // newline\n            if (token = this.tokenizer.space(src)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.length === 1 && tokens.length > 0) {\n                    // if there's a single \\n as a spacer, it's terminating the last line,\n                    // so move it there so that we don't get unnecessary paragraph tags\n                    tokens[tokens.length - 1].raw += '\\n';\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.code(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                // An indented code block cannot interrupt a paragraph.\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // fences\n            if (token = this.tokenizer.fences(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // heading\n            if (token = this.tokenizer.heading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // hr\n            if (token = this.tokenizer.hr(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // blockquote\n            if (token = this.tokenizer.blockquote(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // list\n            if (token = this.tokenizer.list(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // html\n            if (token = this.tokenizer.html(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // def\n            if (token = this.tokenizer.def(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && (lastToken.type === 'paragraph' || lastToken.type === 'text')) {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.raw;\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else if (!this.tokens.links[token.tag]) {\n                    this.tokens.links[token.tag] = {\n                        href: token.href,\n                        title: token.title\n                    };\n                }\n                continue;\n            }\n            // table (gfm)\n            if (token = this.tokenizer.table(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // lheading\n            if (token = this.tokenizer.lheading(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // top-level paragraph\n            // prevent paragraph consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startBlock) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startBlock.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (this.state.top && (token = this.tokenizer.paragraph(cutSrc))) {\n                lastToken = tokens[tokens.length - 1];\n                if (lastParagraphClipped && lastToken.type === 'paragraph') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                lastParagraphClipped = (cutSrc.length !== src.length);\n                src = src.substring(token.raw.length);\n                continue;\n            }\n            // text\n            if (token = this.tokenizer.text(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += '\\n' + token.raw;\n                    lastToken.text += '\\n' + token.text;\n                    this.inlineQueue.pop();\n                    this.inlineQueue[this.inlineQueue.length - 1].src = lastToken.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        this.state.top = true;\n        return tokens;\n    }\n    inline(src, tokens = []) {\n        this.inlineQueue.push({ src, tokens });\n        return tokens;\n    }\n    /**\n     * Lexing/Compiling\n     */\n    inlineTokens(src, tokens = []) {\n        let token, lastToken, cutSrc;\n        // String with links masked to avoid interference with em and strong\n        let maskedSrc = src;\n        let match;\n        let keepPrevChar, prevChar;\n        // Mask out reflinks\n        if (this.tokens.links) {\n            const links = Object.keys(this.tokens.links);\n            if (links.length > 0) {\n                while ((match = this.tokenizer.rules.inline.reflinkSearch.exec(maskedSrc)) != null) {\n                    if (links.includes(match[0].slice(match[0].lastIndexOf('[') + 1, -1))) {\n                        maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex);\n                    }\n                }\n            }\n        }\n        // Mask out other blocks\n        while ((match = this.tokenizer.rules.inline.blockSkip.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '[' + 'a'.repeat(match[0].length - 2) + ']' + maskedSrc.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);\n        }\n        // Mask out escaped characters\n        while ((match = this.tokenizer.rules.inline.anyPunctuation.exec(maskedSrc)) != null) {\n            maskedSrc = maskedSrc.slice(0, match.index) + '++' + maskedSrc.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);\n        }\n        while (src) {\n            if (!keepPrevChar) {\n                prevChar = '';\n            }\n            keepPrevChar = false;\n            // extensions\n            if (this.options.extensions\n                && this.options.extensions.inline\n                && this.options.extensions.inline.some((extTokenizer) => {\n                    if (token = extTokenizer.call({ lexer: this }, src, tokens)) {\n                        src = src.substring(token.raw.length);\n                        tokens.push(token);\n                        return true;\n                    }\n                    return false;\n                })) {\n                continue;\n            }\n            // escape\n            if (token = this.tokenizer.escape(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // tag\n            if (token = this.tokenizer.tag(src)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // link\n            if (token = this.tokenizer.link(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // reflink, nolink\n            if (token = this.tokenizer.reflink(src, this.tokens.links)) {\n                src = src.substring(token.raw.length);\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && token.type === 'text' && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            // em & strong\n            if (token = this.tokenizer.emStrong(src, maskedSrc, prevChar)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // code\n            if (token = this.tokenizer.codespan(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // br\n            if (token = this.tokenizer.br(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // del (gfm)\n            if (token = this.tokenizer.del(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // autolink\n            if (token = this.tokenizer.autolink(src)) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // url (gfm)\n            if (!this.state.inLink && (token = this.tokenizer.url(src))) {\n                src = src.substring(token.raw.length);\n                tokens.push(token);\n                continue;\n            }\n            // text\n            // prevent inlineText consuming extensions by clipping 'src' to extension start\n            cutSrc = src;\n            if (this.options.extensions && this.options.extensions.startInline) {\n                let startIndex = Infinity;\n                const tempSrc = src.slice(1);\n                let tempStart;\n                this.options.extensions.startInline.forEach((getStartIndex) => {\n                    tempStart = getStartIndex.call({ lexer: this }, tempSrc);\n                    if (typeof tempStart === 'number' && tempStart >= 0) {\n                        startIndex = Math.min(startIndex, tempStart);\n                    }\n                });\n                if (startIndex < Infinity && startIndex >= 0) {\n                    cutSrc = src.substring(0, startIndex + 1);\n                }\n            }\n            if (token = this.tokenizer.inlineText(cutSrc)) {\n                src = src.substring(token.raw.length);\n                if (token.raw.slice(-1) !== '_') { // Track prevChar before string of ____ started\n                    prevChar = token.raw.slice(-1);\n                }\n                keepPrevChar = true;\n                lastToken = tokens[tokens.length - 1];\n                if (lastToken && lastToken.type === 'text') {\n                    lastToken.raw += token.raw;\n                    lastToken.text += token.text;\n                }\n                else {\n                    tokens.push(token);\n                }\n                continue;\n            }\n            if (src) {\n                const errMsg = 'Infinite loop on byte: ' + src.charCodeAt(0);\n                if (this.options.silent) {\n                    console.error(errMsg);\n                    break;\n                }\n                else {\n                    throw new Error(errMsg);\n                }\n            }\n        }\n        return tokens;\n    }\n}\n\n/**\n * Renderer\n */\nclass _Renderer {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    code(code, infostring, escaped) {\n        const lang = (infostring || '').match(/^\\S*/)?.[0];\n        code = code.replace(/\\n$/, '') + '\\n';\n        if (!lang) {\n            return '<pre><code>'\n                + (escaped ? code : escape$1(code, true))\n                + '</code></pre>\\n';\n        }\n        return '<pre><code class=\"language-'\n            + escape$1(lang)\n            + '\">'\n            + (escaped ? code : escape$1(code, true))\n            + '</code></pre>\\n';\n    }\n    blockquote(quote) {\n        return `<blockquote>\\n${quote}</blockquote>\\n`;\n    }\n    html(html, block) {\n        return html;\n    }\n    heading(text, level, raw) {\n        // ignore IDs\n        return `<h${level}>${text}</h${level}>\\n`;\n    }\n    hr() {\n        return '<hr>\\n';\n    }\n    list(body, ordered, start) {\n        const type = ordered ? 'ol' : 'ul';\n        const startatt = (ordered && start !== 1) ? (' start=\"' + start + '\"') : '';\n        return '<' + type + startatt + '>\\n' + body + '</' + type + '>\\n';\n    }\n    listitem(text, task, checked) {\n        return `<li>${text}</li>\\n`;\n    }\n    checkbox(checked) {\n        return '<input '\n            + (checked ? 'checked=\"\" ' : '')\n            + 'disabled=\"\" type=\"checkbox\">';\n    }\n    paragraph(text) {\n        return `<p>${text}</p>\\n`;\n    }\n    table(header, body) {\n        if (body)\n            body = `<tbody>${body}</tbody>`;\n        return '<table>\\n'\n            + '<thead>\\n'\n            + header\n            + '</thead>\\n'\n            + body\n            + '</table>\\n';\n    }\n    tablerow(content) {\n        return `<tr>\\n${content}</tr>\\n`;\n    }\n    tablecell(content, flags) {\n        const type = flags.header ? 'th' : 'td';\n        const tag = flags.align\n            ? `<${type} align=\"${flags.align}\">`\n            : `<${type}>`;\n        return tag + content + `</${type}>\\n`;\n    }\n    /**\n     * span level renderer\n     */\n    strong(text) {\n        return `<strong>${text}</strong>`;\n    }\n    em(text) {\n        return `<em>${text}</em>`;\n    }\n    codespan(text) {\n        return `<code>${text}</code>`;\n    }\n    br() {\n        return '<br>';\n    }\n    del(text) {\n        return `<del>${text}</del>`;\n    }\n    link(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = '<a href=\"' + href + '\"';\n        if (title) {\n            out += ' title=\"' + title + '\"';\n        }\n        out += '>' + text + '</a>';\n        return out;\n    }\n    image(href, title, text) {\n        const cleanHref = cleanUrl(href);\n        if (cleanHref === null) {\n            return text;\n        }\n        href = cleanHref;\n        let out = `<img src=\"${href}\" alt=\"${text}\"`;\n        if (title) {\n            out += ` title=\"${title}\"`;\n        }\n        out += '>';\n        return out;\n    }\n    text(text) {\n        return text;\n    }\n}\n\n/**\n * TextRenderer\n * returns only the textual part of the token\n */\nclass _TextRenderer {\n    // no need for block level renderers\n    strong(text) {\n        return text;\n    }\n    em(text) {\n        return text;\n    }\n    codespan(text) {\n        return text;\n    }\n    del(text) {\n        return text;\n    }\n    html(text) {\n        return text;\n    }\n    text(text) {\n        return text;\n    }\n    link(href, title, text) {\n        return '' + text;\n    }\n    image(href, title, text) {\n        return '' + text;\n    }\n    br() {\n        return '';\n    }\n}\n\n/**\n * Parsing & Compiling\n */\nclass _Parser {\n    options;\n    renderer;\n    textRenderer;\n    constructor(options) {\n        this.options = options || _defaults;\n        this.options.renderer = this.options.renderer || new _Renderer();\n        this.renderer = this.options.renderer;\n        this.renderer.options = this.options;\n        this.textRenderer = new _TextRenderer();\n    }\n    /**\n     * Static Parse Method\n     */\n    static parse(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parse(tokens);\n    }\n    /**\n     * Static Parse Inline Method\n     */\n    static parseInline(tokens, options) {\n        const parser = new _Parser(options);\n        return parser.parseInline(tokens);\n    }\n    /**\n     * Parse Loop\n     */\n    parse(tokens, top = true) {\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const genericToken = token;\n                const ret = this.options.extensions.renderers[genericToken.type].call({ parser: this }, genericToken);\n                if (ret !== false || !['space', 'hr', 'heading', 'code', 'table', 'blockquote', 'list', 'html', 'paragraph', 'text'].includes(genericToken.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'space': {\n                    continue;\n                }\n                case 'hr': {\n                    out += this.renderer.hr();\n                    continue;\n                }\n                case 'heading': {\n                    const headingToken = token;\n                    out += this.renderer.heading(this.parseInline(headingToken.tokens), headingToken.depth, unescape(this.parseInline(headingToken.tokens, this.textRenderer)));\n                    continue;\n                }\n                case 'code': {\n                    const codeToken = token;\n                    out += this.renderer.code(codeToken.text, codeToken.lang, !!codeToken.escaped);\n                    continue;\n                }\n                case 'table': {\n                    const tableToken = token;\n                    let header = '';\n                    // header\n                    let cell = '';\n                    for (let j = 0; j < tableToken.header.length; j++) {\n                        cell += this.renderer.tablecell(this.parseInline(tableToken.header[j].tokens), { header: true, align: tableToken.align[j] });\n                    }\n                    header += this.renderer.tablerow(cell);\n                    let body = '';\n                    for (let j = 0; j < tableToken.rows.length; j++) {\n                        const row = tableToken.rows[j];\n                        cell = '';\n                        for (let k = 0; k < row.length; k++) {\n                            cell += this.renderer.tablecell(this.parseInline(row[k].tokens), { header: false, align: tableToken.align[k] });\n                        }\n                        body += this.renderer.tablerow(cell);\n                    }\n                    out += this.renderer.table(header, body);\n                    continue;\n                }\n                case 'blockquote': {\n                    const blockquoteToken = token;\n                    const body = this.parse(blockquoteToken.tokens);\n                    out += this.renderer.blockquote(body);\n                    continue;\n                }\n                case 'list': {\n                    const listToken = token;\n                    const ordered = listToken.ordered;\n                    const start = listToken.start;\n                    const loose = listToken.loose;\n                    let body = '';\n                    for (let j = 0; j < listToken.items.length; j++) {\n                        const item = listToken.items[j];\n                        const checked = item.checked;\n                        const task = item.task;\n                        let itemBody = '';\n                        if (item.task) {\n                            const checkbox = this.renderer.checkbox(!!checked);\n                            if (loose) {\n                                if (item.tokens.length > 0 && item.tokens[0].type === 'paragraph') {\n                                    item.tokens[0].text = checkbox + ' ' + item.tokens[0].text;\n                                    if (item.tokens[0].tokens && item.tokens[0].tokens.length > 0 && item.tokens[0].tokens[0].type === 'text') {\n                                        item.tokens[0].tokens[0].text = checkbox + ' ' + item.tokens[0].tokens[0].text;\n                                    }\n                                }\n                                else {\n                                    item.tokens.unshift({\n                                        type: 'text',\n                                        text: checkbox + ' '\n                                    });\n                                }\n                            }\n                            else {\n                                itemBody += checkbox + ' ';\n                            }\n                        }\n                        itemBody += this.parse(item.tokens, loose);\n                        body += this.renderer.listitem(itemBody, task, !!checked);\n                    }\n                    out += this.renderer.list(body, ordered, start);\n                    continue;\n                }\n                case 'html': {\n                    const htmlToken = token;\n                    out += this.renderer.html(htmlToken.text, htmlToken.block);\n                    continue;\n                }\n                case 'paragraph': {\n                    const paragraphToken = token;\n                    out += this.renderer.paragraph(this.parseInline(paragraphToken.tokens));\n                    continue;\n                }\n                case 'text': {\n                    let textToken = token;\n                    let body = textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text;\n                    while (i + 1 < tokens.length && tokens[i + 1].type === 'text') {\n                        textToken = tokens[++i];\n                        body += '\\n' + (textToken.tokens ? this.parseInline(textToken.tokens) : textToken.text);\n                    }\n                    out += top ? this.renderer.paragraph(body) : body;\n                    continue;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n    /**\n     * Parse Inline Tokens\n     */\n    parseInline(tokens, renderer) {\n        renderer = renderer || this.renderer;\n        let out = '';\n        for (let i = 0; i < tokens.length; i++) {\n            const token = tokens[i];\n            // Run any renderer extensions\n            if (this.options.extensions && this.options.extensions.renderers && this.options.extensions.renderers[token.type]) {\n                const ret = this.options.extensions.renderers[token.type].call({ parser: this }, token);\n                if (ret !== false || !['escape', 'html', 'link', 'image', 'strong', 'em', 'codespan', 'br', 'del', 'text'].includes(token.type)) {\n                    out += ret || '';\n                    continue;\n                }\n            }\n            switch (token.type) {\n                case 'escape': {\n                    const escapeToken = token;\n                    out += renderer.text(escapeToken.text);\n                    break;\n                }\n                case 'html': {\n                    const tagToken = token;\n                    out += renderer.html(tagToken.text);\n                    break;\n                }\n                case 'link': {\n                    const linkToken = token;\n                    out += renderer.link(linkToken.href, linkToken.title, this.parseInline(linkToken.tokens, renderer));\n                    break;\n                }\n                case 'image': {\n                    const imageToken = token;\n                    out += renderer.image(imageToken.href, imageToken.title, imageToken.text);\n                    break;\n                }\n                case 'strong': {\n                    const strongToken = token;\n                    out += renderer.strong(this.parseInline(strongToken.tokens, renderer));\n                    break;\n                }\n                case 'em': {\n                    const emToken = token;\n                    out += renderer.em(this.parseInline(emToken.tokens, renderer));\n                    break;\n                }\n                case 'codespan': {\n                    const codespanToken = token;\n                    out += renderer.codespan(codespanToken.text);\n                    break;\n                }\n                case 'br': {\n                    out += renderer.br();\n                    break;\n                }\n                case 'del': {\n                    const delToken = token;\n                    out += renderer.del(this.parseInline(delToken.tokens, renderer));\n                    break;\n                }\n                case 'text': {\n                    const textToken = token;\n                    out += renderer.text(textToken.text);\n                    break;\n                }\n                default: {\n                    const errMsg = 'Token with \"' + token.type + '\" type was not found.';\n                    if (this.options.silent) {\n                        console.error(errMsg);\n                        return '';\n                    }\n                    else {\n                        throw new Error(errMsg);\n                    }\n                }\n            }\n        }\n        return out;\n    }\n}\n\nclass _Hooks {\n    options;\n    constructor(options) {\n        this.options = options || _defaults;\n    }\n    static passThroughHooks = new Set([\n        'preprocess',\n        'postprocess',\n        'processAllTokens'\n    ]);\n    /**\n     * Process markdown before marked\n     */\n    preprocess(markdown) {\n        return markdown;\n    }\n    /**\n     * Process HTML after marked is finished\n     */\n    postprocess(html) {\n        return html;\n    }\n    /**\n     * Process all tokens before walk tokens\n     */\n    processAllTokens(tokens) {\n        return tokens;\n    }\n}\n\nclass Marked {\n    defaults = _getDefaults();\n    options = this.setOptions;\n    parse = this.#parseMarkdown(_Lexer.lex, _Parser.parse);\n    parseInline = this.#parseMarkdown(_Lexer.lexInline, _Parser.parseInline);\n    Parser = _Parser;\n    Renderer = _Renderer;\n    TextRenderer = _TextRenderer;\n    Lexer = _Lexer;\n    Tokenizer = _Tokenizer;\n    Hooks = _Hooks;\n    constructor(...args) {\n        this.use(...args);\n    }\n    /**\n     * Run callback for every token\n     */\n    walkTokens(tokens, callback) {\n        let values = [];\n        for (const token of tokens) {\n            values = values.concat(callback.call(this, token));\n            switch (token.type) {\n                case 'table': {\n                    const tableToken = token;\n                    for (const cell of tableToken.header) {\n                        values = values.concat(this.walkTokens(cell.tokens, callback));\n                    }\n                    for (const row of tableToken.rows) {\n                        for (const cell of row) {\n                            values = values.concat(this.walkTokens(cell.tokens, callback));\n                        }\n                    }\n                    break;\n                }\n                case 'list': {\n                    const listToken = token;\n                    values = values.concat(this.walkTokens(listToken.items, callback));\n                    break;\n                }\n                default: {\n                    const genericToken = token;\n                    if (this.defaults.extensions?.childTokens?.[genericToken.type]) {\n                        this.defaults.extensions.childTokens[genericToken.type].forEach((childTokens) => {\n                            const tokens = genericToken[childTokens].flat(Infinity);\n                            values = values.concat(this.walkTokens(tokens, callback));\n                        });\n                    }\n                    else if (genericToken.tokens) {\n                        values = values.concat(this.walkTokens(genericToken.tokens, callback));\n                    }\n                }\n            }\n        }\n        return values;\n    }\n    use(...args) {\n        const extensions = this.defaults.extensions || { renderers: {}, childTokens: {} };\n        args.forEach((pack) => {\n            // copy options to new object\n            const opts = { ...pack };\n            // set async to true if it was set to true before\n            opts.async = this.defaults.async || opts.async || false;\n            // ==-- Parse \"addon\" extensions --== //\n            if (pack.extensions) {\n                pack.extensions.forEach((ext) => {\n                    if (!ext.name) {\n                        throw new Error('extension name required');\n                    }\n                    if ('renderer' in ext) { // Renderer extensions\n                        const prevRenderer = extensions.renderers[ext.name];\n                        if (prevRenderer) {\n                            // Replace extension with func to run new extension but fall back if false\n                            extensions.renderers[ext.name] = function (...args) {\n                                let ret = ext.renderer.apply(this, args);\n                                if (ret === false) {\n                                    ret = prevRenderer.apply(this, args);\n                                }\n                                return ret;\n                            };\n                        }\n                        else {\n                            extensions.renderers[ext.name] = ext.renderer;\n                        }\n                    }\n                    if ('tokenizer' in ext) { // Tokenizer Extensions\n                        if (!ext.level || (ext.level !== 'block' && ext.level !== 'inline')) {\n                            throw new Error(\"extension level must be 'block' or 'inline'\");\n                        }\n                        const extLevel = extensions[ext.level];\n                        if (extLevel) {\n                            extLevel.unshift(ext.tokenizer);\n                        }\n                        else {\n                            extensions[ext.level] = [ext.tokenizer];\n                        }\n                        if (ext.start) { // Function to check for start of token\n                            if (ext.level === 'block') {\n                                if (extensions.startBlock) {\n                                    extensions.startBlock.push(ext.start);\n                                }\n                                else {\n                                    extensions.startBlock = [ext.start];\n                                }\n                            }\n                            else if (ext.level === 'inline') {\n                                if (extensions.startInline) {\n                                    extensions.startInline.push(ext.start);\n                                }\n                                else {\n                                    extensions.startInline = [ext.start];\n                                }\n                            }\n                        }\n                    }\n                    if ('childTokens' in ext && ext.childTokens) { // Child tokens to be visited by walkTokens\n                        extensions.childTokens[ext.name] = ext.childTokens;\n                    }\n                });\n                opts.extensions = extensions;\n            }\n            // ==-- Parse \"overwrite\" extensions --== //\n            if (pack.renderer) {\n                const renderer = this.defaults.renderer || new _Renderer(this.defaults);\n                for (const prop in pack.renderer) {\n                    if (!(prop in renderer)) {\n                        throw new Error(`renderer '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const rendererProp = prop;\n                    const rendererFunc = pack.renderer[rendererProp];\n                    const prevRenderer = renderer[rendererProp];\n                    // Replace renderer with func to run extension, but fall back if false\n                    renderer[rendererProp] = (...args) => {\n                        let ret = rendererFunc.apply(renderer, args);\n                        if (ret === false) {\n                            ret = prevRenderer.apply(renderer, args);\n                        }\n                        return ret || '';\n                    };\n                }\n                opts.renderer = renderer;\n            }\n            if (pack.tokenizer) {\n                const tokenizer = this.defaults.tokenizer || new _Tokenizer(this.defaults);\n                for (const prop in pack.tokenizer) {\n                    if (!(prop in tokenizer)) {\n                        throw new Error(`tokenizer '${prop}' does not exist`);\n                    }\n                    if (['options', 'rules', 'lexer'].includes(prop)) {\n                        // ignore options, rules, and lexer properties\n                        continue;\n                    }\n                    const tokenizerProp = prop;\n                    const tokenizerFunc = pack.tokenizer[tokenizerProp];\n                    const prevTokenizer = tokenizer[tokenizerProp];\n                    // Replace tokenizer with func to run extension, but fall back if false\n                    // @ts-expect-error cannot type tokenizer function dynamically\n                    tokenizer[tokenizerProp] = (...args) => {\n                        let ret = tokenizerFunc.apply(tokenizer, args);\n                        if (ret === false) {\n                            ret = prevTokenizer.apply(tokenizer, args);\n                        }\n                        return ret;\n                    };\n                }\n                opts.tokenizer = tokenizer;\n            }\n            // ==-- Parse Hooks extensions --== //\n            if (pack.hooks) {\n                const hooks = this.defaults.hooks || new _Hooks();\n                for (const prop in pack.hooks) {\n                    if (!(prop in hooks)) {\n                        throw new Error(`hook '${prop}' does not exist`);\n                    }\n                    if (prop === 'options') {\n                        // ignore options property\n                        continue;\n                    }\n                    const hooksProp = prop;\n                    const hooksFunc = pack.hooks[hooksProp];\n                    const prevHook = hooks[hooksProp];\n                    if (_Hooks.passThroughHooks.has(prop)) {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (arg) => {\n                            if (this.defaults.async) {\n                                return Promise.resolve(hooksFunc.call(hooks, arg)).then(ret => {\n                                    return prevHook.call(hooks, ret);\n                                });\n                            }\n                            const ret = hooksFunc.call(hooks, arg);\n                            return prevHook.call(hooks, ret);\n                        };\n                    }\n                    else {\n                        // @ts-expect-error cannot type hook function dynamically\n                        hooks[hooksProp] = (...args) => {\n                            let ret = hooksFunc.apply(hooks, args);\n                            if (ret === false) {\n                                ret = prevHook.apply(hooks, args);\n                            }\n                            return ret;\n                        };\n                    }\n                }\n                opts.hooks = hooks;\n            }\n            // ==-- Parse WalkTokens extensions --== //\n            if (pack.walkTokens) {\n                const walkTokens = this.defaults.walkTokens;\n                const packWalktokens = pack.walkTokens;\n                opts.walkTokens = function (token) {\n                    let values = [];\n                    values.push(packWalktokens.call(this, token));\n                    if (walkTokens) {\n                        values = values.concat(walkTokens.call(this, token));\n                    }\n                    return values;\n                };\n            }\n            this.defaults = { ...this.defaults, ...opts };\n        });\n        return this;\n    }\n    setOptions(opt) {\n        this.defaults = { ...this.defaults, ...opt };\n        return this;\n    }\n    lexer(src, options) {\n        return _Lexer.lex(src, options ?? this.defaults);\n    }\n    parser(tokens, options) {\n        return _Parser.parse(tokens, options ?? this.defaults);\n    }\n    #parseMarkdown(lexer, parser) {\n        return (src, options) => {\n            const origOpt = { ...options };\n            const opt = { ...this.defaults, ...origOpt };\n            // Show warning if an extension set async to true but the parse was called with async: false\n            if (this.defaults.async === true && origOpt.async === false) {\n                if (!opt.silent) {\n                    console.warn('marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored.');\n                }\n                opt.async = true;\n            }\n            const throwError = this.#onError(!!opt.silent, !!opt.async);\n            // throw error in case of non string input\n            if (typeof src === 'undefined' || src === null) {\n                return throwError(new Error('marked(): input parameter is undefined or null'));\n            }\n            if (typeof src !== 'string') {\n                return throwError(new Error('marked(): input parameter is of type '\n                    + Object.prototype.toString.call(src) + ', string expected'));\n            }\n            if (opt.hooks) {\n                opt.hooks.options = opt;\n            }\n            if (opt.async) {\n                return Promise.resolve(opt.hooks ? opt.hooks.preprocess(src) : src)\n                    .then(src => lexer(src, opt))\n                    .then(tokens => opt.hooks ? opt.hooks.processAllTokens(tokens) : tokens)\n                    .then(tokens => opt.walkTokens ? Promise.all(this.walkTokens(tokens, opt.walkTokens)).then(() => tokens) : tokens)\n                    .then(tokens => parser(tokens, opt))\n                    .then(html => opt.hooks ? opt.hooks.postprocess(html) : html)\n                    .catch(throwError);\n            }\n            try {\n                if (opt.hooks) {\n                    src = opt.hooks.preprocess(src);\n                }\n                let tokens = lexer(src, opt);\n                if (opt.hooks) {\n                    tokens = opt.hooks.processAllTokens(tokens);\n                }\n                if (opt.walkTokens) {\n                    this.walkTokens(tokens, opt.walkTokens);\n                }\n                let html = parser(tokens, opt);\n                if (opt.hooks) {\n                    html = opt.hooks.postprocess(html);\n                }\n                return html;\n            }\n            catch (e) {\n                return throwError(e);\n            }\n        };\n    }\n    #onError(silent, async) {\n        return (e) => {\n            e.message += '\\nPlease report this to https://github.com/markedjs/marked.';\n            if (silent) {\n                const msg = '<p>An error occurred:</p><pre>'\n                    + escape$1(e.message + '', true)\n                    + '</pre>';\n                if (async) {\n                    return Promise.resolve(msg);\n                }\n                return msg;\n            }\n            if (async) {\n                return Promise.reject(e);\n            }\n            throw e;\n        };\n    }\n}\n\nconst markedInstance = new Marked();\nfunction marked(src, opt) {\n    return markedInstance.parse(src, opt);\n}\n/**\n * Sets the default options.\n *\n * @param options Hash of options\n */\nmarked.options =\n    marked.setOptions = function (options) {\n        markedInstance.setOptions(options);\n        marked.defaults = markedInstance.defaults;\n        changeDefaults(marked.defaults);\n        return marked;\n    };\n/**\n * Gets the original marked default options.\n */\nmarked.getDefaults = _getDefaults;\nmarked.defaults = _defaults;\n/**\n * Use Extension\n */\nmarked.use = function (...args) {\n    markedInstance.use(...args);\n    marked.defaults = markedInstance.defaults;\n    changeDefaults(marked.defaults);\n    return marked;\n};\n/**\n * Run callback for every token\n */\nmarked.walkTokens = function (tokens, callback) {\n    return markedInstance.walkTokens(tokens, callback);\n};\n/**\n * Compiles markdown to HTML without enclosing `p` tag.\n *\n * @param src String of markdown source to be compiled\n * @param options Hash of options\n * @return String of compiled HTML\n */\nmarked.parseInline = markedInstance.parseInline;\n/**\n * Expose\n */\nmarked.Parser = _Parser;\nmarked.parser = _Parser.parse;\nmarked.Renderer = _Renderer;\nmarked.TextRenderer = _TextRenderer;\nmarked.Lexer = _Lexer;\nmarked.lexer = _Lexer.lex;\nmarked.Tokenizer = _Tokenizer;\nmarked.Hooks = _Hooks;\nmarked.parse = marked;\nconst options = marked.options;\nconst setOptions = marked.setOptions;\nconst use = marked.use;\nconst walkTokens = marked.walkTokens;\nconst parseInline = marked.parseInline;\nconst parse = marked;\nconst parser = _Parser.parse;\nconst lexer = _Lexer.lex;\n\nexport { _Hooks as Hooks, _Lexer as Lexer, Marked, _Parser as Parser, _Renderer as Renderer, _TextRenderer as TextRenderer, _Tokenizer as Tokenizer, _defaults as defaults, _getDefaults as getDefaults, lexer, marked, options, parse, parseInline, parser, setOptions, use, walkTokens };\n//# sourceMappingURL=marked.esm.js.map\n","'use strict';\n\nvar escapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#39;'\n};\nvar unescapes = {\n  '&amp;': '&',\n  '&lt;': '<',\n  '&gt;': '>',\n  '&quot;': '\"',\n  '&#39;': \"'\"\n};\nvar rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\nvar runescaped = /[&<>\"']/g;\n\nfunction escapeHtmlChar (match) {\n  return escapes[match];\n}\nfunction unescapeHtmlChar (match) {\n  return unescapes[match];\n}\n\nfunction escapeHtml (text) {\n  return text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n}\n\nfunction unescapeHtml (html) {\n  return html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n}\n\nescapeHtml.options = unescapeHtml.options = {};\n\nmodule.exports = {\n  encode: escapeHtml,\n  escape: escapeHtml,\n  decode: unescapeHtml,\n  unescape: unescapeHtml,\n  version: '1.0.0-browser'\n};\n","'use strict';\n\nfunction assignment (result) {\n  var stack = Array.prototype.slice.call(arguments, 1);\n  var item;\n  var key;\n  while (stack.length) {\n    item = stack.shift();\n    for (key in item) {\n      if (item.hasOwnProperty(key)) {\n        if (Object.prototype.toString.call(result[key]) === '[object Object]') {\n          result[key] = assignment(result[key], item[key]);\n        } else {\n          result[key] = item[key];\n        }\n      }\n    }\n  }\n  return result;\n}\n\nmodule.exports = assignment;\n","'use strict';\n\nmodule.exports = function lowercase (string) {\n  return typeof string === 'string' ? string.toLowerCase() : string;\n};\n","'use strict';\n\nfunction toMap (list) {\n  return list.reduce(asKey, {});\n}\n\nfunction asKey (accumulator, item) {\n  accumulator[item] = true;\n  return accumulator;\n}\n\nmodule.exports = toMap;\n","'use strict';\n\nvar toMap = require('./toMap');\nvar uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n\nmodule.exports = {\n  uris: toMap(uris) // attributes that have an href and hence need to be sanitized\n};\n","'use strict';\n\nvar toMap = require('./toMap');\nvar voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n\nmodule.exports = {\n  voids: toMap(voids)\n};\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\nvar rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\nvar rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\nvar rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\nvar rtag = /^</;\nvar rtagend = /^<\\s*\\//;\n\nfunction createStack () {\n  var stack = [];\n  stack.lastItem = function lastItem () {\n    return stack[stack.length - 1];\n  };\n  return stack;\n}\n\nfunction parser (html, handler) {\n  var stack = createStack();\n  var last = html;\n  var chars;\n\n  while (html) {\n    parsePart();\n  }\n  parseEndTag(); // clean up any remaining tags\n\n  function parsePart () {\n    chars = true;\n    parseTag();\n\n    var same = html === last;\n    last = html;\n\n    if (same) { // discard, because it's invalid\n      html = '';\n    }\n  }\n\n  function parseTag () {\n    if (html.substr(0, 4) === '<!--') { // comments\n      parseComment();\n    } else if (rtagend.test(html)) {\n      parseEdge(rend, parseEndTag);\n    } else if (rtag.test(html)) {\n      parseEdge(rstart, parseStartTag);\n    }\n    parseTagDecode();\n  }\n\n  function parseEdge (regex, parser) {\n    var match = html.match(regex);\n    if (match) {\n      html = html.substring(match[0].length);\n      match[0].replace(regex, parser);\n      chars = false;\n    }\n  }\n\n  function parseComment () {\n    var index = html.indexOf('-->');\n    if (index >= 0) {\n      if (handler.comment) {\n        handler.comment(html.substring(4, index));\n      }\n      html = html.substring(index + 3);\n      chars = false;\n    }\n  }\n\n  function parseTagDecode () {\n    if (!chars) {\n      return;\n    }\n    var text;\n    var index = html.indexOf('<');\n    if (index >= 0) {\n      text = html.substring(0, index);\n      html = html.substring(index);\n    } else {\n      text = html;\n      html = '';\n    }\n    if (handler.chars) {\n      handler.chars(text);\n    }\n  }\n\n  function parseStartTag (tag, tagName, rest, unary) {\n    var attrs = {};\n    var low = lowercase(tagName);\n    var u = elements.voids[low] || !!unary;\n\n    rest.replace(rattrs, attrReplacer);\n\n    if (!u) {\n      stack.push(low);\n    }\n    if (handler.start) {\n      handler.start(low, attrs, u);\n    }\n\n    function attrReplacer (match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n      if (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n        attrs[name] = void 0; // attribute is like <button disabled></button>\n      } else {\n        attrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n      }\n    }\n  }\n\n  function parseEndTag (tag, tagName) {\n    var i;\n    var pos = 0;\n    var low = lowercase(tagName);\n    if (low) {\n      for (pos = stack.length - 1; pos >= 0; pos--) {\n        if (stack[pos] === low) {\n          break; // find the closest opened tag of the same type\n        }\n      }\n    }\n    if (pos >= 0) {\n      for (i = stack.length - 1; i >= pos; i--) {\n        if (handler.end) { // close all the open elements, up the stack\n          handler.end(stack[i]);\n        }\n      }\n      stack.length = pos;\n    }\n  }\n}\n\nmodule.exports = parser;\n","'use strict';\n\nvar he = require('he');\nvar lowercase = require('./lowercase');\nvar attributes = require('./attributes');\nvar elements = require('./elements');\n\nfunction sanitizer (buffer, options) {\n  var last;\n  var context;\n  var o = options || {};\n\n  reset();\n\n  return {\n    start: start,\n    end: end,\n    chars: chars\n  };\n\n  function out (value) {\n    buffer.push(value);\n  }\n\n  function start (tag, attrs, unary) {\n    var low = lowercase(tag);\n\n    if (context.ignoring) {\n      ignore(low); return;\n    }\n    if ((o.allowedTags || []).indexOf(low) === -1) {\n      ignore(low); return;\n    }\n    if (o.filter && !o.filter({ tag: low, attrs: attrs })) {\n      ignore(low); return;\n    }\n\n    out('<');\n    out(low);\n    Object.keys(attrs).forEach(parse);\n    out(unary ? '/>' : '>');\n\n    function parse (key) {\n      var value = attrs[key];\n      var classesOk = (o.allowedClasses || {})[low] || [];\n      var attrsOk = (o.allowedAttributes || {})[low] || [];\n      var valid;\n      var lkey = lowercase(key);\n      if (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n        value = value.split(' ').filter(isValidClass).join(' ').trim();\n        valid = value.length;\n      } else {\n        valid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n      }\n      if (valid) {\n        out(' ');\n        out(key);\n        if (typeof value === 'string') {\n          out('=\"');\n          out(he.encode(value));\n          out('\"');\n        }\n      }\n      function isValidClass (className) {\n        return classesOk && classesOk.indexOf(className) !== -1;\n      }\n    }\n  }\n\n  function end (tag) {\n    var low = lowercase(tag);\n    var allowed = (o.allowedTags || []).indexOf(low) !== -1;\n    if (allowed) {\n      if (context.ignoring === false) {\n        out('</');\n        out(low);\n        out('>');\n      } else {\n        unignore(low);\n      }\n    } else {\n      unignore(low);\n    }\n  }\n\n  function testUrl (text) {\n    var start = text[0];\n    if (start === '#' || start === '/') {\n      return true;\n    }\n    var colon = text.indexOf(':');\n    if (colon === -1) {\n      return true;\n    }\n    var questionmark = text.indexOf('?');\n    if (questionmark !== -1 && colon > questionmark) {\n      return true;\n    }\n    var hash = text.indexOf('#');\n    if (hash !== -1 && colon > hash) {\n      return true;\n    }\n    return o.allowedSchemes.some(matches);\n\n    function matches (scheme) {\n      return text.indexOf(scheme + ':') === 0;\n    }\n  }\n\n  function chars (text) {\n    if (context.ignoring === false) {\n      out(o.transformText ? o.transformText(text) : text);\n    }\n  }\n\n  function ignore (tag) {\n    if (elements.voids[tag]) {\n      return;\n    }\n    if (context.ignoring === false) {\n      context = { ignoring: tag, depth: 1 };\n    } else if (context.ignoring === tag) {\n      context.depth++;\n    }\n  }\n\n  function unignore (tag) {\n    if (context.ignoring === tag) {\n      if (--context.depth <= 0) {\n        reset();\n      }\n    }\n  }\n\n  function reset () {\n    context = { ignoring: false, depth: 0 };\n  }\n}\n\nmodule.exports = sanitizer;\n","'use strict';\n\nvar defaults = {\n  allowedAttributes: {\n    a: ['href', 'name', 'target', 'title', 'aria-label'],\n    iframe: ['allowfullscreen', 'frameborder', 'src'],\n    img: ['src', 'alt', 'title', 'aria-label']\n  },\n  allowedClasses: {},\n  allowedSchemes: ['http', 'https', 'mailto'],\n  allowedTags: [\n    'a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em',\n    'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark',\n    'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table',\n    'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'\n  ],\n  filter: null\n};\n\nmodule.exports = defaults;\n","'use strict';\n\nvar he = require('he');\nvar assign = require('assignment');\nvar parser = require('./parser');\nvar sanitizer = require('./sanitizer');\nvar defaults = require('./defaults');\n\nfunction insane (html, options, strict) {\n  var buffer = [];\n  var configuration = strict === true ? options : assign({}, defaults, options);\n  var handler = sanitizer(buffer, configuration);\n\n  parser(html, handler);\n\n  return buffer.join('');\n}\n\ninsane.defaults = defaults;\nmodule.exports = insane;\n","import insane from 'insane'\r\n\r\nconst insaneOptions = {\r\n  allowedClasses: {},\r\n  // @refer CVE-2018-8495\r\n  // @link https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8495\r\n  // @link https://leucosite.com/Microsoft-Edge-RCE/\r\n  // @link https://medium.com/@knownsec404team/analysis-of-the-security-issues-of-url-scheme-in-pc-from-cve-2018-8495-934478a36756\r\n  allowedSchemes: [\r\n    'http',\r\n    'https',\r\n    'mailto',\r\n    'data', // for support base64 encoded image (安全性有待考虑)\r\n  ],\r\n  allowedTags: [\r\n    'a',\r\n    'abbr',\r\n    'article',\r\n    'b',\r\n    'blockquote',\r\n    'br',\r\n    'caption',\r\n    'code',\r\n    'del',\r\n    'details',\r\n    'div',\r\n    'em',\r\n    'h1',\r\n    'h2',\r\n    'h3',\r\n    'h4',\r\n    'h5',\r\n    'h6',\r\n    'hr',\r\n    'i',\r\n    'img',\r\n    'ins',\r\n    'kbd',\r\n    'li',\r\n    'main',\r\n    'mark',\r\n    'ol',\r\n    'p',\r\n    'pre',\r\n    'section',\r\n    'span',\r\n    'strike',\r\n    'strong',\r\n    'sub',\r\n    'summary',\r\n    'sup',\r\n    'table',\r\n    'tbody',\r\n    'td',\r\n    'th',\r\n    'thead',\r\n    'tr',\r\n    'u',\r\n    'ul',\r\n  ],\r\n  allowedAttributes: {\r\n    '*': ['title', 'accesskey'],\r\n    a: ['href', 'name', 'target', 'aria-label', 'rel'],\r\n    img: ['src', 'alt', 'title', 'atk-emoticon', 'aria-label', 'data-src', 'class', 'loading'],\r\n    // for code highlight\r\n    code: ['class'],\r\n    span: ['class', 'style'],\r\n  },\r\n  filter: (node) => {\r\n    // class whitelist\r\n    const allowed = [\r\n      ['code', /^hljs\\W+language-(.*)$/],\r\n      ['span', /^(hljs-.*)$/],\r\n      ['img', /^lazyload$/],\r\n    ]\r\n    allowed.forEach(([tag, reg]) => {\r\n      if (node.tag === tag && !!node.attrs.class && !(reg as RegExp).test(node.attrs.class)) {\r\n        delete node.attrs.class\r\n      }\r\n    })\r\n\r\n    // allow <span> set color sty\r\n    if (\r\n      node.tag === 'span' &&\r\n      !!node.attrs.style &&\r\n      !/^color:(\\W+)?#[0-9a-f]{3,6};?$/i.test(node.attrs.style)\r\n    ) {\r\n      delete node.attrs.style\r\n    }\r\n\r\n    return true\r\n  },\r\n}\r\n\r\nexport function sanitize(content: string): string {\r\n  // @link https://github.com/markedjs/marked/discussions/1232\r\n  // @link https://gist.github.com/lionel-rowe/bb384465ba4e4c81a9c8dada84167225\r\n  return insane(content, insaneOptions)\r\n}\r\n","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global.hanabi = factory());\n}(this, (function () { 'use strict';\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar index$1 = createCommonjsModule(function (module) {\n'use strict';\n\nvar comment = module.exports = function () {\n\treturn new RegExp('(?:' + comment.line().source + ')|(?:' + comment.block().source + ')', 'gm');\n};\n\ncomment.line = function () {\n\treturn /(?:^|\\s)\\/\\/(.+?)$/gm;\n};\n\ncomment.block = function () {\n\treturn /\\/\\*([\\S\\s]*?)\\*\\//gm;\n};\n});\n\nvar defaultColors = ['23AC69', '91C132', 'F19726', 'E8552D', '1AAB8E', 'E1147F', '2980C1', '1BA1E6', '9FA0A0', 'F19726', 'E30B20', 'E30B20', 'A3338B'];\n\nvar index = function (input, ref) {\n  if ( ref === void 0 ) ref = {};\n  var colors = ref.colors; if ( colors === void 0 ) colors = defaultColors;\n\n  var index = 0;\n  var cache = {};\n  var wordRe = /[\\u4E00-\\u9FFF\\u3400-\\u4dbf\\uf900-\\ufaff\\u3040-\\u309f\\uac00-\\ud7af\\u0400-\\u04FF]+|\\w+/;\n  var leftAngleRe = /</;\n\n  var re = new RegExp((\"(\" + (wordRe.source) + \"|\" + (leftAngleRe.source) + \")|(\" + (index$1().source) + \")\"), 'gmi');\n  return input\n  .replace(re, function (m, word, cm) {\n    if (cm) {\n      return toComment(cm)\n    }\n\n    if (word === '<') {\n      return '&lt;'\n    }\n    var color;\n    if (cache[word]) {\n      color = cache[word];\n    } else {\n      color = colors[index];\n      cache[word] = color;\n    }\n\n    var out = \"<span style=\\\"color: #\" + color + \"\\\">\" + word + \"</span>\";\n    index = ++index % colors.length;\n    return out\n  })\n};\n\nfunction toComment(cm) {\n  return (\"<span style=\\\"color: slategray\\\">\" + cm + \"</span>\")\n}\n\nreturn index;\n\n})));\n","import hanabi from 'hanabi'\r\n\r\nexport function renderCode(code: string) {\r\n  return hanabi(code)\r\n}\r\n","import { marked } from 'marked'\r\nimport { renderCode } from './highlight'\r\nimport type { ArtalkConfig } from '@/types'\r\n\r\nexport interface RendererOptions {\r\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\r\n}\r\n\r\nexport function getRenderer(options: RendererOptions) {\r\n  const renderer = new marked.Renderer()\r\n  renderer.link = markedLinkRenderer(renderer, renderer.link)\r\n  renderer.code = markedCodeRenderer()\r\n  renderer.image = markedImageRenderer(renderer, renderer.image, options)\r\n  return renderer\r\n}\r\n\r\nconst markedLinkRenderer =\r\n  (renderer: any, orgLinkRenderer: (href: string, title: string, text: string) => string) =>\r\n  (href: string, title: string, text: string): string => {\r\n    const getLinkOrigin = (link: string) => {\r\n      try {\r\n        return new URL(link).origin\r\n      } catch {\r\n        return ''\r\n      }\r\n    }\r\n    const isSameOriginLink = getLinkOrigin(href) === window.location.origin\r\n    const html = orgLinkRenderer.call(renderer, href, title, text)\r\n    return html.replace(\r\n      /^<a /,\r\n      `<a target=\"_blank\" ${!isSameOriginLink ? `rel=\"noreferrer noopener nofollow\"` : ''} `,\r\n    )\r\n  }\r\n\r\nconst markedCodeRenderer =\r\n  () =>\r\n  (block: string, lang: string | undefined): string => {\r\n    // Colorize the block only if the language is known to highlight.js\r\n    const realLang = !lang ? 'plaintext' : lang\r\n    let colorized = block\r\n    if ((window as any).hljs) {\r\n      if (realLang && (window as any).hljs.getLanguage(realLang)) {\r\n        colorized = (window as any).hljs.highlight(realLang, block).value\r\n      }\r\n    } else {\r\n      colorized = renderCode(block)\r\n    }\r\n\r\n    return (\r\n      `<pre rel=\"${realLang}\">\\n` +\r\n      `<code class=\"hljs language-${realLang}\">${colorized.replace(/&amp;/g, '&')}</code>\\n` +\r\n      `</pre>`\r\n    )\r\n  }\r\n\r\nconst markedImageRenderer =\r\n  (\r\n    renderer: any,\r\n    orgImageRenderer: (href: string, title: string | null, text: string) => string,\r\n    { imgLazyLoad }: RendererOptions,\r\n  ) =>\r\n  (href: string, title: string | null, text: string): string => {\r\n    const html = orgImageRenderer.call(renderer, href, title, text)\r\n    if (!imgLazyLoad) return html\r\n    if (imgLazyLoad === 'native' || (imgLazyLoad as any) === true)\r\n      return html.replace(/^<img /, '<img class=\"lazyload\" loading=\"lazy\" ')\r\n    if (imgLazyLoad === 'data-src')\r\n      return html.replace(/^<img /, '<img class=\"lazyload\" ').replace('src=', 'data-src=')\r\n    return html\r\n  }\r\n","import { marked as libMarked, MarkedOptions } from 'marked'\r\n\r\nimport { sanitize } from './sanitizer'\r\nimport { renderCode } from './highlight'\r\nimport { getRenderer } from './marked-renderer'\r\nimport type { ArtalkConfig } from '@/types'\r\n\r\ntype Replacer = (raw: string) => string\r\n\r\nlet instance: typeof libMarked | undefined\r\nlet replacers: Replacer[] = []\r\n\r\nconst markedOptions: MarkedOptions = {\r\n  gfm: true,\r\n  breaks: true,\r\n  async: false,\r\n}\r\n\r\n/** Get Marked instance */\r\nexport function getInstance() {\r\n  return instance\r\n}\r\n\r\nexport function setReplacers(arr: Replacer[]) {\r\n  replacers = arr\r\n}\r\n\r\nexport interface MarkedInitOptions {\r\n  markedOptions: ArtalkConfig['markedOptions']\r\n  imgLazyLoad: ArtalkConfig['imgLazyLoad']\r\n}\r\n\r\n/** 初始化 marked */\r\nexport function initMarked(options: MarkedInitOptions) {\r\n  try {\r\n    if (!libMarked.name) return\r\n  } catch {\r\n    return\r\n  }\r\n\r\n  // @see https://github.com/markedjs/marked/blob/4afb228d956a415624c4e5554bb8f25d047676fe/src/Tokenizer.js#L329\r\n  libMarked.setOptions({\r\n    renderer: getRenderer({\r\n      imgLazyLoad: options.imgLazyLoad,\r\n    }),\r\n    ...markedOptions,\r\n    ...options.markedOptions,\r\n  })\r\n\r\n  instance = libMarked\r\n}\r\n\r\n/** 解析 markdown */\r\nexport default function marked(src: string): string {\r\n  let markedContent = getInstance()?.parse(src) as string\r\n  if (!markedContent) {\r\n    // 无 Markdown 模式简单处理\r\n    markedContent = simpleMarked(src)\r\n  }\r\n\r\n  let dest = sanitize(markedContent)\r\n\r\n  // 内容替换器\r\n  replacers.forEach((replacer) => {\r\n    if (typeof replacer === 'function') dest = replacer(dest)\r\n  })\r\n\r\n  return dest\r\n}\r\n\r\nfunction simpleMarked(src: string) {\r\n  return (\r\n    src\r\n      // .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\r\n      .replace(\r\n        /```\\s*([^]+?.*?[^]+?[^]+?)```/g,\r\n        (_, code) => `<pre><code>${renderCode(code)}</code></pre>`,\r\n      )\r\n      // .replace(/`([^`]+?)`/g, '<code>$1</code>')\r\n      .replace(/!\\[(.*?)\\]\\((.*?)\\)/g, (_, alt, imgSrc) => `<img src=\"${imgSrc}\" alt=\"${alt}\" />`)\r\n      .replace(\r\n        /\\[(.*?)\\]\\((.*?)\\)/g,\r\n        (_, text, link) => `<a href=\"${link}\" target=\"_blank\">${text}</a>`,\r\n      )\r\n      .replace(/\\n/g, '<br>')\r\n  )\r\n}\r\n","/**\r\n * Performs a deep merge of objects and returns new object.\r\n * Does not modify objects (immutable) and merges arrays via concatenation.\r\n *\r\n * @param objects - Objects to merge\r\n * @returns New object with merged key/values\r\n */\r\nexport function mergeDeep<T>(...objects: any[]): T {\r\n  const isObject = (obj: any) => obj && typeof obj === 'object' && obj.constructor === Object\r\n\r\n  return objects.reduce((prev, obj) => {\r\n    Object.keys(obj ?? {}).forEach((key) => {\r\n      // Avoid prototype pollution\r\n      if (key === '__proto__' || key === 'constructor' || key === 'prototype') {\r\n        return\r\n      }\r\n\r\n      const pVal = prev[key]\r\n      const oVal = obj[key]\r\n\r\n      if (Array.isArray(pVal) && Array.isArray(oVal)) {\r\n        prev[key] = pVal.concat(...oVal)\r\n      } else if (isObject(pVal) && isObject(oVal)) {\r\n        prev[key] = mergeDeep(pVal, oVal)\r\n      } else {\r\n        prev[key] = oVal\r\n      }\r\n    })\r\n\r\n    return prev\r\n  }, {})\r\n}\r\n","import EventManager from './lib/event-manager'\r\nimport type {\r\n  NotifyData,\r\n  PageData,\r\n  CommentData,\r\n  DataManagerApi,\r\n  ListFetchParams,\r\n  ListLastFetchData,\r\n  EventPayloadMap,\r\n} from '@/types'\r\n\r\nexport class DataManager implements DataManagerApi {\r\n  private loading: boolean = false\r\n  private listLastFetch?: ListLastFetchData\r\n  private comments: CommentData[] = [] // Note: 无层级结构 + 无须排列\r\n  private notifies: NotifyData[] = []\r\n  private page?: PageData\r\n\r\n  constructor(protected events: EventManager<EventPayloadMap>) {}\r\n\r\n  getLoading() {\r\n    return this.loading\r\n  }\r\n\r\n  setLoading(val: boolean) {\r\n    this.loading = val\r\n  }\r\n\r\n  getListLastFetch() {\r\n    return this.listLastFetch\r\n  }\r\n\r\n  setListLastFetch(val: ListLastFetchData) {\r\n    this.listLastFetch = val\r\n  }\r\n\r\n  // -------------------------------------------------------------------\r\n  //  Comments\r\n  // -------------------------------------------------------------------\r\n  getComments() {\r\n    return this.comments\r\n  }\r\n\r\n  fetchComments(params: Partial<ListFetchParams>) {\r\n    this.events.trigger('list-fetch', params)\r\n  }\r\n\r\n  findComment(id: number) {\r\n    return this.comments.find((c) => c.id === id)\r\n  }\r\n\r\n  clearComments() {\r\n    this.comments = []\r\n    this.events.trigger('list-loaded', this.comments)\r\n  }\r\n\r\n  loadComments(partialComments: CommentData[]) {\r\n    this.events.trigger('list-load', partialComments)\r\n\r\n    this.comments.push(...partialComments)\r\n\r\n    this.events.trigger('list-loaded', this.comments)\r\n  }\r\n\r\n  insertComment(comment: CommentData) {\r\n    this.comments.push(comment)\r\n\r\n    this.events.trigger('comment-inserted', comment)\r\n    this.events.trigger('list-loaded', this.comments) // list-loaded should always keep the last\r\n  }\r\n\r\n  updateComment(comment: CommentData) {\r\n    this.comments = this.comments.map((c) => {\r\n      if (c.id === comment.id) return comment\r\n      return c\r\n    })\r\n\r\n    this.events.trigger('comment-updated', comment)\r\n    this.events.trigger('list-loaded', this.comments)\r\n  }\r\n\r\n  deleteComment(id: number) {\r\n    const comment = this.comments.find((c) => c.id === id)\r\n    if (!comment) throw new Error(`Comment ${id} not found`)\r\n    this.comments = this.comments.filter((c) => c.id !== id)\r\n\r\n    this.events.trigger('comment-deleted', comment)\r\n    this.events.trigger('list-loaded', this.comments)\r\n  }\r\n\r\n  // -------------------------------------------------------------------\r\n  //  Notifies\r\n  // -------------------------------------------------------------------\r\n  getNotifies() {\r\n    return this.notifies\r\n  }\r\n\r\n  updateNotifies(notifies: NotifyData[]) {\r\n    this.notifies = notifies\r\n\r\n    this.events.trigger('notifies-updated', this.notifies)\r\n  }\r\n\r\n  // -------------------------------------------------------------------\r\n  // Page\r\n  // -------------------------------------------------------------------\r\n  getPage() {\r\n    return this.page\r\n  }\r\n\r\n  updatePage(pageData: PageData) {\r\n    this.page = pageData\r\n\r\n    this.events.trigger('page-loaded', pageData)\r\n  }\r\n}\r\n","export function createElement<E extends HTMLElement = HTMLElement>(htmlStr: string = ''): E {\r\n  const div = document.createElement('div')\r\n  div.innerHTML = htmlStr.trim()\r\n  return (div.firstElementChild || div) as E\r\n}\r\n\r\nexport function getHeight(el: HTMLElement): number {\r\n  const num = parseFloat(getComputedStyle(el, null).height.replace('px', ''))\r\n  return num || 0 // NaN -> 0\r\n}\r\n\r\nexport function htmlEncode(str: string) {\r\n  const temp = document.createElement('div')\r\n  temp.innerText = str\r\n  const output = temp.innerHTML\r\n  return output\r\n}\r\n\r\nexport function htmlDecode(str: string) {\r\n  const temp = document.createElement('div')\r\n  temp.innerHTML = str\r\n  const output = temp.innerText\r\n  return output\r\n}\r\n\r\nexport function getQueryParam(name: string) {\r\n  const match = RegExp(`[?&]${name}=([^&]*)`).exec(window.location.search)\r\n  return match && decodeURIComponent(match[1].replace(/\\+/g, ' '))\r\n}\r\n\r\nexport function getOffset(el: HTMLElement, relativeTo?: HTMLElement) {\r\n  const getOffsetRecursive = (element: HTMLElement): { top: number; left: number } => {\r\n    const rect = element.getBoundingClientRect()\r\n    const scrollLeft = window.pageXOffset || document.documentElement.scrollLeft\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop\r\n    return {\r\n      top: rect.top + scrollTop,\r\n      left: rect.left + scrollLeft,\r\n    }\r\n  }\r\n\r\n  const elOffset = getOffsetRecursive(el)\r\n  if (!relativeTo) return elOffset\r\n\r\n  const relativeToOffset = getOffsetRecursive(relativeTo)\r\n\r\n  return {\r\n    top: elOffset.top - relativeToOffset.top,\r\n    left: elOffset.left - relativeToOffset.left,\r\n  }\r\n}\r\n\r\nexport function padWithZeros(vNumber: number, width: number) {\r\n  let numAsString = vNumber.toString()\r\n  while (numAsString.length < width) {\r\n    numAsString = `0${numAsString}`\r\n  }\r\n  return numAsString\r\n}\r\n\r\nexport function dateFormat(date: Date) {\r\n  const vDay = padWithZeros(date.getDate(), 2)\r\n  const vMonth = padWithZeros(date.getMonth() + 1, 2)\r\n  const vYear = padWithZeros(date.getFullYear(), 2)\r\n  // var vHour = padWithZeros(date.getHours(), 2);\r\n  // var vMinute = padWithZeros(date.getMinutes(), 2);\r\n  // var vSecond = padWithZeros(date.getSeconds(), 2);\r\n  return `${vYear}-${vMonth}-${vDay}`\r\n}\r\n\r\nexport function timeAgo(date: Date, $t = (n: any) => n) {\r\n  try {\r\n    const oldTime = date.getTime()\r\n    const currTime = new Date().getTime()\r\n    const diffValue = currTime - oldTime\r\n\r\n    const days = Math.floor(diffValue / (24 * 3600 * 1000))\r\n    if (days === 0) {\r\n      // 计算相差小时数\r\n      const leave1 = diffValue % (24 * 3600 * 1000) // 计算天数后剩余的毫秒数\r\n      const hours = Math.floor(leave1 / (3600 * 1000))\r\n      if (hours === 0) {\r\n        // 计算相差分钟数\r\n        const leave2 = leave1 % (3600 * 1000) // 计算小时数后剩余的毫秒数\r\n        const minutes = Math.floor(leave2 / (60 * 1000))\r\n        if (minutes === 0) {\r\n          // 计算相差秒数\r\n          const leave3 = leave2 % (60 * 1000) // 计算分钟数后剩余的毫秒数\r\n          const seconds = Math.round(leave3 / 1000)\r\n          if (seconds < 10) return $t('now')\r\n          return `${seconds} ${$t('seconds')}`\r\n        }\r\n        return `${minutes} ${$t('minutes')}`\r\n      }\r\n      return `${hours} ${$t('hours')}`\r\n    }\r\n    if (days < 0) return $t('now')\r\n\r\n    if (days < 8) {\r\n      return `${days} ${$t('days')}`\r\n    }\r\n\r\n    return dateFormat(date)\r\n  } catch (error) {\r\n    console.error(error)\r\n    return ' - '\r\n  }\r\n}\r\n\r\nexport function getGravatarURL(opts: { params: string; mirror: string; emailHash: string }) {\r\n  return `${opts.mirror.replace(/\\/$/, '')}/${opts.emailHash}?${opts.params.replace(/^\\?/, '')}`\r\n}\r\n\r\nexport function sleep(ms: number) {\r\n  return new Promise((resolve) => {\r\n    setTimeout(resolve, ms)\r\n  })\r\n}\r\n\r\n/** 版本号比较（a < b :-1 | 0 | b < a :1） */\r\nexport function versionCompare(a: string, b: string) {\r\n  const pa = a.split('.')\r\n  const pb = b.split('.')\r\n  for (let i = 0; i < 3; i++) {\r\n    const na = Number(pa[i])\r\n    const nb = Number(pb[i])\r\n    if (na > nb) return 1\r\n    if (nb > na) return -1\r\n    if (!Number.isNaN(na) && Number.isNaN(nb)) return 1\r\n    if (Number.isNaN(na) && !Number.isNaN(nb)) return -1\r\n  }\r\n  return 0\r\n}\r\n\r\n/** 获取修正后的 UserAgent */\r\nexport async function getCorrectUserAgent() {\r\n  const uaRaw = navigator.userAgent\r\n  if (!(navigator as any).userAgentData || !(navigator as any).userAgentData.getHighEntropyValues) {\r\n    return uaRaw\r\n  }\r\n\r\n  // @link https://web.dev/migrate-to-ua-ch/\r\n  // @link https://web.dev/user-agent-client-hints/\r\n  const uaData = (navigator as any).userAgentData\r\n  let uaGot: any = null\r\n  try {\r\n    uaGot = await uaData.getHighEntropyValues(['platformVersion'])\r\n  } catch (err) {\r\n    console.error(err)\r\n    return uaRaw\r\n  }\r\n  const majorPlatformVersion = Number(uaGot.platformVersion.split('.')[0])\r\n\r\n  if (uaData.platform === 'Windows') {\r\n    if (majorPlatformVersion >= 13) {\r\n      // @link https://docs.microsoft.com/en-us/microsoft-edge/web-platform/how-to-detect-win11\r\n      // @date 2022-4-29\r\n      // Win 11 样本：\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36\"\r\n      return uaRaw.replace(/Windows NT 10.0/, 'Windows NT 11.0')\r\n    }\r\n  }\r\n  if (uaData.platform === 'macOS') {\r\n    if (majorPlatformVersion >= 11) {\r\n      // 11 => BigSur\r\n      // @date 2022-4-29\r\n      // (Intel Chip) macOS 12.3 样本：\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/100.0.4896.127 Safari/537.36\"\r\n      // (Arm Chip) macOS 样本：\"Mozilla/5.0 (Macintosh; ARM Mac OS X 10_15_6) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.0.2 Safari/605.1.15\"\r\n      return uaRaw.replace(\r\n        /(Mac OS X \\d+_\\d+_\\d+|Mac OS X)/,\r\n        `Mac OS X ${uaGot.platformVersion.replace(/\\./g, '_')}`,\r\n      )\r\n    }\r\n  }\r\n\r\n  return uaRaw\r\n}\r\n\r\n/** 是否为完整的 URL */\r\nexport function isValidURL(urlRaw: string) {\r\n  // @link https://www.rfc-editor.org/rfc/rfc3986\r\n  let url: URL\r\n  try {\r\n    url = new URL(urlRaw)\r\n  } catch (_) {\r\n    return false\r\n  }\r\n  return url.protocol === 'http:' || url.protocol === 'https:'\r\n}\r\n\r\n/** 获取基于 conf.server 的 URL */\r\nexport function getURLBasedOnApi(opts: { base: string; path: string }) {\r\n  return getURLBasedOn(opts.base, opts.path)\r\n}\r\n\r\n/** 获取基于某个 baseURL 的 URL */\r\nexport function getURLBasedOn(baseURL: string, path: string) {\r\n  return `${baseURL.replace(/\\/$/, '')}/${path.replace(/^\\//, '')}`\r\n}\r\n","const en = {\r\n  /* Editor */\r\n  placeholder: 'Leave a comment',\r\n  noComment: 'No Comment',\r\n  send: 'Send',\r\n  signIn: 'Sign in',\r\n  signUp: 'Sign up',\r\n  save: 'Save',\r\n  nick: 'Nickname',\r\n  email: 'Email',\r\n  link: 'Website',\r\n  emoticon: 'Emoji',\r\n  preview: 'Preview',\r\n  uploadImage: 'Upload Image',\r\n  uploadFail: 'Upload Failed',\r\n  commentFail: 'Failed to comment',\r\n  restoredMsg: 'Content has been restored',\r\n  onlyAdminCanReply: 'Only admin can reply',\r\n  uploadLoginMsg: 'Please fill in your name and email to upload',\r\n\r\n  /* List */\r\n  counter: '{count} Comments',\r\n  sortLatest: 'Latest',\r\n  sortOldest: 'Oldest',\r\n  sortBest: 'Best',\r\n  sortAuthor: 'Author',\r\n  openComment: 'Open Comment',\r\n  closeComment: 'Close Comment',\r\n  listLoadFailMsg: 'Failed to load comments',\r\n  listRetry: 'Retry',\r\n  loadMore: 'Load More',\r\n\r\n  /* Comment */\r\n  admin: 'Admin',\r\n  reply: 'Reply',\r\n  voteUp: 'Up',\r\n  voteDown: 'Down',\r\n  voteFail: 'Vote Failed',\r\n  readMore: 'Read More',\r\n  actionConfirm: 'Confirm',\r\n  collapse: 'Collapse',\r\n  collapsed: 'Collapsed',\r\n  collapsedMsg: 'This comment has been collapsed',\r\n  expand: 'Expand',\r\n  approved: 'Approved',\r\n  pending: 'Pending',\r\n  pendingMsg: 'Pending, visible only to commenter.',\r\n  edit: 'Edit',\r\n  editCancel: 'Cancel Edit',\r\n  delete: 'Delete',\r\n  deleteConfirm: 'Confirm',\r\n  pin: 'Pin',\r\n  unpin: 'Unpin',\r\n\r\n  /* Time */\r\n  seconds: 'seconds ago',\r\n  minutes: 'minutes ago',\r\n  hours: 'hours ago',\r\n  days: 'days ago',\r\n  now: 'just now',\r\n\r\n  /* Checker */\r\n  adminCheck: 'Enter admin password:',\r\n  captchaCheck: 'Enter the CAPTCHA to continue:',\r\n  confirm: 'Confirm',\r\n  cancel: 'Cancel',\r\n\r\n  /* Sidebar */\r\n  msgCenter: 'Messages',\r\n  ctrlCenter: 'Admin',\r\n\r\n  /* Auth */\r\n  noAccountPrompt: \"Don't have an account?\",\r\n  haveAccountPrompt: 'Already have an account?',\r\n  forgetPassword: 'Forget Password',\r\n  resetPassword: 'Reset Password',\r\n  verificationCode: 'Verification Code',\r\n  verifySend: 'Verify',\r\n  verifyResend: 'Resend',\r\n  waitSeconds: 'Wait {seconds}s',\r\n  emailVerified: 'Email has been verified',\r\n  password: 'Password',\r\n  username: 'Username',\r\n  nextStep: 'Next Step',\r\n  skipNotVerify: 'Skip, do not verify',\r\n  logoutConfirm: 'Are you sure to logout?',\r\n  accountMergeNotice: 'Your email has multiple accounts with different id.',\r\n  accountMergeSelectOne: 'Please select one you want to merge all the data into it.',\r\n  accountMergeConfirm: 'All data will be merged into one account, the id is {id}.',\r\n  dismiss: 'Dismiss',\r\n  merge: 'Merge',\r\n\r\n  /* General */\r\n  frontend: 'Frontend',\r\n  backend: 'Backend',\r\n  loading: 'Loading',\r\n  loadFail: 'Load Failed',\r\n  editing: 'Editing',\r\n  editFail: 'Edit Failed',\r\n  deleting: 'Deleting',\r\n  deleteFail: 'Delete Failed',\r\n  reqGot: 'Request got',\r\n  reqAborted: 'Request timed out or terminated unexpectedly',\r\n  updateMsg: 'Please update Artalk {name} to get the best experience!',\r\n  currentVersion: 'Current Version',\r\n  ignore: 'Ignore',\r\n  open: 'Open',\r\n  openName: 'Open {name}',\r\n}\r\n\r\nexport type I18n = typeof en\r\nexport type I18nKeys = keyof I18n\r\n\r\nexport default en\r\n","import type { I18n } from '.'\r\n\r\nconst zhCN: I18n = {\r\n  /* Editor */\r\n  placeholder: '键入内容...',\r\n  noComment: '「此时无声胜有声」',\r\n  send: '发送',\r\n  signIn: '登录',\r\n  signUp: '注册',\r\n  save: '保存',\r\n  nick: '昵称',\r\n  email: '邮箱',\r\n  link: '网址',\r\n  emoticon: '表情',\r\n  preview: '预览',\r\n  uploadImage: '上传图片',\r\n  uploadFail: '上传失败',\r\n  commentFail: '评论失败',\r\n  restoredMsg: '内容已自动恢复',\r\n  onlyAdminCanReply: '仅管理员可评论',\r\n  uploadLoginMsg: '填入你的名字邮箱才能上传哦',\r\n\r\n  /* List */\r\n  counter: '{count} 条评论',\r\n  sortLatest: '最新',\r\n  sortOldest: '最早',\r\n  sortBest: '最热',\r\n  sortAuthor: '作者',\r\n  openComment: '打开评论',\r\n  closeComment: '关闭评论',\r\n  listLoadFailMsg: '无法获取评论列表数据',\r\n  listRetry: '点击重新获取',\r\n  loadMore: '加载更多',\r\n\r\n  /* Comment */\r\n  admin: '管理员',\r\n  reply: '回复',\r\n  voteUp: '赞同',\r\n  voteDown: '反对',\r\n  voteFail: '投票失败',\r\n  readMore: '阅读更多',\r\n  actionConfirm: '确认操作',\r\n  collapse: '折叠',\r\n  collapsed: '已折叠',\r\n  collapsedMsg: '该评论已被系统或管理员折叠',\r\n  expand: '展开',\r\n  approved: '已审',\r\n  pending: '待审',\r\n  pendingMsg: '审核中，仅本人可见。',\r\n  edit: '编辑',\r\n  editCancel: '取消编辑',\r\n  delete: '删除',\r\n  deleteConfirm: '确认删除',\r\n  pin: '置顶',\r\n  unpin: '取消置顶',\r\n\r\n  /* Time */\r\n  seconds: '秒前',\r\n  minutes: '分钟前',\r\n  hours: '小时前',\r\n  days: '天前',\r\n  now: '刚刚',\r\n\r\n  /* Checker */\r\n  adminCheck: '键入密码来验证管理员身份：',\r\n  captchaCheck: '键入验证码继续：',\r\n  confirm: '确认',\r\n  cancel: '取消',\r\n\r\n  /* Sidebar */\r\n  msgCenter: '通知中心',\r\n  ctrlCenter: '控制中心',\r\n\r\n  /* Auth */\r\n  noAccountPrompt: '没有账号？',\r\n  haveAccountPrompt: '已有账号？',\r\n  forgetPassword: '忘记密码',\r\n  resetPassword: '重置密码',\r\n  verificationCode: '验证码',\r\n  verifySend: '发送验证码',\r\n  verifyResend: '重新发送',\r\n  waitSeconds: '等待 {seconds}秒',\r\n  emailVerified: '邮箱已验证',\r\n  password: '密码',\r\n  username: '用户名',\r\n  nextStep: '下一步',\r\n  skipNotVerify: '跳过，不验证',\r\n  logoutConfirm: '确定要退出登录吗？',\r\n  accountMergeNotice: '您的电子邮件下有多个不同 ID 的账户。',\r\n  accountMergeSelectOne: '请选择将所有数据合并到其中的一个。',\r\n  accountMergeConfirm: '所有数据将合并到 ID 为 {id} 的账户中。',\r\n  dismiss: '忽略',\r\n  merge: '合并',\r\n\r\n  /* General */\r\n  frontend: '前端',\r\n  backend: '后端',\r\n  loading: '加载中',\r\n  loadFail: '加载失败',\r\n  editing: '修改中',\r\n  editFail: '修改失败',\r\n  deleting: '删除中',\r\n  deleteFail: '删除失败',\r\n  reqGot: '请求响应',\r\n  reqAborted: '请求超时或意外终止',\r\n  updateMsg: '请更新 Artalk {name} 以获得更好的体验！',\r\n  currentVersion: '当前版本',\r\n  ignore: '忽略',\r\n  open: '打开',\r\n  openName: '打开{name}',\r\n}\r\n\r\nexport default zhCN\r\n","import type { I18n } from '.'\r\n\r\nexport const GLOBAL_LOCALES_KEY = 'ArtalkI18n'\r\n\r\nexport function defineLocaleExternal(lang: string, locale: I18n, aliases?: string[]) {\r\n  if (!window[GLOBAL_LOCALES_KEY]) window[GLOBAL_LOCALES_KEY] = {}\r\n  window[GLOBAL_LOCALES_KEY][lang] = locale\r\n  if (aliases)\r\n    aliases.forEach((l) => {\r\n      window[GLOBAL_LOCALES_KEY][l] = locale\r\n    })\r\n  return locale\r\n}\r\n","import * as Utils from '../lib/utils'\r\nimport en, { I18n, I18nKeys } from './en'\r\nimport zhCN from './zh-CN'\r\nimport { GLOBAL_LOCALES_KEY } from './external'\r\n\r\nexport type * from './en'\r\n\r\n// @note the key of language is followed by `ISO 639`\r\n// https://en.wikipedia.org/wiki/ISO_639\r\n// https://datatracker.ietf.org/doc/html/rfc5646#section-2.1\r\nexport const internal = {\r\n  en,\r\n  'en-US': en,\r\n  'zh-CN': zhCN,\r\n}\r\n\r\n/**\r\n * find a locale object by language name\r\n */\r\nexport function findLocaleSet(lang: string): I18n {\r\n  // normalize a key of language to `ISO 639`\r\n  lang = lang.replace(\r\n    /^([a-zA-Z]+)(-[a-zA-Z]+)?$/,\r\n    (_, p1: string, p2: string) => p1.toLowerCase() + (p2 || '').toUpperCase(),\r\n  )\r\n\r\n  // internal finding\r\n  if (internal[lang]) {\r\n    return internal[lang]\r\n  }\r\n\r\n  // external finding\r\n  if (window[GLOBAL_LOCALES_KEY] && window[GLOBAL_LOCALES_KEY][lang]) {\r\n    return window[GLOBAL_LOCALES_KEY][lang]\r\n  }\r\n\r\n  // case when not found:\r\n  // use `en` by default\r\n  return internal.en\r\n}\r\n\r\n/**\r\n * System locale setting\r\n */\r\nlet LocaleConf: I18n | string = 'en'\r\nlet LocaleDict: I18n = findLocaleSet(LocaleConf) // en by default\r\n\r\n/**\r\n * Set system locale\r\n */\r\nexport function setLocale(locale: I18n | string) {\r\n  if (locale === LocaleConf) return\r\n  LocaleConf = locale\r\n  LocaleDict = typeof locale === 'string' ? findLocaleSet(locale) : locale\r\n}\r\n\r\n/**\r\n * Get an i18n message by key\r\n */\r\nexport function t(key: I18nKeys, args: { [key: string]: string } = {}) {\r\n  let str = LocaleDict?.[key] || key\r\n  str = str.replace(/\\{\\s*(\\w+?)\\s*\\}/g, (_, token) => args[token] || '')\r\n\r\n  return Utils.htmlEncode(str)\r\n}\r\n\r\nexport default t\r\n","export type EventHandler<T> = (payload: T) => void\r\nexport interface Event<PayloadMap, K extends keyof PayloadMap = keyof PayloadMap>\r\n  extends EventOptions {\r\n  name: K\r\n  handler: EventHandler<PayloadMap[K]>\r\n}\r\nexport interface EventOptions {\r\n  once?: boolean\r\n}\r\n\r\nexport interface EventManagerFuncs<PayloadMap> {\r\n  on<K extends keyof PayloadMap>(\r\n    name: K,\r\n    handler: EventHandler<PayloadMap[K]>,\r\n    opts?: EventOptions,\r\n  ): void\r\n  off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>): void\r\n  trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]): void\r\n}\r\n\r\nexport default class EventManager<PayloadMap> implements EventManagerFuncs<PayloadMap> {\r\n  private events: Event<PayloadMap>[] = []\r\n\r\n  /**\r\n   * Add an event listener for a specific event name\r\n   */\r\n  public on<K extends keyof PayloadMap>(\r\n    name: K,\r\n    handler: EventHandler<PayloadMap[K]>,\r\n    opts: EventOptions = {},\r\n  ) {\r\n    this.events.push({\r\n      name,\r\n      handler: handler as EventHandler<PayloadMap[keyof PayloadMap]>,\r\n      ...opts,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Remove an event listener for a specific event name and handler\r\n   */\r\n  public off<K extends keyof PayloadMap>(name: K, handler: EventHandler<PayloadMap[K]>) {\r\n    if (!handler) return // not allow remove all events with same name\r\n    this.events = this.events.filter((evt) => !(evt.name === name && evt.handler === handler))\r\n  }\r\n\r\n  /**\r\n   * Trigger an event with an optional payload\r\n   */\r\n  public trigger<K extends keyof PayloadMap>(name: K, payload?: PayloadMap[K]) {\r\n    this.events\r\n      .slice(0) // make a copy, in case listeners are removed while iterating\r\n      .filter((evt) => evt.name === name && typeof evt.handler === 'function')\r\n      .forEach((evt) => {\r\n        if (evt.once) this.off(name, evt.handler)\r\n        evt.handler(payload!)\r\n      })\r\n  }\r\n}\r\n","import type { ArtalkConfig } from '@/types'\r\n\r\nconst defaults: ArtalkConfig = {\r\n  el: '',\r\n  pageKey: '',\r\n  pageTitle: '',\r\n  server: '',\r\n  site: '',\r\n\r\n  placeholder: '',\r\n  noComment: '',\r\n  sendBtn: '',\r\n  darkMode: false,\r\n  editorTravel: true,\r\n\r\n  flatMode: 'auto',\r\n  nestMax: 2,\r\n  nestSort: 'DATE_ASC',\r\n\r\n  emoticons: 'https://cdn.jsdelivr.net/gh/ArtalkJS/Emoticons/grps/default.json',\r\n\r\n  vote: true,\r\n  voteDown: false,\r\n  uaBadge: true,\r\n  listSort: true,\r\n  preview: true,\r\n  countEl: '.artalk-comment-count',\r\n  pvEl: '.artalk-pv-count',\r\n  statPageKeyAttr: 'data-page-key',\r\n\r\n  gravatar: {\r\n    mirror: 'https://www.gravatar.com/avatar/',\r\n    params: 'sha256=1&d=mp&s=240',\r\n  },\r\n\r\n  pagination: {\r\n    pageSize: 20,\r\n    readMore: true,\r\n    autoLoad: true,\r\n  },\r\n\r\n  heightLimit: {\r\n    content: 300,\r\n    children: 400,\r\n    scrollable: false,\r\n  },\r\n\r\n  imgUpload: true,\r\n  reqTimeout: 15000,\r\n  versionCheck: true,\r\n  useBackendConf: true,\r\n\r\n  locale: 'en',\r\n}\r\n\r\nif (ARTALK_LITE) {\r\n  defaults.vote = false\r\n  defaults.uaBadge = false\r\n  defaults.emoticons = false\r\n  defaults.preview = false\r\n}\r\n\r\nexport default defaults\r\n","import type { ApiOptions } from './api/options'\r\nimport { mergeDeep } from './lib/merge-deep'\r\nimport { createApiHandlers } from './api'\r\nimport Defaults from './defaults'\r\nimport type { ArtalkConfig, ContextApi } from '@/types'\r\n\r\n/**\r\n * Handle the custom config which is provided by the user\r\n *\r\n * @param customConf - The custom config object which is provided by the user\r\n * @param full - If `full` is `true`, the return value will be the complete config for Artalk instance creation\r\n * @returns The config for Artalk instance creation\r\n */\r\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full: true): ArtalkConfig\r\nexport function handelCustomConf(\r\n  customConf: Partial<ArtalkConfig>,\r\n  full?: false,\r\n): Partial<ArtalkConfig>\r\nexport function handelCustomConf(customConf: Partial<ArtalkConfig>, full = false) {\r\n  // 合并默认配置\r\n  const conf: Partial<ArtalkConfig> = full ? mergeDeep(Defaults, customConf) : customConf\r\n\r\n  // 绑定元素\r\n  if (conf.el && typeof conf.el === 'string') {\r\n    try {\r\n      const findEl = document.querySelector<HTMLElement>(conf.el)\r\n      if (!findEl) throw Error(`Target element \"${conf.el}\" was not found.`)\r\n      conf.el = findEl\r\n    } catch (e) {\r\n      console.error(e)\r\n      throw new Error('Please check your Artalk `el` config.')\r\n    }\r\n  }\r\n\r\n  // 默认 pageKey\r\n  if (conf.pageKey === '') conf.pageKey = `${window.location.pathname}` // @link http://bl.ocks.org/abernier/3070589\r\n\r\n  // 默认 pageTitle\r\n  if (conf.pageTitle === '') conf.pageTitle = `${document.title}`\r\n\r\n  // 服务器配置\r\n  if (conf.server) conf.server = conf.server.replace(/\\/$/, '').replace(/\\/api\\/?$/, '')\r\n\r\n  // 自适应语言\r\n  if (conf.locale === 'auto') conf.locale = navigator.language\r\n\r\n  // 自动判断启用平铺模式\r\n  if (conf.flatMode === 'auto') conf.flatMode = window.matchMedia('(max-width: 768px)').matches\r\n\r\n  // flatMode\r\n  if (typeof conf.nestMax === 'number' && Number(conf.nestMax) <= 1) conf.flatMode = true\r\n\r\n  return conf\r\n}\r\n\r\n/**\r\n * Handle the config which is provided by the server\r\n *\r\n * @param conf - The Server response config for control the frontend of Artalk remotely\r\n * @returns The config for Artalk instance creation\r\n */\r\nexport function handleConfFormServer(conf: Partial<ArtalkConfig>) {\r\n  const ExcludedKeys: (keyof ArtalkConfig)[] = [\r\n    'el',\r\n    'pageKey',\r\n    'pageTitle',\r\n    'server',\r\n    'site',\r\n    'pvEl',\r\n    'countEl',\r\n    'statPageKeyAttr',\r\n  ]\r\n  Object.keys(conf).forEach((k) => {\r\n    if (ExcludedKeys.includes(k as any)) delete conf[k]\r\n    if (k === 'darkMode' && conf[k] !== 'auto') delete conf[k]\r\n  })\r\n\r\n  // Patch: `emoticons` config string to json\r\n  if (conf.emoticons && typeof conf.emoticons === 'string') {\r\n    conf.emoticons = conf.emoticons.trim()\r\n    if (conf.emoticons.startsWith('[') || conf.emoticons.startsWith('{')) {\r\n      conf.emoticons = JSON.parse(conf.emoticons) // parse json\r\n    } else if (conf.emoticons === 'false') {\r\n      conf.emoticons = false\r\n    }\r\n  }\r\n\r\n  return conf\r\n}\r\n\r\n/**\r\n * Convert Artalk Config to ApiOptions for Api client\r\n *\r\n * @param conf - Artalk config\r\n * @param ctx - If `ctx` not provided, `checkAdmin` and `checkCaptcha` will be disabled\r\n * @returns ApiOptions for Api client instance creation\r\n */\r\nexport function convertApiOptions(conf: Partial<ArtalkConfig>, ctx?: ContextApi): ApiOptions {\r\n  return {\r\n    baseURL: `${conf.server}/api/v2`,\r\n    siteName: conf.site || '',\r\n    pageKey: conf.pageKey || '',\r\n    pageTitle: conf.pageTitle || '',\r\n    timeout: conf.reqTimeout,\r\n    getApiToken: () => ctx?.get('user').getData().token,\r\n    userInfo: ctx?.get('user').checkHasBasicUserInfo()\r\n      ? {\r\n          name: ctx?.get('user').getData().nick,\r\n          email: ctx?.get('user').getData().email,\r\n        }\r\n      : undefined,\r\n    handlers: ctx?.getApiHandlers(),\r\n  }\r\n}\r\n\r\nexport function createNewApiHandlers(ctx: ContextApi) {\r\n  const h = createApiHandlers()\r\n  h.add('need_captcha', (res) => ctx.checkCaptcha(res))\r\n  h.add('need_login', () => ctx.checkAdmin({}))\r\n\r\n  return h\r\n}\r\n","import type { ArtalkConfig, ContextApi } from '@/types'\r\n\r\nexport function watchConf<T extends (keyof ArtalkConfig)[]>(\r\n  ctx: ContextApi,\r\n  keys: T,\r\n  effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\r\n): void {\r\n  const deepEqual = (a: any, b: any) => JSON.stringify(a) === JSON.stringify(b)\r\n  const val = () => {\r\n    const conf = ctx.getConf()\r\n    const res: any = {}\r\n    keys.forEach((key) => {\r\n      res[key] = conf[key]\r\n    })\r\n    return res\r\n  }\r\n  let lastVal: any = null\r\n  const handler = () => {\r\n    const newVal = val()\r\n    const isDiff = lastVal == null || !deepEqual(lastVal, newVal)\r\n    // only trigger when specific keys changed\r\n    if (isDiff) {\r\n      lastVal = newVal\r\n      effect(newVal)\r\n    }\r\n  }\r\n  ctx.on('mounted', handler)\r\n  ctx.on('updated', handler)\r\n}\r\n","import type { TInjectedServices } from './service'\r\nimport { Api, ApiHandlers } from './api'\r\n\r\nimport * as marked from './lib/marked'\r\nimport { mergeDeep } from './lib/merge-deep'\r\nimport { CheckerCaptchaPayload, CheckerPayload } from './components/checker'\r\n\r\nimport { DataManager } from './data'\r\nimport * as I18n from './i18n'\r\n\r\nimport EventManager from './lib/event-manager'\r\nimport { convertApiOptions, createNewApiHandlers, handelCustomConf } from './config'\r\nimport { watchConf } from './lib/watch-conf'\r\n\r\nimport type {\r\n  ArtalkConfig,\r\n  CommentData,\r\n  ListFetchParams,\r\n  ContextApi,\r\n  EventPayloadMap,\r\n  SidebarShowPayload,\r\n} from '@/types'\r\n\r\n// Auto dependency injection\r\ninterface Context extends TInjectedServices {}\r\n\r\n/**\r\n * Artalk Context\r\n */\r\nclass Context implements ContextApi {\r\n  /* 运行参数 */\r\n  conf: ArtalkConfig\r\n  data: DataManager\r\n  $root: HTMLElement\r\n\r\n  /* Event Manager */\r\n  private events = new EventManager<EventPayloadMap>()\r\n  private mounted = false\r\n\r\n  constructor(conf: ArtalkConfig) {\r\n    this.conf = conf\r\n\r\n    this.$root = conf.el as HTMLElement\r\n    this.$root.classList.add('artalk')\r\n    this.$root.innerHTML = ''\r\n\r\n    this.data = new DataManager(this.events)\r\n\r\n    this.on('mounted', () => {\r\n      this.mounted = true\r\n    })\r\n  }\r\n\r\n  inject(depName: string, obj: any) {\r\n    this[depName] = obj\r\n  }\r\n\r\n  get(depName: string) {\r\n    return this[depName]\r\n  }\r\n\r\n  getApi() {\r\n    return new Api(convertApiOptions(this.conf, this))\r\n  }\r\n\r\n  private apiHandlers = <ApiHandlers | null>null\r\n  getApiHandlers() {\r\n    if (!this.apiHandlers) this.apiHandlers = createNewApiHandlers(this)\r\n    return this.apiHandlers\r\n  }\r\n\r\n  getData() {\r\n    return this.data\r\n  }\r\n\r\n  replyComment(commentData: CommentData, $comment: HTMLElement): void {\r\n    this.editor.setReply(commentData, $comment)\r\n  }\r\n\r\n  editComment(commentData: CommentData, $comment: HTMLElement): void {\r\n    this.editor.setEditComment(commentData, $comment)\r\n  }\r\n\r\n  fetch(params: Partial<ListFetchParams>): void {\r\n    this.data.fetchComments(params)\r\n  }\r\n\r\n  reload(): void {\r\n    this.data.fetchComments({ offset: 0 })\r\n  }\r\n\r\n  /* List */\r\n  listGotoFirst(): void {\r\n    this.events.trigger('list-goto-first')\r\n  }\r\n\r\n  getCommentNodes() {\r\n    return this.list.getCommentNodes()\r\n  }\r\n\r\n  getComments() {\r\n    return this.data.getComments()\r\n  }\r\n\r\n  getCommentList = this.getCommentNodes\r\n  getCommentDataList = this.getComments\r\n\r\n  /* Editor */\r\n  editorShowLoading(): void {\r\n    this.editor.showLoading()\r\n  }\r\n\r\n  editorHideLoading(): void {\r\n    this.editor.hideLoading()\r\n  }\r\n\r\n  editorShowNotify(msg, type): void {\r\n    this.editor.showNotify(msg, type)\r\n  }\r\n\r\n  editorResetState(): void {\r\n    this.editor.resetState()\r\n  }\r\n\r\n  /* Sidebar */\r\n  showSidebar(payload?: SidebarShowPayload): void {\r\n    this.sidebarLayer.show(payload)\r\n  }\r\n\r\n  hideSidebar(): void {\r\n    this.sidebarLayer.hide()\r\n  }\r\n\r\n  /* Checker */\r\n  checkAdmin(payload: CheckerPayload): Promise<void> {\r\n    return this.checkerLauncher.checkAdmin(payload)\r\n  }\r\n\r\n  checkCaptcha(payload: CheckerCaptchaPayload): Promise<void> {\r\n    return this.checkerLauncher.checkCaptcha(payload)\r\n  }\r\n\r\n  /* Events */\r\n  on(name: any, handler: any) {\r\n    this.events.on(name, handler)\r\n  }\r\n\r\n  off(name: any, handler: any) {\r\n    this.events.off(name, handler)\r\n  }\r\n\r\n  trigger(name: any, payload?: any) {\r\n    this.events.trigger(name, payload)\r\n  }\r\n\r\n  /* i18n */\r\n  $t(key: I18n.I18nKeys, args: { [key: string]: string } = {}): string {\r\n    return I18n.t(key, args)\r\n  }\r\n\r\n  setDarkMode(darkMode: boolean | 'auto'): void {\r\n    this.updateConf({ darkMode })\r\n  }\r\n\r\n  updateConf(nConf: Partial<ArtalkConfig>): void {\r\n    this.conf = mergeDeep(this.conf, handelCustomConf(nConf, false))\r\n    this.mounted && this.events.trigger('updated', this.conf)\r\n  }\r\n\r\n  getConf(): ArtalkConfig {\r\n    return this.conf\r\n  }\r\n\r\n  getEl(): HTMLElement {\r\n    return this.$root\r\n  }\r\n\r\n  getMarked() {\r\n    return marked.getInstance()\r\n  }\r\n\r\n  watchConf<T extends (keyof ArtalkConfig)[]>(\r\n    keys: T,\r\n    effect: (conf: Pick<ArtalkConfig, T[number]>) => void,\r\n  ): void {\r\n    watchConf(this, keys, effect)\r\n  }\r\n}\r\n\r\nexport default Context\r\n","import * as Utils from './utils'\r\nimport type { NotifyLevel } from '@/types'\r\n\r\n/** 显示加载 */\r\nexport function showLoading(parentElem: HTMLElement, conf?: { transparentBg?: boolean }) {\r\n  // Use :scope https://developer.mozilla.org/en-US/docs/Web/CSS/:scope\r\n  let $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\r\n  if (!$loading) {\r\n    $loading = Utils.createElement(\r\n      `<div class=\"atk-loading\" style=\"display: none;\">\r\n      <div class=\"atk-loading-spinner\">\r\n        <svg viewBox=\"25 25 50 50\"><circle cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-width=\"2\" stroke-miterlimit=\"10\"></circle></svg>\r\n      </div>\r\n    </div>`,\r\n    )\r\n    if (conf?.transparentBg) $loading.style.background = 'transparent'\r\n    parentElem.appendChild($loading)\r\n  }\r\n  $loading.style.display = ''\r\n\r\n  // spinner 延迟显示，若加载等待时间太短，没必要显示（闪一下即可）\r\n  const $spinner = $loading.querySelector<HTMLElement>('.atk-loading-spinner')\r\n  if ($spinner) {\r\n    $spinner.style.display = 'none'\r\n    window.setTimeout(() => {\r\n      if ($spinner.isConnected) $spinner.style.display = ''\r\n    }, 500)\r\n  }\r\n}\r\n\r\n/** 隐藏加载 */\r\nexport function hideLoading(parentElem: HTMLElement) {\r\n  const $loading = parentElem.querySelector<HTMLElement>(':scope > .atk-loading')\r\n  if ($loading) $loading.style.display = 'none'\r\n}\r\n\r\n/** 元素加载动画 */\r\nexport function setLoading(val: boolean, parentElem: HTMLElement) {\r\n  if (val) showLoading(parentElem)\r\n  else hideLoading(parentElem)\r\n}\r\n\r\n/** 元素是否用户可见 */\r\nexport function isVisible(el: HTMLElement, viewport: HTMLElement = document.documentElement) {\r\n  const viewportHeight = viewport.clientHeight\r\n\r\n  const docViewTop = viewport.scrollTop\r\n  const docViewBottom = docViewTop + viewportHeight\r\n\r\n  const rect = el.getBoundingClientRect()\r\n  const elemTop = rect.top + docViewTop\r\n  const elemBottom = elemTop + rect.height\r\n\r\n  return elemBottom <= docViewBottom //&& (elemTop >= docViewTop) 注释因为假如 el 比 viewport 还高就会失效\r\n}\r\n\r\n/** 滚动到元素中心 */\r\nexport function scrollIntoView(\r\n  elem: HTMLElement,\r\n  enableAnim: boolean = true,\r\n  relativeTo?: HTMLElement,\r\n) {\r\n  let top: number\r\n\r\n  if (relativeTo) {\r\n    const containerRect = relativeTo.getBoundingClientRect()\r\n    const elementRect = elem.getBoundingClientRect()\r\n    top =\r\n      elementRect.top -\r\n      containerRect.top +\r\n      relativeTo.scrollTop -\r\n      relativeTo.clientHeight / 2 +\r\n      elem.clientHeight / 2\r\n  } else {\r\n    const rect = elem.getBoundingClientRect()\r\n    const elemTop = rect.top + window.scrollY\r\n    top = elemTop - (window.innerHeight / 2 - rect.height / 2)\r\n  }\r\n\r\n  const scrollOptions: ScrollToOptions = {\r\n    top,\r\n    left: 0,\r\n    // behavior: enableAnim ? 'smooth' : 'instant',\r\n    behavior: 'instant',\r\n  }\r\n\r\n  if (relativeTo) relativeTo.scroll(scrollOptions)\r\n  else window.scroll(scrollOptions)\r\n}\r\n\r\n/** 显示消息 */\r\nexport function showNotify(wrapElem: HTMLElement, msg: string, type: NotifyLevel) {\r\n  const colors = { s: '#57d59f', e: '#ff6f6c', w: '#ffc721', i: '#2ebcfc' }\r\n  const timeout = 3000 // 持续显示时间 ms\r\n\r\n  const notifyElem = Utils.createElement(\r\n    `<div class=\"atk-notify atk-fade-in\" style=\"background-color: ${colors[type]}\"><span class=\"atk-notify-content\"></span></div>`,\r\n  )\r\n  const notifyContentEl = notifyElem.querySelector<HTMLElement>('.atk-notify-content')!\r\n  notifyContentEl.innerHTML = Utils.htmlEncode(msg).replace('\\n', '<br/>')\r\n\r\n  wrapElem.appendChild(notifyElem)\r\n\r\n  const notifyRemove = () => {\r\n    notifyElem.classList.add('atk-fade-out')\r\n    setTimeout(() => {\r\n      notifyElem.remove()\r\n    }, 200)\r\n  }\r\n\r\n  let timeoutFn: number\r\n  if (timeout > 0) {\r\n    timeoutFn = window.setTimeout(() => {\r\n      notifyRemove()\r\n    }, timeout)\r\n  }\r\n\r\n  notifyElem.addEventListener('click', () => {\r\n    notifyRemove()\r\n    window.clearTimeout(timeoutFn)\r\n  })\r\n}\r\n\r\n/** fade 动画 */\r\nexport function playFadeAnim(elem: HTMLElement, after?: () => void, type: 'in' | 'out' = 'in') {\r\n  elem.classList.add(`atk-fade-${type}`)\r\n  // 动画结束清除 class\r\n  const onAnimEnded = () => {\r\n    elem.classList.remove(`atk-fade-${type}`)\r\n    elem.removeEventListener('animationend', onAnimEnded)\r\n    if (after) after()\r\n  }\r\n  elem.addEventListener('animationend', onAnimEnded)\r\n}\r\n\r\n/** 渐入动画 */\r\nexport function playFadeInAnim(elem: HTMLElement, after?: () => void) {\r\n  playFadeAnim(elem, after, 'in')\r\n}\r\n\r\n/** 渐出动画 */\r\nexport function playFadeOutAnim(elem: HTMLElement, after?: () => void) {\r\n  playFadeAnim(elem, after, 'out')\r\n}\r\n\r\n/** 设置全局错误 */\r\nexport function setError(\r\n  parentElem: HTMLElement,\r\n  html: string | HTMLElement | null,\r\n  title: string = '<span class=\"atk-error-title\">Artalk Error</span>',\r\n) {\r\n  let elem = parentElem.querySelector<HTMLElement>('.atk-error-layer')\r\n  if (html === null) {\r\n    if (elem !== null) elem.remove()\r\n    return\r\n  }\r\n  if (!elem) {\r\n    elem = Utils.createElement(\r\n      `<div class=\"atk-error-layer\">${title}<span class=\"atk-error-text\"></span></div>`,\r\n    )\r\n    parentElem.appendChild(elem)\r\n  }\r\n\r\n  const errorTextEl = elem.querySelector<HTMLElement>('.atk-error-text')!\r\n  errorTextEl.innerHTML = ''\r\n  if (html === null) return\r\n\r\n  if (html instanceof HTMLElement) {\r\n    errorTextEl.appendChild(html)\r\n  } else {\r\n    errorTextEl.innerText = html\r\n  }\r\n}\r\n\r\nexport function getScrollBarWidth() {\r\n  const inner = document.createElement('p')\r\n  inner.style.width = '100%'\r\n  inner.style.height = '200px'\r\n\r\n  const outer = document.createElement('div')\r\n  outer.style.position = 'absolute'\r\n  outer.style.top = '0px'\r\n  outer.style.left = '0px'\r\n  outer.style.visibility = 'hidden'\r\n  outer.style.width = '200px'\r\n  outer.style.height = '150px'\r\n  outer.style.overflow = 'hidden'\r\n  outer.appendChild(inner)\r\n\r\n  document.body.appendChild(outer)\r\n  const w1 = inner.offsetWidth\r\n  outer.style.overflow = 'scroll'\r\n  let w2 = inner.offsetWidth\r\n  if (w1 === w2) w2 = outer.clientWidth\r\n\r\n  document.body.removeChild(outer)\r\n\r\n  return w1 - w2\r\n}\r\n","import type { CheckerCtx } from '.'\r\nimport $t from '@/i18n'\r\nimport * as Utils from '@/lib/utils'\r\nimport * as Ui from '@/lib/ui'\r\n\r\n/** 图片验证码 */\r\nexport function imgBody(checker: CheckerCtx) {\r\n  // 图片验证方式\r\n  const elem = Utils.createElement(\r\n    `<span><img class=\"atk-captcha-img\" src=\"${checker.get('img_data') || ''}\">${$t('captchaCheck')}</span>`,\r\n  )\r\n\r\n  // 刷新验证码\r\n  elem.querySelector<HTMLElement>('.atk-captcha-img')!.onclick = () => {\r\n    const imgEl = elem.querySelector('.atk-captcha-img')\r\n    checker\r\n      .getApi()\r\n      .captcha.getCaptcha()\r\n      .then((res) => {\r\n        imgEl!.setAttribute('src', res.data.img_data)\r\n      })\r\n      .catch((err) => {\r\n        console.error('Failed to get captcha image ', err)\r\n      })\r\n  }\r\n  return elem\r\n}\r\n\r\n/** iframe 形式的通用验证服务 */\r\nexport function iframeBody(checker: CheckerCtx) {\r\n  const $iframeWrap = Utils.createElement(`<div class=\"atk-checker-iframe-wrap\"></div>`)\r\n  const $iframe = Utils.createElement<HTMLIFrameElement>(\r\n    `<iframe class=\"atk-fade-in\" referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>`,\r\n  )\r\n  $iframe.style.display = 'none'\r\n  Ui.showLoading($iframeWrap, { transparentBg: true })\r\n  $iframe.src = checker.getOpts().getCaptchaIframeURL()\r\n  $iframe.onload = () => {\r\n    $iframe.style.display = ''\r\n    Ui.hideLoading($iframeWrap)\r\n  }\r\n  $iframeWrap.append($iframe)\r\n\r\n  const $closeBtn = Utils.createElement(\r\n    `<div class=\"atk-close-btn\"><i class=\"atk-icon atk-icon-close\"></i></div>`,\r\n  )\r\n  $iframeWrap.append($closeBtn)\r\n\r\n  checker.hideInteractInput()\r\n\r\n  // 轮询状态\r\n  let stop = false // 打断\r\n  const sleep = (ms: number) =>\r\n    new Promise((resolve) => {\r\n      window.setTimeout(() => {\r\n        resolve(null)\r\n      }, ms)\r\n    })\r\n  ;(async function queryStatus() {\r\n    await sleep(1000)\r\n    if (stop) return\r\n    let isPass = false\r\n    try {\r\n      const resp = await checker.getApi().captcha.getCaptchaStatus()\r\n      isPass = resp.data.is_pass\r\n    } catch {\r\n      isPass = false\r\n    }\r\n    if (isPass) {\r\n      checker.triggerSuccess()\r\n    } else {\r\n      queryStatus()\r\n    }\r\n  })()\r\n\r\n  $closeBtn.onclick = () => {\r\n    stop = true\r\n    checker.cancel()\r\n  }\r\n\r\n  return $iframeWrap\r\n}\r\n","import * as render from './captcha-renders'\r\nimport type { Checker } from '.'\r\n\r\nconst CaptchaChecker: Checker = {\r\n  request(checker, inputVal) {\r\n    return checker.getApi().captcha.verifyCaptcha({\r\n      value: inputVal,\r\n    })\r\n  },\r\n\r\n  body(checker) {\r\n    if (checker.get('iframe')) return render.iframeBody(checker)\r\n    return render.imgBody(checker)\r\n  },\r\n\r\n  onSuccess(checker, data, inputVal, formEl) {\r\n    checker.set('val', inputVal)\r\n  },\r\n\r\n  onError(checker, err, inputVal, formEl) {\r\n    formEl.querySelector<HTMLElement>('.atk-captcha-img')!.click() // 刷新验证码\r\n    formEl.querySelector<HTMLInputElement>('input[type=\"text\"]')!.value = '' // 清空输入框输入\r\n  },\r\n}\r\n\r\nexport default CaptchaChecker\r\n","import type { Checker } from '.'\r\nimport $t from '@/i18n'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nconst AdminChecker: Checker<{ token: string }> = {\r\n  inputType: 'password',\r\n\r\n  async request(checker, inputVal) {\r\n    return (\r\n      await checker.getApi().user.login({\r\n        name: checker.getUser().getData().nick,\r\n        email: checker.getUser().getData().email,\r\n        password: inputVal,\r\n      })\r\n    ).data\r\n  },\r\n\r\n  body(checker) {\r\n    return Utils.createElement(`<span>${$t('adminCheck')}</span>`)\r\n  },\r\n\r\n  onSuccess(checker, res, inputVal, formEl) {\r\n    checker.getUser().update({\r\n      isAdmin: true,\r\n      token: res.token,\r\n    })\r\n    checker.getOpts().onReload()\r\n  },\r\n\r\n  onError(checker, err, inputVal, formEl) {},\r\n}\r\n\r\nexport default AdminChecker\r\n","import * as Utils from '../lib/utils'\r\nimport $t from '@/i18n'\r\n\r\ntype BtnClickHandler = (btnEl: HTMLElement, dialog: Dialog) => boolean | void\r\n\r\n/**\r\n * 对话框\r\n */\r\nexport default class Dialog {\r\n  public $el: HTMLElement\r\n  public $content: HTMLElement\r\n  public $actions: HTMLElement\r\n\r\n  constructor(contentEl: HTMLElement) {\r\n    this.$el = Utils.createElement(\r\n      `<div class=\"atk-layer-dialog-wrap\">\r\n        <div class=\"atk-layer-dialog\">\r\n          <div class=\"atk-layer-dialog-content\"></div>\r\n          <div class=\"atk-layer-dialog-actions\"></div>\r\n        </div>\r\n      </div>`,\r\n    )\r\n\r\n    // 按钮\r\n    this.$actions = this.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!\r\n\r\n    // 内容\r\n    this.$content = this.$el.querySelector('.atk-layer-dialog-content')!\r\n    this.$content.appendChild(contentEl)\r\n  }\r\n\r\n  /** 按钮 · 确定 */\r\n  public setYes(handler: BtnClickHandler) {\r\n    const btn = Utils.createElement<HTMLButtonElement>(\r\n      `<button data-action=\"confirm\">${$t('confirm')}</button>`,\r\n    )\r\n    btn.onclick = this.onBtnClick(handler)\r\n    this.$actions.appendChild(btn)\r\n\r\n    return this\r\n  }\r\n\r\n  /** 按钮 · 取消 */\r\n  public setNo(handler: BtnClickHandler) {\r\n    const btn = Utils.createElement<HTMLButtonElement>(\r\n      `<button data-action=\"cancel\">${$t('cancel')}</button>`,\r\n    )\r\n    btn.onclick = this.onBtnClick(handler)\r\n    this.$actions.appendChild(btn)\r\n\r\n    return this\r\n  }\r\n\r\n  private onBtnClick(handler: BtnClickHandler) {\r\n    return (evt: Event) => {\r\n      const re = handler(evt.currentTarget as HTMLElement, this)\r\n      if (re === undefined || re === true) {\r\n        this.$el.remove()\r\n      }\r\n    }\r\n  }\r\n}\r\n","import CaptchaChecker from './captcha'\r\nimport AdminChecker from './admin'\r\nimport type { Api } from '@/api'\r\nimport Dialog from '@/components/dialog'\r\nimport $t from '@/i18n'\r\nimport type { ContextApi } from '@/types'\r\nimport type User from '@/lib/user'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport interface CheckerCaptchaPayload extends CheckerPayload {\r\n  img_data?: string\r\n  iframe?: string\r\n}\r\n\r\nexport interface CheckerPayload {\r\n  onSuccess?: () => void\r\n  onMount?: (dialogEl: HTMLElement) => void\r\n  onCancel?: () => void\r\n}\r\n\r\nexport interface CheckerLauncherOptions {\r\n  getCtx: () => ContextApi\r\n  getApi: () => Api\r\n  getCaptchaIframeURL: () => string\r\n  onReload: () => void\r\n}\r\n\r\nfunction wrapPromise<P extends CheckerPayload = CheckerPayload>(fn: (p: P) => void) {\r\n  return (payload: P) =>\r\n    new Promise<void>((resolve, reject) => {\r\n      const cancelFn = payload.onCancel\r\n      payload.onCancel = () => {\r\n        cancelFn && cancelFn()\r\n        reject(new Error('user canceled the checker'))\r\n      }\r\n      const successFn = payload.onSuccess\r\n      payload.onSuccess = () => {\r\n        successFn && successFn()\r\n        resolve()\r\n      }\r\n      fn(payload)\r\n    })\r\n}\r\n\r\n/**\r\n * Checker 发射台\r\n */\r\nexport default class CheckerLauncher {\r\n  constructor(private opts: CheckerLauncherOptions) {}\r\n\r\n  public checkCaptcha: (payload: CheckerCaptchaPayload) => Promise<void> = wrapPromise((p) => {\r\n    this.fire(CaptchaChecker, p, (ctx) => {\r\n      ctx.set('img_data', p.img_data)\r\n      ctx.set('iframe', p.iframe)\r\n    })\r\n  })\r\n\r\n  public checkAdmin: (payload: CheckerPayload) => Promise<void> = wrapPromise((p) => {\r\n    this.fire(AdminChecker, p)\r\n  })\r\n\r\n  public fire(checker: Checker, payload: CheckerPayload, postFire?: (c: CheckerCtx) => void) {\r\n    // 显示层\r\n    const layer = this.opts.getCtx().get('layerManager').create(`checker-${new Date().getTime()}`)\r\n    layer.show()\r\n\r\n    const close = () => {\r\n      layer.destroy()\r\n    }\r\n\r\n    // 构建 Checker 的上下文\r\n    const checkerStore: CheckerStore = {}\r\n    let hideInteractInput = false\r\n    const checkerCtx: CheckerCtx = {\r\n      set: (key, val) => {\r\n        checkerStore[key] = val\r\n      },\r\n      get: (key) => checkerStore[key],\r\n      getOpts: () => this.opts,\r\n      getUser: () => this.opts.getCtx().get('user'),\r\n      getApi: () => this.opts.getApi(),\r\n      hideInteractInput: () => {\r\n        hideInteractInput = true\r\n      },\r\n      triggerSuccess: () => {\r\n        close()\r\n        if (checker.onSuccess) checker.onSuccess(checkerCtx, '', '', formEl)\r\n        if (payload.onSuccess) payload.onSuccess()\r\n      },\r\n      cancel: () => {\r\n        close()\r\n        if (payload.onCancel) payload.onCancel()\r\n      },\r\n    }\r\n\r\n    if (postFire) postFire(checkerCtx)\r\n\r\n    // 创建表单\r\n    const formEl = Utils.createElement()\r\n    formEl.appendChild(checker.body(checkerCtx))\r\n\r\n    // 输入框\r\n    const $input = Utils.createElement<HTMLInputElement>(\r\n      `<input id=\"check\" type=\"${checker.inputType || 'text'}\" autocomplete=\"off\" required placeholder=\"\">`,\r\n    )\r\n    formEl.appendChild($input)\r\n    setTimeout(() => $input.focus(), 80) // 延迟 Focus\r\n\r\n    // 绑定键盘事件\r\n    $input.onkeyup = (evt) => {\r\n      if (evt.key === 'Enter' || evt.keyCode === 13) {\r\n        // 按下回车键\r\n        evt.preventDefault()\r\n        layer.getEl().querySelector<HTMLButtonElement>('button[data-action=\"confirm\"]')!.click()\r\n      }\r\n    }\r\n\r\n    let btnTextOrg: string | undefined\r\n    const dialog = new Dialog(formEl)\r\n\r\n    // 确认按钮\r\n    dialog.setYes((btnEl) => {\r\n      const inputVal = $input.value.trim()\r\n\r\n      // 按钮操作\r\n      if (!btnTextOrg) btnTextOrg = btnEl.innerText\r\n      const btnTextSet = (btnText: string) => {\r\n        btnEl.innerText = btnText\r\n        btnEl.classList.add('error')\r\n      }\r\n      const btnTextRestore = () => {\r\n        btnEl.innerText = btnTextOrg || ''\r\n        btnEl.classList.remove('error')\r\n      }\r\n\r\n      btnEl.innerText = `${$t('loading')}...`\r\n\r\n      // 发送请求\r\n      checker\r\n        .request(checkerCtx, inputVal)\r\n        .then((data) => {\r\n          // 请求成功\r\n          close()\r\n\r\n          if (checker.onSuccess) checker.onSuccess(checkerCtx, data, inputVal, formEl)\r\n          if (payload.onSuccess) payload.onSuccess()\r\n        })\r\n        .catch((err) => {\r\n          // 请求失败\r\n          btnTextSet(String(err.message || String(err)))\r\n\r\n          if (checker.onError) checker.onError(checkerCtx, err, inputVal, formEl)\r\n\r\n          // 错误显示 3s 后恢复按钮\r\n          const tf = setTimeout(() => btnTextRestore(), 3000)\r\n          $input.onfocus = () => {\r\n            btnTextRestore()\r\n            clearTimeout(tf)\r\n          }\r\n        })\r\n\r\n      return false\r\n    })\r\n\r\n    // 取消按钮\r\n    dialog.setNo(() => {\r\n      close()\r\n      if (payload.onCancel) payload.onCancel()\r\n      return false\r\n    })\r\n\r\n    if (hideInteractInput) {\r\n      $input.style.display = 'none'\r\n      dialog.$el.querySelector<HTMLElement>('.atk-layer-dialog-actions')!.style.display = 'none'\r\n    }\r\n\r\n    // 层装载 dialog 元素\r\n    layer.getEl().append(dialog.$el)\r\n\r\n    // onMount 回调\r\n    if (payload.onMount) payload.onMount(dialog.$el)\r\n  }\r\n}\r\n\r\nexport interface Checker<T = any> {\r\n  el?: HTMLElement\r\n  inputType?: 'password' | 'text'\r\n  body: (checker: CheckerCtx) => HTMLElement\r\n  request: (checker: CheckerCtx, inputVal: string) => Promise<T>\r\n  onSuccess?: (checker: CheckerCtx, respData: T, inputVal: string, formEl: HTMLElement) => void\r\n  onError?: (checker: CheckerCtx, errData: any, inputVal: string, formEl: HTMLElement) => void\r\n}\r\n\r\ninterface CheckerStore {\r\n  val?: string\r\n  img_data?: string\r\n  iframe?: string\r\n}\r\n\r\nexport interface CheckerCtx {\r\n  get<K extends keyof CheckerStore>(key: K): CheckerStore[K]\r\n  set<K extends keyof CheckerStore>(key: K, val: CheckerStore[K]): void\r\n  getOpts(): CheckerLauncherOptions\r\n  getApi(): Api\r\n  getUser(): User\r\n  hideInteractInput(): void\r\n  triggerSuccess(): void\r\n  cancel(): void\r\n}\r\n","import type { ContextApi } from '@/types'\r\n\r\nexport default abstract class Component {\r\n  public $el!: HTMLElement\r\n  public get conf() {\r\n    return this.ctx.conf\r\n  }\r\n\r\n  public constructor(public ctx: ContextApi) {}\r\n\r\n  getEl() {\r\n    return this.$el\r\n  }\r\n}\r\n","export default \"<div class=\\\"atk-main-editor\\\">\\r\\n  <div class=\\\"atk-header\\\">\\r\\n    <input name=\\\"nick\\\" class=\\\"atk-nick\\\" type=\\\"text\\\" required=\\\"required\\\" />\\r\\n    <input name=\\\"email\\\" class=\\\"atk-email\\\" type=\\\"email\\\" required=\\\"required\\\" />\\r\\n  </div>\\r\\n  <div class=\\\"atk-textarea-wrap\\\">\\r\\n    <textarea class=\\\"atk-textarea\\\"></textarea>\\r\\n  </div>\\r\\n  <div class=\\\"atk-plug-panel-wrap\\\" style=\\\"display: none\\\"></div>\\r\\n  <div class=\\\"atk-bottom\\\">\\r\\n    <div class=\\\"atk-item atk-bottom-left\\\">\\r\\n      <span class=\\\"atk-state-wrap\\\"></span>\\r\\n      <span class=\\\"atk-plug-btn-wrap\\\"></span>\\r\\n    </div>\\r\\n    <div class=\\\"atk-item\\\">\\r\\n      <button type=\\\"button\\\" class=\\\"atk-send-btn\\\"></button>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"atk-notify-wrap\\\"></div>\\r\\n</div>\\r\\n\"","import * as Utils from '../lib/utils'\r\nimport EditorHTML from './editor.html?raw'\r\n\r\nconst Sel = {\r\n  $header: '.atk-header',\r\n  $nick: '.atk-header [name=\"nick\"]',\r\n  $email: '.atk-header [name=\"email\"]',\r\n  $link: '.atk-header [name=\"link\"]',\r\n  $textareaWrap: '.atk-textarea-wrap',\r\n  $textarea: '.atk-textarea',\r\n  $bottom: '.atk-bottom',\r\n  $submitBtn: '.atk-send-btn',\r\n  $notifyWrap: '.atk-notify-wrap',\r\n  $bottomLeft: '.atk-bottom-left',\r\n  $stateWrap: '.atk-state-wrap',\r\n  $plugBtnWrap: '.atk-plug-btn-wrap',\r\n  $plugPanelWrap: '.atk-plug-panel-wrap',\r\n}\r\n\r\nexport interface EditorUI extends Record<keyof typeof Sel, HTMLElement> {\r\n  $el: HTMLElement\r\n  $nick: HTMLInputElement\r\n  $email: HTMLInputElement\r\n  $link: HTMLInputElement\r\n  $textarea: HTMLTextAreaElement\r\n  $submitBtn: HTMLButtonElement\r\n  $sendReplyBtn?: HTMLElement\r\n  $editCancelBtn?: HTMLElement\r\n}\r\n\r\nexport function render() {\r\n  const $el = Utils.createElement(EditorHTML)\r\n  const ui = { $el }\r\n  Object.entries(Sel).forEach(([k, sel]) => {\r\n    ui[k] = $el.querySelector(sel)\r\n  })\r\n  return ui as EditorUI\r\n}\r\n","import type PlugKit from './_kit'\r\nimport type { CommentData, EditorState } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\n/**\r\n * Editor 插件\r\n */\r\ninterface EditorPlug {\r\n  $btn?: HTMLElement\r\n  $panel?: HTMLElement\r\n  contentTransformer?(rawContent: string): string\r\n  editorStateEffectWhen?: EditorState\r\n  editorStateEffect?(comment: CommentData): () => void\r\n}\r\n\r\nclass EditorPlug {\r\n  constructor(protected kit: PlugKit) {}\r\n\r\n  /** Use plug btn will add a btn on the bottom of editor */\r\n  useBtn(html: string = '<div></div>') {\r\n    this.$btn = Utils.createElement(`<span class=\"atk-plug-btn\">${html}</span>`)\r\n    return this.$btn\r\n  }\r\n\r\n  /** Use plug panel will show the panel when btn is clicked */\r\n  usePanel(html: string = '<div></div>') {\r\n    this.$panel = Utils.createElement(html)\r\n    return this.$panel\r\n  }\r\n\r\n  /** Use the content transformer to handle the content of the last submit by the editor */\r\n  useContentTransformer(func: (raw: string) => string) {\r\n    this.contentTransformer = func\r\n  }\r\n\r\n  /** Listen the event of panel show */\r\n  usePanelShow(func: () => void) {\r\n    this.kit.useEvents().on('panel-show', (aPlug) => {\r\n      if (aPlug === this) func()\r\n    })\r\n  }\r\n\r\n  /** Listen the event of panel hide */\r\n  usePanelHide(func: () => void) {\r\n    this.kit.useEvents().on('panel-hide', (aPlug) => {\r\n      if (aPlug === this) func()\r\n    })\r\n  }\r\n\r\n  /** Use editor state modifier */\r\n  useEditorStateEffect(stateName: EditorState, effectFn: (comment: CommentData) => () => void) {\r\n    this.editorStateEffectWhen = stateName\r\n    this.editorStateEffect = effectFn\r\n  }\r\n}\r\n\r\nexport default EditorPlug\r\n","import EditorPlug from './_plug'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport default class Mover extends EditorPlug {\r\n  private isMoved = false\r\n\r\n  move(afterEl: HTMLElement) {\r\n    if (this.isMoved) return\r\n    this.isMoved = true\r\n\r\n    const editorEl = this.kit.useUI().$el\r\n\r\n    editorEl.after(Utils.createElement('<div class=\"atk-editor-travel-placeholder\"></div>'))\r\n\r\n    const $travelPlace = Utils.createElement('<div></div>')\r\n    afterEl.after($travelPlace)\r\n    $travelPlace.replaceWith(editorEl)\r\n\r\n    editorEl.classList.add('atk-fade-in') // 添加渐入动画\r\n    editorEl.classList.add('editor-traveling')\r\n  }\r\n\r\n  back() {\r\n    if (!this.isMoved) return\r\n    this.isMoved = false\r\n    this.kit\r\n      .useGlobalCtx()\r\n      .$root.querySelector('.atk-editor-travel-placeholder')\r\n      ?.replaceWith(this.kit.useUI().$el)\r\n    this.kit.useUI().$el.classList.remove('editor-traveling')\r\n  }\r\n}\r\n","import Mover from '../plugins/editor/mover'\r\nimport type Editor from './editor'\r\nimport type { EditorState, CommentData } from '@/types'\r\nimport * as Ui from '@/lib/ui'\r\n\r\nexport default class EditorStateManager {\r\n  constructor(private editor: Editor) {}\r\n\r\n  private stateCurt: EditorState = 'normal'\r\n  private stateUnmountFn: (() => void) | null = null\r\n\r\n  /** Get current state */\r\n  get() {\r\n    return this.stateCurt\r\n  }\r\n\r\n  /**\r\n   * Switch editor state\r\n   *\r\n   * @param state The state to switch\r\n   * @param payload The cause of state switch\r\n   */\r\n  switch(state: EditorState, payload?: { $comment: HTMLElement; comment: CommentData }) {\r\n    // trigger unmount\r\n    if (this.stateUnmountFn) {\r\n      this.stateUnmountFn()\r\n      this.stateUnmountFn = null\r\n\r\n      // move editor back to the initial position\r\n      this.editor.getPlugs()?.get(Mover)?.back()\r\n    }\r\n\r\n    // invoke effect function and save unmount function\r\n    if (state !== 'normal' && payload) {\r\n      // move editor position\r\n      let moveAfterEl = payload.$comment\r\n      if (!this.editor.conf.flatMode)\r\n        moveAfterEl = moveAfterEl.querySelector<HTMLElement>('.atk-footer')!\r\n      this.editor.getPlugs()?.get(Mover)?.move(moveAfterEl)\r\n\r\n      const $relative =\r\n        this.editor.ctx.conf.scrollRelativeTo && this.editor.ctx.conf.scrollRelativeTo()\r\n      Ui.scrollIntoView(this.editor.getUI().$el, true, $relative)\r\n\r\n      const plugin = this.editor\r\n        .getPlugs()\r\n        ?.getPlugs()\r\n        .find((p) => p.editorStateEffectWhen === state)\r\n      if (plugin && plugin.editorStateEffect) {\r\n        this.stateUnmountFn = plugin.editorStateEffect(payload.comment)\r\n      }\r\n    }\r\n\r\n    // change current state\r\n    this.stateCurt = state\r\n  }\r\n}\r\n","import Component from '../lib/component'\r\nimport * as Ui from '../lib/ui'\r\nimport marked from '../lib/marked'\r\nimport { render, EditorUI } from './ui'\r\nimport EditorStateManager from './state'\r\nimport type { CommentData, ContextApi, EditorApi } from '@/types'\r\n\r\nclass Editor extends Component implements EditorApi {\r\n  private ui: EditorUI\r\n  private state: EditorStateManager\r\n\r\n  getUI() {\r\n    return this.ui\r\n  }\r\n  getPlugs() {\r\n    return this.ctx.get('editorPlugs')\r\n  }\r\n  getState() {\r\n    return this.state.get()\r\n  }\r\n\r\n  constructor(ctx: ContextApi) {\r\n    super(ctx)\r\n\r\n    // init editor ui\r\n    this.ui = render()\r\n    this.$el = this.ui.$el\r\n\r\n    // init state manager\r\n    this.state = new EditorStateManager(this)\r\n  }\r\n\r\n  getHeaderInputEls() {\r\n    return { nick: this.ui.$nick, email: this.ui.$email }\r\n  }\r\n\r\n  getContentFinal() {\r\n    let content = this.getContentRaw()\r\n\r\n    // plug hook: final content transformer\r\n    const plugs = this.getPlugs()\r\n    if (plugs) content = plugs.getTransformedContent(content)\r\n\r\n    return content\r\n  }\r\n\r\n  getContentRaw() {\r\n    return this.ui.$textarea.value || ''\r\n  }\r\n\r\n  getContentMarked() {\r\n    return marked(this.getContentFinal())\r\n  }\r\n\r\n  setContent(val: string) {\r\n    this.ui.$textarea.value = val\r\n\r\n    // plug hook: content updated\r\n    this.getPlugs()?.getEvents().trigger('content-updated', val)\r\n  }\r\n\r\n  insertContent(val: string) {\r\n    if ((document as any).selection) {\r\n      this.ui.$textarea.focus()\r\n      ;(document as any).selection.createRange().text = val\r\n      this.ui.$textarea.focus()\r\n    } else if (this.ui.$textarea.selectionStart || this.ui.$textarea.selectionStart === 0) {\r\n      const sStart = this.ui.$textarea.selectionStart\r\n      const sEnd = this.ui.$textarea.selectionEnd\r\n      const sT = this.ui.$textarea.scrollTop\r\n      this.setContent(\r\n        this.ui.$textarea.value.substring(0, sStart) +\r\n          val +\r\n          this.ui.$textarea.value.substring(sEnd, this.ui.$textarea.value.length),\r\n      )\r\n      this.ui.$textarea.focus()\r\n      this.ui.$textarea.selectionStart = sStart + val.length\r\n      this.ui.$textarea.selectionEnd = sStart + val.length\r\n      this.ui.$textarea.scrollTop = sT\r\n    } else {\r\n      this.ui.$textarea.focus()\r\n      this.ui.$textarea.value += val\r\n    }\r\n  }\r\n\r\n  focus() {\r\n    this.ui.$textarea.focus()\r\n  }\r\n\r\n  reset() {\r\n    this.setContent('')\r\n    this.resetState()\r\n  }\r\n\r\n  resetState() {\r\n    this.state.switch('normal')\r\n  }\r\n\r\n  setReply(comment: CommentData, $comment: HTMLElement) {\r\n    this.state.switch('reply', { comment, $comment })\r\n  }\r\n\r\n  setEditComment(comment: CommentData, $comment: HTMLElement) {\r\n    this.state.switch('edit', { comment, $comment })\r\n  }\r\n\r\n  showNotify(msg: string, type: any) {\r\n    // Ui.showNotify(this.ui.$notifyWrap, msg, type)\r\n  }\r\n\r\n  showLoading() {\r\n    Ui.showLoading(this.ui.$el)\r\n  }\r\n\r\n  hideLoading() {\r\n    Ui.hideLoading(this.ui.$el)\r\n  }\r\n\r\n  submit() {\r\n    const next = () => this.ctx.trigger('editor-submit')\r\n    if (this.ctx.conf.beforeSubmit) {\r\n      this.ctx.conf.beforeSubmit(this, next)\r\n    } else {\r\n      next()\r\n    }\r\n  }\r\n}\r\n\r\nexport default Editor\r\n","export default \"<div class=\\\"atk-sidebar-layer\\\">\\r\\n  <div class=\\\"atk-sidebar-inner\\\">\\r\\n    <div class=\\\"atk-sidebar-header\\\">\\r\\n      <div class=\\\"atk-sidebar-close\\\">\\r\\n        <i class=\\\"atk-icon atk-icon-close-slim\\\"></i>\\r\\n      </div>\\r\\n    </div>\\r\\n    <div class=\\\"atk-sidebar-iframe-wrap\\\"></div>\\r\\n  </div>\\r\\n</div>\\r\\n\"","import SidebarHTML from './sidebar-layer.html?raw'\r\nimport type { Layer } from './layer'\r\nimport type { ContextApi, SidebarShowPayload } from '@/types'\r\nimport Component from '@/lib/component'\r\nimport * as Utils from '@/lib/utils'\r\nimport * as Ui from '@/lib/ui'\r\n\r\nexport default class SidebarLayer extends Component {\r\n  public layer?: Layer\r\n  public $header: HTMLElement\r\n  public $closeBtn: HTMLElement\r\n  public $iframeWrap: HTMLElement\r\n  public $iframe?: HTMLIFrameElement\r\n\r\n  constructor(ctx: ContextApi) {\r\n    super(ctx)\r\n\r\n    this.$el = Utils.createElement(SidebarHTML)\r\n    this.$header = this.$el.querySelector('.atk-sidebar-header')!\r\n    this.$closeBtn = this.$header.querySelector('.atk-sidebar-close')!\r\n    this.$iframeWrap = this.$el.querySelector('.atk-sidebar-iframe-wrap')!\r\n\r\n    this.$closeBtn.onclick = () => {\r\n      this.hide()\r\n    }\r\n\r\n    // event\r\n    this.ctx.on('user-changed', () => {\r\n      this.refreshOnShow = true\r\n    })\r\n  }\r\n\r\n  /** Refresh iFrame on show */\r\n  private refreshOnShow = true\r\n\r\n  /** Animation timer */\r\n  private animTimer?: any = undefined\r\n\r\n  /** 显示 */\r\n  public async show(conf: SidebarShowPayload = {}) {\r\n    this.$el.style.transform = '' // 动画清除，防止二次打开失效\r\n\r\n    // init layer\r\n    this.initLayer()\r\n    this.layer!.show()\r\n\r\n    // init iframe\r\n    if (this.refreshOnShow) {\r\n      this.refreshOnShow = false\r\n      this.$iframeWrap.innerHTML = ''\r\n      this.$iframe = this.createIframe(conf.view)\r\n      this.$iframeWrap.append(this.$iframe)\r\n    } else {\r\n      // Sync Dark Mode (reload iframe if not match)\r\n      const $iframe = this.$iframe!\r\n      const iFrameSrc = $iframe.src\r\n      if (this.getDarkMode() !== iFrameSrc.includes('&darkMode=1')) {\r\n        this.iframeLoad(\r\n          $iframe,\r\n          this.getDarkMode()\r\n            ? iFrameSrc.concat('&darkMode=1')\r\n            : iFrameSrc.replace('&darkMode=1', ''),\r\n        )\r\n      }\r\n    }\r\n\r\n    // 管理员身份验证 (若身份失效，弹出验证窗口)\r\n    this.authCheck({\r\n      onSuccess: () => this.show(conf), // retry show after auth check\r\n    })\r\n\r\n    // 执行滑动显示动画\r\n    this.animTimer = setTimeout(() => {\r\n      this.animTimer = undefined\r\n      this.$el.style.transform = 'translate(0, 0)'\r\n\r\n      setTimeout(() => {\r\n        this.ctx.getData().updateNotifies([])\r\n      }, 0)\r\n\r\n      this.ctx.trigger('sidebar-show')\r\n    }, 100)\r\n  }\r\n\r\n  /** 隐藏 */\r\n  public hide() {\r\n    this.layer?.hide()\r\n  }\r\n\r\n  // --------------------------------------------------\r\n\r\n  private async authCheck(opts: { onSuccess: () => void }) {\r\n    const data = (\r\n      await this.ctx.getApi().user.getUserStatus({\r\n        ...this.ctx.getApi().getUserFields(),\r\n      })\r\n    ).data\r\n    if (data.is_admin && !data.is_login) {\r\n      this.refreshOnShow = true\r\n\r\n      // show checker layer\r\n      this.ctx.checkAdmin({\r\n        onSuccess: () => {\r\n          setTimeout(() => {\r\n            opts.onSuccess()\r\n          }, 500)\r\n        },\r\n        onCancel: () => {\r\n          this.hide()\r\n        },\r\n      })\r\n\r\n      // hide sidebar layer\r\n      this.hide()\r\n    }\r\n  }\r\n\r\n  private initLayer() {\r\n    if (this.layer) return\r\n\r\n    this.layer = this.ctx.get('layerManager').create('sidebar', this.$el)\r\n    this.layer.setOnAfterHide(() => {\r\n      // 防止评论框被吞\r\n      this.ctx.editorResetState()\r\n\r\n      // interrupt animation\r\n      this.animTimer && clearTimeout(this.animTimer)\r\n\r\n      // perform transform\r\n      this.$el.style.transform = ''\r\n\r\n      // trigger event\r\n      this.ctx.trigger('sidebar-hide')\r\n    })\r\n  }\r\n\r\n  private createIframe(view?: string) {\r\n    const $iframe = Utils.createElement<HTMLIFrameElement>(\r\n      '<iframe referrerpolicy=\"strict-origin-when-cross-origin\"></iframe>',\r\n    )\r\n\r\n    // 准备 Iframe 参数\r\n    const baseURL = import.meta.env.DEV\r\n      ? 'http://localhost:23367/'\r\n      : Utils.getURLBasedOnApi({\r\n          base: this.ctx.conf.server,\r\n          path: '/sidebar/',\r\n        })\r\n\r\n    const query: any = {\r\n      pageKey: this.conf.pageKey,\r\n      site: this.conf.site || '',\r\n      user: JSON.stringify(this.ctx.get('user').getData()),\r\n      time: +new Date(),\r\n    }\r\n\r\n    if (view) query.view = view\r\n    if (this.getDarkMode()) query.darkMode = '1'\r\n\r\n    const urlParams = new URLSearchParams(query)\r\n    this.iframeLoad($iframe, `${baseURL}?${urlParams.toString()}`)\r\n\r\n    return $iframe\r\n  }\r\n\r\n  private getDarkMode() {\r\n    return this.conf.darkMode === 'auto'\r\n      ? window.matchMedia('(prefers-color-scheme: dark)').matches\r\n      : this.conf.darkMode\r\n  }\r\n\r\n  private iframeLoad($iframe: HTMLIFrameElement, src: string) {\r\n    $iframe.src = src\r\n\r\n    // 加载动画\r\n    Ui.showLoading(this.$iframeWrap)\r\n    $iframe.onload = () => {\r\n      Ui.hideLoading(this.$iframeWrap)\r\n    }\r\n  }\r\n}\r\n","export default \"<div class=\\\"atk-list\\\">\\r\\n  <div class=\\\"atk-list-header\\\">\\r\\n    <div class=\\\"atk-comment-count\\\">\\r\\n      <div class=\\\"atk-text\\\"></div>\\r\\n    </div>\\r\\n    <div class=\\\"atk-right-action\\\">\\r\\n      <span data-action=\\\"admin-close-comment\\\" class=\\\"atk-hide\\\" atk-only-admin-show></span>\\r\\n      <span data-action=\\\"open-sidebar\\\" class=\\\"atk-hide atk-on\\\">\\r\\n        <span class=\\\"atk-unread-badge\\\" style=\\\"display: none\\\"></span>\\r\\n        <div class=\\\"atk-text\\\"></div>\\r\\n      </span>\\r\\n    </div>\\r\\n  </div>\\r\\n  <div class=\\\"atk-list-body\\\">\\r\\n    <div class=\\\"atk-list-comments-wrap\\\"></div>\\r\\n  </div>\\r\\n  <div class=\\\"atk-list-footer\\\">\\r\\n    <div class=\\\"atk-copyright\\\"></div>\\r\\n  </div>\\r\\n</div>\\r\\n\"","import type { CommentData } from '@/types'\r\n\r\nexport type CommentNode = {\r\n  id: number\r\n  comment: CommentData\r\n  children: CommentNode[]\r\n  parent?: CommentNode\r\n  level: number\r\n}\r\n\r\nexport type SortByType = 'DATE_DESC' | 'DATE_ASC' | 'SRC_INDEX' | 'VOTE_UP_DESC'\r\n\r\n// 构建树状结构列表\r\nexport function makeNestCommentNodeList(\r\n  srcData: CommentData[],\r\n  sortBy: SortByType = 'DATE_DESC',\r\n  nestMax = 2,\r\n) {\r\n  const nodeList: CommentNode[] = []\r\n\r\n  const roots = srcData.filter((o) => o.rid === 0)\r\n  roots.forEach((root: CommentData) => {\r\n    const rootNode: CommentNode = {\r\n      id: root.id,\r\n      comment: root,\r\n      children: [],\r\n      level: 1,\r\n    }\r\n\r\n    rootNode.parent = rootNode\r\n    nodeList.push(rootNode)\r\n    ;(function loadChildren(parentNode: CommentNode) {\r\n      const children = srcData.filter((o) => o.rid === parentNode.id)\r\n      if (children.length === 0) return\r\n      if (parentNode.level >= nestMax) parentNode = parentNode.parent!\r\n      children.forEach((child: CommentData) => {\r\n        const childNode: CommentNode = {\r\n          id: child.id,\r\n          comment: child,\r\n          children: [],\r\n          parent: parentNode,\r\n          level: parentNode.level + 1,\r\n        }\r\n\r\n        parentNode.children.push(childNode)\r\n        loadChildren(childNode)\r\n      })\r\n    })(rootNode)\r\n  })\r\n\r\n  // 排序\r\n  const sortFunc = (a: CommentNode, b: CommentNode): number => {\r\n    let v = a.id - b.id\r\n    if (sortBy === 'DATE_ASC') v = +new Date(a.comment.date) - +new Date(b.comment.date)\r\n    else if (sortBy === 'DATE_DESC') v = +new Date(b.comment.date) - +new Date(a.comment.date)\r\n    else if (sortBy === 'SRC_INDEX') v = srcData.indexOf(a.comment) - srcData.indexOf(b.comment)\r\n    else if (sortBy === 'VOTE_UP_DESC') v = b.comment.vote_up - a.comment.vote_up\r\n    return v\r\n  }\r\n\r\n  ;(function sortLevels(nodes: CommentNode[]) {\r\n    nodes.forEach((node) => {\r\n      node.children = node.children.sort(sortFunc)\r\n      sortLevels(node.children)\r\n    })\r\n  })(nodeList)\r\n\r\n  return nodeList\r\n}\r\n","import type { LayoutStrategyCreator } from '.'\r\nimport type { CommentNode } from '@/comment'\r\nimport * as Ui from '@/lib/ui'\r\nimport * as ListNest from '@/list/nest'\r\n\r\nexport const createNestStrategy: LayoutStrategyCreator = (opts) => ({\r\n  import: (comments) => {\r\n    // 遍历 root 评论\r\n    const rootNodes = ListNest.makeNestCommentNodeList(comments, opts.nestSortBy, opts.nestMax)\r\n    rootNodes.forEach((rootNode: ListNest.CommentNode) => {\r\n      const rootC = opts.createCommentNode(rootNode.comment)\r\n\r\n      // 显示并播放渐入动画\r\n      opts.$commentsWrap?.appendChild(rootC.getEl())\r\n      rootC.getRender().playFadeAnim()\r\n\r\n      // 加载子评论\r\n      const loadChildren = (parentC: CommentNode, parentNode: ListNest.CommentNode) => {\r\n        parentNode.children.forEach((node: ListNest.CommentNode) => {\r\n          const replyD = comments.find((c) => c.id === node.comment.rid)\r\n          const childD = node.comment\r\n          const childC = opts.createCommentNode(childD, replyD)\r\n\r\n          // 插入到父评论中\r\n          parentC.putChild(childC)\r\n\r\n          // 递归加载子评论\r\n          loadChildren(childC, node)\r\n        })\r\n      }\r\n      loadChildren(rootC, rootNode)\r\n\r\n      // 限高检测\r\n      rootC.getRender().checkHeightLimit()\r\n    })\r\n  },\r\n  insert: (comment, replyComment) => {\r\n    // 嵌套模式\r\n    const node = opts.createCommentNode(comment, replyComment)\r\n\r\n    if (comment.rid === 0) {\r\n      // root评论 新增\r\n      opts.$commentsWrap?.prepend(node.getEl())\r\n    } else {\r\n      // 子评论 新增\r\n      const parent = opts.findCommentNode(comment.rid)\r\n      if (parent) {\r\n        parent.putChild(node, opts.nestSortBy === 'DATE_ASC' ? 'append' : 'prepend')\r\n\r\n        // 若父评论存在 “子评论部分” 限高，取消限高\r\n        node.getParents().forEach((p) => {\r\n          p.getRender().heightLimitRemoveForChildren()\r\n        })\r\n      }\r\n    }\r\n\r\n    node.getRender().checkHeightLimit()\r\n\r\n    node.scrollIntoView() // 滚动到可以见\r\n    node.getRender().playFadeAnim() // 播放评论渐出动画\r\n  },\r\n})\r\n","import type { LayoutStrategyCreator, LayoutOptions } from '.'\r\nimport type { CommentData } from '@/types'\r\nimport * as Ui from '@/lib/ui'\r\n\r\nexport const createFlatStrategy: LayoutStrategyCreator = (opts) => ({\r\n  import: (comments) => {\r\n    comments.forEach((comment: CommentData) => {\r\n      const replyComment =\r\n        comment.rid === 0 ? undefined : comments.find((c) => c.id === comment.rid)\r\n      insertComment(opts, 'append', comment, replyComment)\r\n    })\r\n  },\r\n  insert: (comment, replyComment) => {\r\n    const node = insertComment(opts, 'prepend', comment, replyComment)\r\n    node.scrollIntoView()\r\n  },\r\n})\r\n\r\n/** 导入评论 · 平铺模式 */\r\nfunction insertComment(\r\n  opts: LayoutOptions,\r\n  insertMode: 'append' | 'prepend',\r\n  comment: CommentData,\r\n  replyComment?: CommentData | undefined,\r\n) {\r\n  if (comment.is_collapsed) comment.is_allow_reply = false\r\n  const node = opts.createCommentNode(comment, replyComment)\r\n\r\n  // 可见评论添加到界面\r\n  // 注：不可见评论用于显示 “引用内容”\r\n  if (comment.visible) {\r\n    const $comment = node.getEl()\r\n    const $listCommentsWrap = opts.$commentsWrap\r\n    if (insertMode === 'append') $listCommentsWrap?.append($comment)\r\n    if (insertMode === 'prepend') $listCommentsWrap?.prepend($comment)\r\n    node.getRender().playFadeAnim()\r\n  }\r\n\r\n  // 平铺评论插入后 · 内容限高检测\r\n  // 插入列表的评论 (visible=true) 和关联的评论 (visible=false) 都需要检测\r\n  node.getRender().checkHeightLimit()\r\n\r\n  return node\r\n}\r\n","import * as ListNest from '../nest'\r\nimport { createNestStrategy } from './nest'\r\nimport { createFlatStrategy } from './flat'\r\nimport type { CommentNode } from '@/comment'\r\nimport type { CommentData } from '@/types'\r\n\r\nexport interface LayoutOptions {\r\n  /** The comments wrap of list */\r\n  $commentsWrap: HTMLElement\r\n  nestSortBy: ListNest.SortByType\r\n  nestMax: number\r\n  flatMode: boolean\r\n\r\n  createCommentNode(comment: CommentData, replyComment?: CommentData): CommentNode\r\n  findCommentNode(id: number): CommentNode | undefined\r\n}\r\n\r\nexport interface LayoutStrategy {\r\n  import(comments: CommentData[]): void\r\n  insert(comment: CommentData, replyComment?: CommentData): void\r\n}\r\n\r\nexport type LayoutStrategyCreator = (opts: LayoutOptions) => LayoutStrategy\r\n\r\nexport class ListLayout {\r\n  constructor(private options: LayoutOptions) {}\r\n\r\n  private getStrategy() {\r\n    return this.options.flatMode\r\n      ? createFlatStrategy(this.options)\r\n      : createNestStrategy(this.options)\r\n  }\r\n\r\n  import(comments: CommentData[]) {\r\n    this.getStrategy().import(comments)\r\n  }\r\n\r\n  insert(comment: CommentData, replyComment?: CommentData) {\r\n    this.getStrategy().insert(comment, replyComment)\r\n  }\r\n}\r\n","function Detect(userAgent?: string) {\r\n  const win = (window as any) || {}\r\n  const nav = navigator || {}\r\n\r\n  const u = String(userAgent || nav.userAgent)\r\n  const dest = {\r\n    os: '',\r\n    osVersion: '',\r\n    engine: '',\r\n    browser: '',\r\n    device: '',\r\n    language: '',\r\n    version: ''\r\n  }\r\n\r\n  // 内核\r\n  const engineMatch = {\r\n    Trident: u.includes('Trident') || u.includes('NET CLR'),\r\n    Presto: u.includes('Presto'),\r\n    WebKit: u.includes('AppleWebKit'),\r\n    Gecko: u.includes('Gecko/')\r\n  }\r\n\r\n  // 浏览器\r\n  const browserMatch = {\r\n    Safari: u.includes('Safari'),\r\n    Chrome: u.includes('Chrome') || u.includes('CriOS'),\r\n    IE: u.includes('MSIE') || u.includes('Trident'),\r\n    Edge: u.includes('Edge') || u.includes('Edg'),\r\n    Firefox: u.includes('Firefox') || u.includes('FxiOS'),\r\n    'Firefox Focus': u.includes('Focus'),\r\n    Chromium: u.includes('Chromium'),\r\n    Opera: u.includes('Opera') || u.includes('OPR'),\r\n    Vivaldi: u.includes('Vivaldi'),\r\n    Yandex: u.includes('YaBrowser'),\r\n    Kindle: u.includes('Kindle') || u.includes('Silk/'),\r\n    360: u.includes('360EE') || u.includes('360SE'),\r\n    UC: u.includes('UC') || u.includes(' UBrowser'),\r\n    QQBrowser: u.includes('QQBrowser'),\r\n    QQ: u.includes('QQ/'),\r\n    Baidu: u.includes('Baidu') || u.includes('BIDUBrowser'),\r\n    Maxthon: u.includes('Maxthon'),\r\n    Sogou: u.includes('MetaSr') || u.includes('Sogou'),\r\n    LBBROWSER: u.includes('LBBROWSER'),\r\n    '2345Explorer': u.includes('2345Explorer'),\r\n    TheWorld: u.includes('TheWorld'),\r\n    MIUI: u.includes('MiuiBrowser'),\r\n    Quark: u.includes('Quark'),\r\n    Qiyu: u.includes('Qiyu'),\r\n    Wechat: u.includes('MicroMessenger'),\r\n    Taobao: u.includes('AliApp(TB'),\r\n    Alipay: u.includes('AliApp(AP'),\r\n    Weibo: u.includes('Weibo'),\r\n    Douban: u.includes('com.douban.frodo'),\r\n    Suning: u.includes('SNEBUY-APP'),\r\n    iQiYi: u.includes('IqiyiApp'),\r\n  }\r\n\r\n  // 系统或平台\r\n  const osMatch = {\r\n    Windows: u.includes('Windows'),\r\n    Linux: u.includes('Linux') || u.includes('X11'),\r\n    'macOS': u.includes('Macintosh'),\r\n    Android: u.includes('Android') || u.includes('Adr'),\r\n    Ubuntu: u.includes('Ubuntu'),\r\n    FreeBSD: u.includes('FreeBSD'),\r\n    Debian: u.includes('Debian'),\r\n    'Windows Phone': u.includes('IEMobile') || u.includes('Windows Phone'),\r\n    BlackBerry: u.includes('BlackBerry') || u.includes('RIM'),\r\n    MeeGo: u.includes('MeeGo'),\r\n    Symbian: u.includes('Symbian'),\r\n    iOS: u.includes('like Mac OS X'),\r\n    'Chrome OS': u.includes('CrOS'),\r\n    WebOS: u.includes('hpwOS'),\r\n  }\r\n\r\n  // 设备\r\n  const deviceMatch = {\r\n    Mobile: u.includes('Mobi') || u.includes('iPh') || u.includes('480'),\r\n    Tablet: u.includes('Tablet') || u.includes('Pad') || u.includes('Nexus 7')\r\n  }\r\n\r\n  // 修正\r\n  if (deviceMatch.Mobile) {\r\n    deviceMatch.Mobile = !(u.includes('iPad'))\r\n  } else if (browserMatch.Chrome && u.includes('Edg')) {\r\n    // Chrome 内核的 Edge\r\n    browserMatch.Chrome = false\r\n    browserMatch.Edge = true\r\n  } else if (win.showModalDialog && win.chrome) {\r\n    browserMatch.Chrome = false\r\n    browserMatch['360'] = true\r\n  }\r\n\r\n  // 默认设备\r\n  dest.device = 'PC'\r\n\r\n  // 语言\r\n  dest.language = (() => {\r\n    const g = ((nav as any).browserLanguage || nav.language)\r\n    const arr = g.split('-')\r\n    if (arr[1]) arr[1] = arr[1].toUpperCase()\r\n    return arr.join('_')\r\n  })()\r\n\r\n  // 应用判断数据\r\n  const hash = {\r\n    engine: engineMatch,\r\n    browser: browserMatch,\r\n    os: osMatch,\r\n    device: deviceMatch,\r\n  }\r\n  Object.entries(hash).forEach(([type, match]) => {\r\n    Object.entries(match).forEach(([name, result]) => {\r\n      if (result === true) dest[type] = name\r\n    })\r\n  })\r\n\r\n  // 系统版本信息\r\n  const osVersion = {\r\n    Windows: () => {\r\n      const v = u.replace(/^.*Windows NT ([\\d.]+);.*$/, '$1')\r\n      const wvHash = {\r\n        '6.4': '10',\r\n        '6.3': '8.1',\r\n        '6.2': '8',\r\n        '6.1': '7',\r\n        '6.0': 'Vista',\r\n        '5.2': 'XP',\r\n        '5.1': 'XP',\r\n        '5.0': '2000',\r\n        '10.0': '10',\r\n        '11.0': '11' // 自定的，不是微软官方的判断方法\r\n      }\r\n      return wvHash[v] || v\r\n    },\r\n    Android: () => u.replace(/^.*Android ([\\d.]+);.*$/, '$1'),\r\n    iOS: () => u.replace(/^.*OS ([\\d_]+) like.*$/, '$1').replace(/_/g, '.'),\r\n    Debian: () => u.replace(/^.*Debian\\/([\\d.]+).*$/, '$1'),\r\n    'Windows Phone': () => u.replace(/^.*Windows Phone( OS)? ([\\d.]+);.*$/, '$2'),\r\n    'macOS': () => u.replace(/^.*Mac OS X ([\\d_]+).*$/, '$1').replace(/_/g, '.'),\r\n    WebOS: () => u.replace(/^.*hpwOS\\/([\\d.]+);.*$/, '$1')\r\n  }\r\n\r\n  dest.osVersion = ''\r\n  if (osVersion[dest.os]) {\r\n    dest.osVersion = osVersion[dest.os]()\r\n    if (dest.osVersion === u) {\r\n      dest.osVersion = ''\r\n    }\r\n  }\r\n\r\n  // 浏览器版本信息\r\n  const version = {\r\n    Safari: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\r\n    Chrome: () => u.replace(/^.*Chrome\\/([\\d.]+).*$/, '$1').replace(/^.*CriOS\\/([\\d.]+).*$/, '$1'),\r\n    IE: () => u.replace(/^.*MSIE ([\\d.]+).*$/, '$1').replace(/^.*rv:([\\d.]+).*$/, '$1'),\r\n    Edge: () => u.replace(/^.*(Edge|Edg|Edg[A-Z]{1})\\/([\\d.]+).*$/, '$2'),\r\n    Firefox: () => u.replace(/^.*Firefox\\/([\\d.]+).*$/, '$1').replace(/^.*FxiOS\\/([\\d.]+).*$/, '$1'),\r\n    'Firefox Focus': () => u.replace(/^.*Focus\\/([\\d.]+).*$/, '$1'),\r\n    Chromium: () => u.replace(/^.*Chromium\\/([\\d.]+).*$/, '$1'),\r\n    Opera: () => u.replace(/^.*Opera\\/([\\d.]+).*$/, '$1').replace(/^.*OPR\\/([\\d.]+).*$/, '$1'),\r\n    Vivaldi: () => u.replace(/^.*Vivaldi\\/([\\d.]+).*$/, '$1'),\r\n    Yandex: () => u.replace(/^.*YaBrowser\\/([\\d.]+).*$/, '$1'),\r\n    Kindle: () => u.replace(/^.*Version\\/([\\d.]+).*$/, '$1'),\r\n    Maxthon: () => u.replace(/^.*Maxthon\\/([\\d.]+).*$/, '$1'),\r\n    QQBrowser: () => u.replace(/^.*QQBrowser\\/([\\d.]+).*$/, '$1'),\r\n    QQ: () => u.replace(/^.*QQ\\/([\\d.]+).*$/, '$1'),\r\n    Baidu: () => u.replace(/^.*BIDUBrowser[\\s/]([\\d.]+).*$/, '$1'),\r\n    UC: () => u.replace(/^.*UC?Browser\\/([\\d.]+).*$/, '$1'),\r\n    Sogou: () => u.replace(/^.*SE ([\\d.X]+).*$/, '$1').replace(/^.*SogouMobileBrowser\\/([\\d.]+).*$/, '$1'),\r\n    '2345Explorer': () => u.replace(/^.*2345Explorer\\/([\\d.]+).*$/, '$1'),\r\n    TheWorld: () => u.replace(/^.*TheWorld ([\\d.]+).*$/, '$1'),\r\n    MIUI: () => u.replace(/^.*MiuiBrowser\\/([\\d.]+).*$/, '$1'),\r\n    Quark: () => u.replace(/^.*Quark\\/([\\d.]+).*$/, '$1'),\r\n    Qiyu: () => u.replace(/^.*Qiyu\\/([\\d.]+).*$/, '$1'),\r\n    Wechat: () => u.replace(/^.*MicroMessenger\\/([\\d.]+).*$/, '$1'),\r\n    Taobao: () => u.replace(/^.*AliApp\\(TB\\/([\\d.]+).*$/, '$1'),\r\n    Alipay: () => u.replace(/^.*AliApp\\(AP\\/([\\d.]+).*$/, '$1'),\r\n    Weibo: () => u.replace(/^.*weibo__([\\d.]+).*$/, '$1'),\r\n    Douban: () => u.replace(/^.*com.douban.frodo\\/([\\d.]+).*$/, '$1'),\r\n    Suning: () => u.replace(/^.*SNEBUY-APP([\\d.]+).*$/, '$1'),\r\n    iQiYi: () => u.replace(/^.*IqiyiVersion\\/([\\d.]+).*$/, '$1'),\r\n  }\r\n\r\n  dest.version = ''\r\n  if (version[dest.browser]) {\r\n    dest.version = version[dest.browser]()\r\n    if (dest.version === u) {\r\n      dest.version = ''\r\n    }\r\n  }\r\n\r\n  // 简化版本号\r\n  /* if (_this.osVersion.indexOf('.')) {\r\n    _this.osVersion = _this.osVersion.substring(0, _this.osVersion.indexOf('.'))\r\n  } */\r\n  if (dest.version.indexOf('.')) {\r\n    dest.version = dest.version.substring(0, dest.version.indexOf('.'))\r\n  }\r\n\r\n  // 修正\r\n  if (dest.os === 'iOS' && u.includes('iPad')) {\r\n    dest.os = 'iPadOS'\r\n  } else if (dest.browser === 'Edge' && !u.includes('Edg')) {\r\n    dest.engine = 'EdgeHTML'\r\n  } else if (dest.browser === 'MIUI') {\r\n    dest.os = 'Android'\r\n  } else if (dest.browser === 'Chrome' && Number(dest.version) > 27) {\r\n    dest.engine = 'Blink'\r\n  } else if (dest.browser === 'Opera' && Number(dest.version) > 12) {\r\n    dest.engine = 'Blink'\r\n  } else if (dest.browser === 'Yandex') {\r\n    dest.engine = 'Blink'\r\n  } else if (dest.browser === undefined) {\r\n    dest.browser = 'Unknow App'\r\n  }\r\n\r\n  return dest\r\n}\r\n\r\nexport default Detect\r\n","import * as Utils from '../lib/utils'\r\nimport $t from '../i18n'\r\n\r\nexport interface IHeightLimitConf {\r\n  /** After expand btn click */\r\n  afterExpandBtnClick?: () => void\r\n  /** Allow Scroll */\r\n  scrollable?: boolean\r\n}\r\n\r\nexport interface IHeightLimitRule {\r\n  /** Target element need to check */\r\n  el: HTMLElement | null | undefined\r\n\r\n  /** Max height (unit: px) */\r\n  max: number\r\n\r\n  /** Whether or not the element contains `<img />` */\r\n  imgCheck?: boolean\r\n}\r\n\r\nexport type THeightLimitRuleSet = IHeightLimitRule[]\r\n\r\n/** Check all elements below the max height limit */\r\nexport function check(conf: IHeightLimitConf, rules: THeightLimitRuleSet) {\r\n  rules.forEach(({ el, max, imgCheck }) => {\r\n    if (!el) return\r\n\r\n    // set max height for avoiding img exceed the limit while loading\r\n    if (imgCheck) el.style.maxHeight = `${max + 1}px` // allow 1px more for next detecting\r\n\r\n    let lock = false\r\n    const _check = () => {\r\n      if (lock) return\r\n      if (Utils.getHeight(el) <= max) return // if not exceed the limit, do nothing\r\n\r\n      const afterExpandBtnClick = () => {\r\n        lock = true // add lock to prevent collapse again after expand when image lazy loaded\r\n        conf.afterExpandBtnClick?.()\r\n      }\r\n\r\n      !conf.scrollable\r\n        ? applyHeightLimit({ el, max, afterExpandBtnClick })\r\n        : applyScrollableHeightLimit({ el, max })\r\n    }\r\n\r\n    // check immediately\r\n    _check()\r\n\r\n    // check images after loaded\r\n    if (imgCheck) {\r\n      // check again when image loaded\r\n      const imgs = el.querySelectorAll<HTMLImageElement>('.atk-content img')\r\n      if (imgs.length === 0) el.style.maxHeight = ''\r\n      imgs.forEach((img) => {\r\n        img.onload = () => _check()\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n/** Height limit CSS class name */\r\nconst HEIGHT_LIMIT_CSS = 'atk-height-limit'\r\n\r\n/** Apply height limit on an element and add expand btn */\r\nexport function applyHeightLimit(obj: {\r\n  el: HTMLElement\r\n  max: number\r\n  afterExpandBtnClick?: (e: MouseEvent) => void\r\n}) {\r\n  if (!obj.el) return\r\n  if (!obj.max) return\r\n  if (obj.el.classList.contains(HEIGHT_LIMIT_CSS)) return\r\n\r\n  obj.el.classList.add(HEIGHT_LIMIT_CSS)\r\n  obj.el.style.height = `${obj.max}px`\r\n  obj.el.style.overflow = 'hidden'\r\n\r\n  /* Expand button */\r\n  const $expandBtn = Utils.createElement(\r\n    `<div class=\"atk-height-limit-btn\">${$t('readMore')}</span>`,\r\n  )\r\n  $expandBtn.onclick = (e) => {\r\n    e.stopPropagation()\r\n    disposeHeightLimit(obj.el)\r\n\r\n    if (obj.afterExpandBtnClick) obj.afterExpandBtnClick(e)\r\n  }\r\n  obj.el.append($expandBtn)\r\n}\r\n\r\n/** Dispose height limit on an element and remove expand btn */\r\nexport function disposeHeightLimit($el: HTMLElement) {\r\n  if (!$el) return\r\n  if (!$el.classList.contains(HEIGHT_LIMIT_CSS)) return\r\n\r\n  $el.classList.remove(HEIGHT_LIMIT_CSS)\r\n  Array.from($el.children).forEach((e) => {\r\n    if (e.classList.contains('atk-height-limit-btn')) e.remove()\r\n  })\r\n  $el.style.height = ''\r\n  $el.style.maxHeight = ''\r\n  $el.style.overflow = ''\r\n}\r\n\r\n/** Height limit scrollable CSS class name */\r\nconst HEIGHT_LIMIT_SCROLL_CSS = 'atk-height-limit-scroll'\r\n\r\n/** Apply scrollable height limit */\r\nexport function applyScrollableHeightLimit(opt: { el: HTMLElement; max: number }) {\r\n  if (!opt.el) return\r\n  if (opt.el.classList.contains(HEIGHT_LIMIT_SCROLL_CSS)) return\r\n  opt.el.classList.add(HEIGHT_LIMIT_SCROLL_CSS)\r\n  opt.el.style.height = `${opt.max}px`\r\n}\r\n","export default \"<div class=\\\"atk-comment-wrap\\\">\\r\\n  <div class=\\\"atk-comment\\\">\\r\\n    <div class=\\\"atk-avatar\\\"></div>\\r\\n    <div class=\\\"atk-main\\\">\\r\\n      <div class=\\\"atk-header\\\">\\r\\n        <span class=\\\"atk-item atk-nick\\\"></span>\\r\\n        <span class=\\\"atk-badge-wrap\\\"></span>\\r\\n        <span class=\\\"atk-item atk-date\\\"></span>\\r\\n      </div>\\r\\n      <div class=\\\"atk-body\\\">\\r\\n        <div class=\\\"atk-content\\\"></div>\\r\\n      </div>\\r\\n      <div class=\\\"atk-footer\\\">\\r\\n        <div class=\\\"atk-actions\\\"></div>\\r\\n      </div>\\r\\n    </div>\\r\\n  </div>\\r\\n</div>\\r\\n\"","import * as Utils from '../../lib/utils'\r\nimport type Render from '../render'\r\n\r\n/**\r\n * 评论头像界面\r\n */\r\nexport default function renderAvatar(r: Render) {\r\n  const $avatar = r.$el.querySelector<HTMLElement>('.atk-avatar')!\r\n  const $avatarImg = Utils.createElement<HTMLImageElement>('<img />')\r\n\r\n  const avatarURLBuilder = r.opts.avatarURLBuilder\r\n  $avatarImg.src = avatarURLBuilder ? avatarURLBuilder(r.data) : r.comment.getGravatarURL()\r\n\r\n  // if (r.data.link) {\r\n  //   const $avatarA = Utils.createElement<HTMLLinkElement>(\r\n  //     '<a target=\"_blank\" rel=\"noreferrer noopener nofollow\"></a>',\r\n  //   )\r\n  //   $avatarA.href = Utils.isValidURL(r.data.link) ? r.data.link : `https://${r.data.link}`\r\n  //   $avatarA.append($avatarImg)\r\n  //   $avatar.append($avatarA)\r\n  // } else {\r\n  //   $avatar.append($avatarImg)\r\n  // }\r\n  $avatar.append($avatarImg)\r\n}\r\n","import * as Utils from '../../lib/utils'\r\nimport type Render from '../render'\r\nimport $t from '@/i18n'\r\n\r\n\r\n/**\r\n * 评论头部界面\r\n */\r\nexport default function renderHeader(r: Render) {\r\n  Object.entries({\r\n    renderNick,\r\n    renderVerifyBadge,\r\n    renderDate,\r\n    renderUABadge,\r\n  }).forEach(([name, render]) => {\r\n    render(r)\r\n  })\r\n}\r\n\r\nfunction renderNick(r: Render) {\r\n  r.$headerNick = r.$el.querySelector<HTMLElement>('.atk-nick')!\r\n\r\n  r.$headerNick.innerText = r.data.nick\r\n}\r\n\r\nfunction renderVerifyBadge(ctx: Render) {\r\n  ctx.$headerBadgeWrap = ctx.$el.querySelector<HTMLElement>('.atk-badge-wrap')!\r\n  ctx.$headerBadgeWrap.innerHTML = ''\r\n\r\n  const badgeText = ctx.data.badge_name\r\n  const badgeColor = ctx.data.badge_color\r\n  if (badgeText) {\r\n    const $badge = Utils.createElement(`<span class=\"atk-badge\"></span>`)\r\n    $badge.innerText = badgeText.replace('管理员', $t('admin')) // i18n patch\r\n    $badge.style.backgroundColor = badgeColor || ''\r\n    ctx.$headerBadgeWrap.append($badge)\r\n  } else if (ctx.data.is_verified) {\r\n    const $verifiedBadge = Utils.createElement(\r\n      `<span class=\"atk-verified-icon\" title=\"${$t('emailVerified')}\"></span>`,\r\n    ) // 邮箱验证徽章\r\n    ctx.$headerBadgeWrap.append($verifiedBadge)\r\n  }\r\n\r\n  if (ctx.data.is_pinned) {\r\n    const $pinnedBadge = Utils.createElement(`<span class=\"atk-pinned-badge\">${$t('pin')}</span>`) // 置顶徽章\r\n    ctx.$headerBadgeWrap.append($pinnedBadge)\r\n  }\r\n}\r\n\r\nfunction renderDate(ctx: Render) {\r\n  const $date = ctx.$el.querySelector<HTMLElement>('.atk-date')!\r\n  $date.innerText = ctx.comment.getDateFormatted()\r\n  $date.setAttribute('data-atk-comment-date', String(+new Date(ctx.data.date)))\r\n}\r\n\r\nfunction renderUABadge(ctx: Render) {\r\n  if (!ctx.opts.uaBadge && !ctx.data.ip_region) return\r\n\r\n  let $uaWrap = ctx.$header.querySelector('atk-ua-wrap')\r\n  if (!$uaWrap) {\r\n    $uaWrap = Utils.createElement(`<span class=\"atk-ua-wrap\"></span>`)\r\n    ctx.$header.append($uaWrap)\r\n  }\r\n\r\n  $uaWrap.innerHTML = ''\r\n\r\n  if (ctx.data.ip_region) {\r\n    const $regionBadge = Utils.createElement(`<span class=\"atk-region-badge\"></span>`)\r\n    $regionBadge.innerText = ctx.data.ip_region\r\n    $uaWrap.append($regionBadge)\r\n  }\r\n\r\n  if (ctx.opts.uaBadge) {\r\n    const { browser, os } = ctx.comment.getUserUA()\r\n    if (String(browser).trim()) {\r\n      const $uaBrowser = Utils.createElement(`<span class=\"atk-ua ua-browser\"></span>`)\r\n      $uaBrowser.innerText = browser\r\n      $uaWrap.append($uaBrowser)\r\n    }\r\n\r\n    if (String(os).trim()) {\r\n      const $usOS = Utils.createElement(`<span class=\"atk-ua ua-os\"></span>`)\r\n      $usOS.innerText = os\r\n      $uaWrap.append($usOS)\r\n    }\r\n  }\r\n}\r\n","import * as Utils from '../../lib/utils'\r\nimport * as Ui from '../../lib/ui'\r\nimport type Render from '../render'\r\nimport $t from '@/i18n'\r\n\r\n/**\r\n * 评论内容界面\r\n */\r\nexport default function renderContent(r: Render) {\r\n  if (!r.data.is_collapsed) {\r\n    r.$content.innerHTML = r.comment.getContentMarked()\r\n    r.$content.classList.remove('atk-hide', 'atk-collapsed')\r\n    return\r\n  }\r\n\r\n  // 内容 & 折叠\r\n  r.$content.classList.add('atk-hide', 'atk-type-collapsed')\r\n  const collapsedInfoEl = Utils.createElement(`\r\n    <div class=\"atk-collapsed\">\r\n      <span class=\"atk-text\">${$t('collapsedMsg')}</span>\r\n      <span class=\"atk-show-btn\">${$t('expand')}</span>\r\n    </div>`)\r\n  r.$body.insertAdjacentElement('beforeend', collapsedInfoEl)\r\n\r\n  const contentShowBtn = collapsedInfoEl.querySelector<HTMLElement>('.atk-show-btn')!\r\n  contentShowBtn.addEventListener('click', (e) => {\r\n    e.stopPropagation() // 防止穿透\r\n\r\n    if (r.$content.classList.contains('atk-hide')) {\r\n      r.$content.innerHTML = r.comment.getContentMarked()\r\n      r.$content.classList.remove('atk-hide')\r\n      Ui.playFadeInAnim(r.$content)\r\n      contentShowBtn.innerText = $t('collapse')\r\n    } else {\r\n      r.$content.innerHTML = ''\r\n      r.$content.classList.add('atk-hide')\r\n      contentShowBtn.innerText = $t('expand')\r\n    }\r\n  })\r\n}\r\n","import * as Utils from '../../lib/utils'\r\nimport type Render from '../render'\r\n\r\n/**\r\n * Reply user indicator (with arrow icon) in the comment meta header\r\n */\r\nexport default function renderReplyAt(r: Render) {\r\n  if (r.opts.flatMode || r.data.rid === 0) return // if not nested mode or root comment\r\n  if (!r.opts.replyTo) return // if no replyTo data\r\n\r\n  r.$replyAt = Utils.createElement(\r\n    `<span class=\"atk-item atk-reply-at\"><span class=\"atk-nick\"></span></span>`,\r\n  )\r\n\r\n  r.$replyAt.querySelector<HTMLElement>('.atk-nick')!.innerText = `@${r.opts.replyTo.nick}`\r\n  r.$replyAt.onclick = () => {\r\n    r.comment.getActions().goToReplyComment()\r\n  }\r\n\r\n  // 在 $content 前插入\r\n  (r.$content?.firstChild as HTMLElement)!.insertAdjacentElement('afterbegin', r.$replyAt)\r\n\r\n  // r.$content.insertAdjacentElement('afterend', r.$replyAt)\r\n}\r\n","import type Render from '../render'\r\nimport * as Utils from '@/lib/utils'\r\nimport marked from '@/lib/marked'\r\nimport $t from '@/i18n'\r\n\r\n/**\r\n * 关联评论显示 (被回复的评论)\r\n */\r\nexport default function renderReplyTo(r: Render) {\r\n  if (!r.opts.flatMode) return // 仅平铺模式显示\r\n  if (!r.opts.replyTo) return\r\n\r\n  r.$replyTo = Utils.createElement(`\r\n    <div class=\"atk-reply-to\">\r\n      <div class=\"atk-meta\">${$t('reply')} <span class=\"atk-nick\"></span>:</div>\r\n      <div class=\"atk-content\"></div>\r\n    </div>`)\r\n\r\n  // Comment author name\r\n  const $nick = r.$replyTo.querySelector<HTMLElement>('.atk-nick')!\r\n  $nick.innerText = `@${r.opts.replyTo.nick}`\r\n  $nick.onclick = () => {\r\n    r.comment.getActions().goToReplyComment()\r\n  }\r\n\r\n  // Comment content\r\n  let replyContent = marked(r.opts.replyTo.content)\r\n  if (r.opts.replyTo.is_collapsed) replyContent = `[${$t('collapsed')}]`\r\n  r.$replyTo.querySelector<HTMLElement>('.atk-content')!.innerHTML = replyContent\r\n\r\n  // Mount the replyTo element\r\n  r.$body.prepend(r.$replyTo)\r\n}\r\n","import * as Utils from '../../lib/utils'\r\nimport type Render from '../render'\r\nimport $t from '@/i18n'\r\n\r\n/**\r\n * 待审核状态界面\r\n */\r\nexport default function renderPending(r: Render) {\r\n  if (!r.data.is_pending) return\r\n\r\n  const pendingEl = Utils.createElement(`<div class=\"atk-pending\">${$t('pendingMsg')}</div>`)\r\n  r.$body.prepend(pendingEl)\r\n}\r\n","import * as Utils from '../lib/utils'\r\nimport $t from '@/i18n'\r\n\r\ninterface ActionBtnOptions {\r\n  /** 按钮文字 (动态/静态) */\r\n  text: (() => string) | string\r\n\r\n  /** 仅管理员可用 */\r\n  adminOnly?: boolean\r\n\r\n  /** 确认操作 */\r\n  confirm?: boolean\r\n\r\n  /** 确认时提示文字 */\r\n  confirmText?: string\r\n}\r\n\r\n/**\r\n * 通用操作按钮\r\n */\r\nexport default class ActionBtn {\r\n  private opts: ActionBtnOptions\r\n  public $el: HTMLElement\r\n\r\n  public isLoading = false // 正在加载\r\n\r\n  public msgRecTimer?: number // 消息显示复原定时器\r\n  public msgRecTimerFunc?: () => void // 消息显示复原操作\r\n  public get isMessaging() {\r\n    return !!this.msgRecTimer\r\n  } // 消息正在显示\r\n\r\n  public isConfirming = false // 正在确认\r\n  public confirmRecTimer?: number // 确认消息复原定时器\r\n\r\n  /** 构造函数 */\r\n  constructor(opts: ActionBtnOptions | string | (() => string)) {\r\n    this.$el = Utils.createElement(`<span class=\"atk-common-action-btn\"></span>`)\r\n\r\n    this.opts = typeof opts !== 'object' ? { text: opts } : opts\r\n    this.$el.innerText = this.getText()\r\n\r\n    // 仅管理员可操作\r\n    if (this.opts.adminOnly) this.$el.setAttribute('atk-only-admin-show', '')\r\n  }\r\n\r\n  /** 将按钮装载到指定元素 */\r\n  public appendTo(dom: HTMLElement) {\r\n    dom.append(this.$el)\r\n    return this\r\n  }\r\n\r\n  /** 获取按钮文字（动态/静态） */\r\n  private getText() {\r\n    return typeof this.opts.text === 'string' ? this.opts.text : this.opts.text()\r\n  }\r\n\r\n  /** 设置点击事件 */\r\n  public setClick(func: () => void) {\r\n    this.$el.onclick = (e) => {\r\n      e.stopPropagation() // 防止穿透\r\n\r\n      // 按钮处于加载状态，禁止点击\r\n      if (this.isLoading) {\r\n        return\r\n      }\r\n\r\n      // 操作确认\r\n      if (this.opts.confirm && !this.isMessaging) {\r\n        const confirmRestore = () => {\r\n          this.isConfirming = false\r\n          this.$el.classList.remove('atk-btn-confirm')\r\n          this.$el.innerText = this.getText()\r\n        }\r\n\r\n        if (!this.isConfirming) {\r\n          this.isConfirming = true\r\n          this.$el.classList.add('atk-btn-confirm')\r\n          this.$el.innerText = this.opts.confirmText || $t('actionConfirm')\r\n          this.confirmRecTimer = window.setTimeout(() => confirmRestore(), 5000)\r\n          return\r\n        }\r\n\r\n        if (this.confirmRecTimer) window.clearTimeout(this.confirmRecTimer)\r\n        confirmRestore()\r\n      }\r\n\r\n      // 立刻释放掉原有的定时器（当显示消息后，用户立刻点击时）\r\n      if (this.msgRecTimer) {\r\n        this.fireMsgRecTimer()\r\n        this.clearMsgRecTimer()\r\n        return\r\n      }\r\n\r\n      // 触发设定的点击事件\r\n      func()\r\n    }\r\n  }\r\n\r\n  /** 文字刷新（动态/静态） */\r\n  public updateText(text?: (() => string) | string) {\r\n    if (text) this.opts.text = text\r\n    this.setLoading(false)\r\n    this.$el.innerText = this.getText()\r\n  }\r\n\r\n  /** 设置加载状态 */\r\n  public setLoading(value: boolean, loadingText?: string) {\r\n    if (this.isLoading === value) return\r\n    this.isLoading = value\r\n    if (value) {\r\n      this.$el.classList.add('atk-btn-loading')\r\n      this.$el.innerText = loadingText || `${$t('loading')}...`\r\n    } else {\r\n      this.$el.classList.remove('atk-btn-loading')\r\n      this.$el.innerText = this.getText()\r\n    }\r\n  }\r\n\r\n  /** 错误消息 */\r\n  public setError(text: string) {\r\n    this.setMsg(text, 'atk-btn-error')\r\n  }\r\n\r\n  /** 警告消息 */\r\n  public setWarn(text: string) {\r\n    this.setMsg(text, 'atk-btn-warn')\r\n  }\r\n\r\n  /** 成功消息 */\r\n  public setSuccess(text: string) {\r\n    this.setMsg(text, 'atk-btn-success')\r\n  }\r\n\r\n  /** 设置消息 */\r\n  public setMsg(text: string, className?: string, duringTime?: number, after?: () => void) {\r\n    this.setLoading(false)\r\n    if (className) this.$el.classList.add(className)\r\n    this.$el.innerText = text\r\n\r\n    // 设定复原 timer\r\n    this.setMsgRecTimer(() => {\r\n      this.$el.innerText = this.getText()\r\n      if (className) this.$el.classList.remove(className)\r\n      if (after) after()\r\n    }, duringTime || 2500) // 消息默认显示持续 2500s\r\n  }\r\n\r\n  /** 设置消息复原操作定时器 */\r\n  private setMsgRecTimer(func: () => void, duringTime: number) {\r\n    this.fireMsgRecTimer()\r\n    this.clearMsgRecTimer()\r\n\r\n    this.msgRecTimerFunc = func\r\n    this.msgRecTimer = window.setTimeout(() => {\r\n      func()\r\n      this.clearMsgRecTimer()\r\n    }, duringTime)\r\n  }\r\n\r\n  /** 立刻触发器复原定时器 */\r\n  private fireMsgRecTimer() {\r\n    if (this.msgRecTimerFunc) this.msgRecTimerFunc()\r\n  }\r\n\r\n  /** 仅清除 timer */\r\n  private clearMsgRecTimer() {\r\n    if (this.msgRecTimer) window.clearTimeout(this.msgRecTimer)\r\n    this.msgRecTimer = undefined\r\n    this.msgRecTimerFunc = undefined\r\n  }\r\n}\r\n","import * as Utils from '../../lib/utils'\r\nimport ActionBtn from '../../components/action-btn'\r\nimport type Render from '../render'\r\nimport $t from '@/i18n'\r\n\r\n/**\r\n * 评论操作按钮界面\r\n */\r\nexport default function renderActions(r: Render) {\r\n  Object.entries({\r\n    renderVote,\r\n    renderReply,\r\n    // 管理员操作\r\n    // renderCollapse,\r\n    // renderModerator,\r\n    // renderPin,\r\n    // renderEdit,\r\n    // renderDel,\r\n  }).forEach(([name, render]) => {\r\n    render(r)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 投票\r\nfunction renderVote(r: Render) {\r\n  if (!r.opts.vote) return // 关闭投票功能\r\n\r\n  // 赞同按钮\r\n  r.voteBtnUp = new ActionBtn(() => `${$t('voteUp')} (${r.data.vote_up || 0})`).appendTo(r.$actions)\r\n  r.voteBtnUp.setClick(() => {\r\n    r.comment.getActions().vote('up')\r\n  })\r\n\r\n  // 反对按钮\r\n  if (r.opts.voteDown) {\r\n    r.voteBtnDown = new ActionBtn(() => `${$t('voteDown')} (${r.data.vote_down || 0})`).appendTo(\r\n      r.$actions,\r\n    )\r\n    r.voteBtnDown.setClick(() => {\r\n      r.comment.getActions().vote('down')\r\n    })\r\n  }\r\n}\r\n\r\n// 操作按钮 - 回复\r\nfunction renderReply(r: Render) {\r\n  if (!r.data.is_allow_reply) return // 不允许回复\r\n\r\n  const replyBtn = Utils.createElement(`<span>${$t('reply')}</span>`)\r\n  r.$actions.append(replyBtn)\r\n  replyBtn.addEventListener('click', (e) => {\r\n    e.stopPropagation() // 防止穿透\r\n    r.opts.replyComment(r.data, r.$el)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 折叠\r\nfunction renderCollapse(r: Render) {\r\n  const collapseBtn = new ActionBtn({\r\n    text: () => (r.data.is_collapsed ? $t('expand') : $t('collapse')),\r\n    adminOnly: true,\r\n  })\r\n  collapseBtn.appendTo(r.$actions)\r\n  collapseBtn.setClick(() => {\r\n    r.comment.getActions().adminEdit('collapsed', collapseBtn)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 审核\r\nfunction renderModerator(r: Render) {\r\n  const pendingBtn = new ActionBtn({\r\n    text: () => (r.data.is_pending ? $t('pending') : $t('approved')),\r\n    adminOnly: true,\r\n  })\r\n  pendingBtn.appendTo(r.$actions)\r\n  pendingBtn.setClick(() => {\r\n    r.comment.getActions().adminEdit('pending', pendingBtn)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 置顶\r\nfunction renderPin(r: Render) {\r\n  const pinnedBtn = new ActionBtn({\r\n    text: () => (r.data.is_pinned ? $t('unpin') : $t('pin')),\r\n    adminOnly: true,\r\n  })\r\n  pinnedBtn.appendTo(r.$actions)\r\n  pinnedBtn.setClick(() => {\r\n    r.comment.getActions().adminEdit('pinned', pinnedBtn)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 编辑\r\nfunction renderEdit(r: Render) {\r\n  const editBtn = new ActionBtn({\r\n    text: $t('edit'),\r\n    adminOnly: true,\r\n  })\r\n  editBtn.appendTo(r.$actions)\r\n  editBtn.setClick(() => {\r\n    r.opts.editComment(r.data, r.$el)\r\n  })\r\n}\r\n\r\n// 操作按钮 - 删除\r\nfunction renderDel(r: Render) {\r\n  const delBtn = new ActionBtn({\r\n    text: $t('delete'),\r\n    confirm: true,\r\n    confirmText: $t('deleteConfirm'),\r\n    adminOnly: true,\r\n  })\r\n  delBtn.appendTo(r.$actions)\r\n  delBtn.setClick(() => {\r\n    r.comment.getActions().adminDelete(delBtn)\r\n  })\r\n}\r\n","import type Render from '../render'\r\nimport Avatar from './avatar'\r\nimport Header from './header'\r\nimport Content from './content'\r\nimport ReplyAt from './reply-at'\r\nimport ReplyTo from './reply-to'\r\nimport Pending from './pending'\r\nimport Actions from './actions'\r\n\r\nconst Renders = {\r\n  Avatar,\r\n  Header,\r\n  Content,\r\n  ReplyAt,\r\n  ReplyTo,\r\n  Pending,\r\n  Actions,\r\n}\r\n\r\nexport default function loadRenders(r: Render) {\r\n  Object.entries(Renders).forEach(([name, render]) => {\r\n    render(r)\r\n  })\r\n}\r\n","import ActionBtn from '../components/action-btn'\r\nimport * as Utils from '../lib/utils'\r\nimport * as Ui from '../lib/ui'\r\n\r\nimport * as HeightLimit from './height-limit'\r\nimport CommentHTML from './comment.html?raw'\r\nimport loadRenders from './renders'\r\nimport type { CommentNode } from '.'\r\n\r\nexport default class Render {\r\n  public comment: CommentNode\r\n\r\n  public get data() {\r\n    return this.comment.getData()\r\n  }\r\n  public get opts() {\r\n    return this.comment.getOpts()\r\n  }\r\n\r\n  public $el!: HTMLElement\r\n  public $main!: HTMLElement\r\n  public $header!: HTMLElement\r\n  public $headerNick!: HTMLElement\r\n  public $headerBadgeWrap!: HTMLElement\r\n  public $body!: HTMLElement\r\n  public $content!: HTMLElement\r\n  public $childrenWrap!: HTMLElement | null\r\n  public $actions!: HTMLElement\r\n  public voteBtnUp?: ActionBtn\r\n  public voteBtnDown?: ActionBtn\r\n\r\n  public $replyTo?: HTMLElement // 回复评论内容 (平铺下显示)\r\n  public $replyAt?: HTMLElement // 回复 AT（层级嵌套下显示）\r\n\r\n  public constructor(comment: CommentNode) {\r\n    this.comment = comment\r\n  }\r\n\r\n  /**\r\n   * Render the comment ui\r\n   *\r\n   * If comment data is updated, call this method to re-render the comment ui.\r\n   * The method will be called multiple times, so it should be idempotent.\r\n   *\r\n   * Renders may add event listeners to the comment ui, so it should be called only once or override the original.\r\n   * Please be aware of the memory leak caused by the event listener.\r\n   */\r\n  public render() {\r\n    // init ui elements\r\n    this.$el = Utils.createElement(CommentHTML)\r\n\r\n    this.$main = this.$el.querySelector('.atk-main')!\r\n    this.$header = this.$el.querySelector('.atk-header')!\r\n    this.$body = this.$el.querySelector('.atk-body')!\r\n    this.$content = this.$body.querySelector('.atk-content')!\r\n    this.$actions = this.$el.querySelector('.atk-actions')!\r\n\r\n    this.$el.setAttribute('id', `atk-comment-${this.data.id}`)\r\n\r\n    // call all renders\r\n    loadRenders(this)\r\n\r\n    // append children wrap if exists\r\n    if (this.$childrenWrap) {\r\n      this.$main.append(this.$childrenWrap)\r\n    }\r\n\r\n    return this.$el\r\n  }\r\n\r\n  /** 内容限高检测 */\r\n  public checkHeightLimit() {\r\n    const conf = this.opts.heightLimit\r\n    if (!conf || !conf.content || !conf.children) return // 关闭限高\r\n\r\n    const contentMaxH = conf.content\r\n    const childrenMaxH = conf.children\r\n\r\n    HeightLimit.check(\r\n      {\r\n        afterExpandBtnClick: () => {\r\n          // 子评论数仅有 1，直接取消限高\r\n          const children = this.comment.getChildren()\r\n          if (children.length === 1)\r\n            HeightLimit.disposeHeightLimit(children[0].getRender().$content)\r\n        },\r\n        scrollable: conf.scrollable,\r\n      },\r\n      [\r\n        // 评论内容限高\r\n        { el: this.$content, max: contentMaxH, imgCheck: true },\r\n        { el: this.$replyTo, max: contentMaxH, imgCheck: true },\r\n        // 子评论区域限高（仅嵌套模式）\r\n        { el: this.$childrenWrap, max: childrenMaxH, imgCheck: false },\r\n      ],\r\n    )\r\n  }\r\n\r\n  /** 子评论区域移除限高 */\r\n  public heightLimitRemoveForChildren() {\r\n    if (!this.$childrenWrap) return\r\n    HeightLimit.disposeHeightLimit(this.$childrenWrap)\r\n  }\r\n\r\n  /** 渐出动画 */\r\n  playFadeAnim() {\r\n    Ui.playFadeInAnim(this.comment.getRender().$el)\r\n  }\r\n\r\n  /** 渐出动画 · 评论内容区域 */\r\n  playFadeAnimForBody() {\r\n    Ui.playFadeInAnim(this.comment.getRender().$body)\r\n  }\r\n\r\n  /** Perform the flash animation */\r\n  playFlashAnim() {\r\n    // Make sure the class is removed\r\n    this.$el.classList.remove('atk-flash-once')\r\n    window.setTimeout(() => {\r\n      // Add the class to perform the animation\r\n      this.$el.classList.add('atk-flash-once')\r\n    }, 150)\r\n  }\r\n\r\n  /** 获取子评论 Wrap */\r\n  public getChildrenWrap() {\r\n    if (!this.$childrenWrap) {\r\n      // if not exists, create a new one\r\n      this.$childrenWrap = Utils.createElement('<div class=\"atk-comment-children\"></div>')\r\n      this.$main.append(this.$childrenWrap)\r\n    }\r\n    return this.$childrenWrap\r\n  }\r\n\r\n  /** 设置已读 */\r\n  public setUnread(val: boolean) {\r\n    if (val) this.$el.classList.add('atk-unread')\r\n    else this.$el.classList.remove('atk-unread')\r\n  }\r\n\r\n  /** 设置为可点击的评论 */\r\n  public setOpenable(val: boolean) {\r\n    if (val) this.$el.classList.add('atk-openable')\r\n    else this.$el.classList.remove('atk-openable')\r\n  }\r\n\r\n  /** 设置点击评论打开置顶 URL */\r\n  public setOpenURL(url: string) {\r\n    this.setOpenable(true)\r\n    this.$el.onclick = (evt) => {\r\n      evt.stopPropagation()\r\n      window.open(url)\r\n    }\r\n  }\r\n\r\n  /** 设置点击评论时的操作 */\r\n  public setOpenAction(action: () => void) {\r\n    this.setOpenable(true)\r\n    this.$el.onclick = (evt) => {\r\n      evt.stopPropagation()\r\n      action()\r\n    }\r\n  }\r\n}\r\n","import type { CommentNode } from '.'\r\nimport ActionBtn from '@/components/action-btn'\r\nimport $t from '@/i18n'\r\n\r\nexport default class CommentActions {\r\n  private comment: CommentNode\r\n\r\n  private get data() {\r\n    return this.comment.getData()\r\n  }\r\n  private get opts() {\r\n    return this.comment.getOpts()\r\n  }\r\n  private getApi() {\r\n    return this.comment.getOpts().getApi()\r\n  }\r\n\r\n  public constructor(comment: CommentNode) {\r\n    this.comment = comment\r\n  }\r\n\r\n  /** 投票操作 */\r\n  public vote(type: 'up' | 'down') {\r\n    const actionBtn =\r\n      type === 'up' ? this.comment.getRender().voteBtnUp : this.comment.getRender().voteBtnDown\r\n\r\n    this.getApi()\r\n      .votes.vote(`comment_${type}`, this.data.id, {\r\n        ...this.getApi().getUserFields(),\r\n      })\r\n      .then((res) => {\r\n        this.data.vote_up = res.data.up\r\n        this.data.vote_down = res.data.down\r\n        this.comment.getRender().voteBtnUp?.updateText()\r\n        this.comment.getRender().voteBtnDown?.updateText()\r\n      })\r\n      .catch((err) => {\r\n        actionBtn?.setError($t('voteFail'))\r\n        console.error(err)\r\n      })\r\n  }\r\n\r\n  /** 管理员 - 评论状态修改 */\r\n  public adminEdit(type: 'collapsed' | 'pending' | 'pinned', btnElem: ActionBtn) {\r\n    if (btnElem.isLoading) return // 若正在修改中\r\n\r\n    btnElem.setLoading(true, `${$t('editing')}...`)\r\n\r\n    // 克隆并修改当前数据\r\n    const modify = { ...this.data }\r\n    if (type === 'collapsed') {\r\n      modify.is_collapsed = !modify.is_collapsed\r\n    } else if (type === 'pending') {\r\n      modify.is_pending = !modify.is_pending\r\n    } else if (type === 'pinned') {\r\n      modify.is_pinned = !modify.is_pinned\r\n    }\r\n\r\n    this.getApi()\r\n      .comments.updateComment(this.data.id, {\r\n        ...modify,\r\n      })\r\n      .then((res) => {\r\n        btnElem.setLoading(false)\r\n\r\n        // 刷新当前 Comment UI\r\n        this.comment.setData(res.data)\r\n      })\r\n      .catch((err) => {\r\n        console.error(err)\r\n        btnElem.setError($t('editFail'))\r\n      })\r\n  }\r\n\r\n  /** 管理员 - 评论删除 */\r\n  public adminDelete(btnElem: ActionBtn) {\r\n    if (btnElem.isLoading) return // 若正在删除中\r\n\r\n    btnElem.setLoading(true, `${$t('deleting')}...`)\r\n    this.getApi()\r\n      .comments.deleteComment(this.data.id)\r\n      .then(() => {\r\n        btnElem.setLoading(false)\r\n        if (this.opts.onDelete) this.opts.onDelete(this.comment)\r\n      })\r\n      .catch((e) => {\r\n        console.error(e)\r\n        btnElem.setError($t('deleteFail'))\r\n      })\r\n  }\r\n\r\n  /** 快速跳转到该评论 */\r\n  public goToReplyComment() {\r\n    const origHash = window.location.hash\r\n    const modifyHash = `#atk-comment-${this.data.rid}`\r\n\r\n    window.location.hash = modifyHash\r\n    if (modifyHash === origHash) window.dispatchEvent(new Event('hashchange')) // 强制触发事件\r\n  }\r\n}\r\n","import type { Api } from '../api'\r\nimport * as Ui from '../lib/ui'\r\nimport * as Utils from '../lib/utils'\r\nimport marked from '../lib/marked'\r\nimport UADetect from '../lib/detect'\r\nimport CommentUI from './render'\r\nimport CommentActions from './actions'\r\nimport $t from '@/i18n'\r\nimport type { CommentData, ArtalkConfig, ContextApi } from '@/types'\r\n\r\nexport interface CommentOptions {\r\n  // Hooks\r\n  onAfterRender?: () => void\r\n  onDelete?: (c: CommentNode) => void\r\n\r\n  /** The comment being replied to (linked comment) */\r\n  replyTo?: CommentData\r\n\r\n  // Referenced from ArtalkConfig\r\n  flatMode: boolean\r\n  vote: boolean\r\n  voteDown: boolean\r\n  uaBadge: boolean\r\n  nestMax: number\r\n  gravatar: ArtalkConfig['gravatar']\r\n  heightLimit: ArtalkConfig['heightLimit']\r\n  avatarURLBuilder: ArtalkConfig['avatarURLBuilder']\r\n  scrollRelativeTo: ArtalkConfig['scrollRelativeTo']\r\n\r\n  // TODO: Move to plugin folder and remove from core\r\n  getApi: () => Api\r\n  replyComment: ContextApi['replyComment']\r\n  editComment: ContextApi['editComment']\r\n}\r\n\r\nexport default class CommentNode {\r\n  $el?: HTMLElement\r\n\r\n  private renderInstance: CommentUI\r\n  private actionInstance: CommentActions\r\n\r\n  private data: CommentData\r\n  private opts: CommentOptions\r\n\r\n  private parent: CommentNode | null\r\n  private children: CommentNode[] = []\r\n\r\n  private nestCurt: number // 当前嵌套层数\r\n\r\n  constructor(data: CommentData, opts: CommentOptions) {\r\n    this.opts = opts\r\n    this.data = { ...data }\r\n    this.data.date = this.data.date.replace(/-/g, '/') // 解决 Safari 日期解析 NaN 问题\r\n\r\n    this.parent = null\r\n    this.nestCurt = 1 // 现在已嵌套 n 层\r\n\r\n    this.actionInstance = new CommentActions(this)\r\n    this.renderInstance = new CommentUI(this)\r\n  }\r\n\r\n  /** 渲染 UI */\r\n  public render() {\r\n    const newEl = this.renderInstance.render()\r\n\r\n    if (this.$el) this.$el.replaceWith(newEl)\r\n    this.$el = newEl\r\n    // Please be aware of the memory leak, the $el may be replaced multiple times.\r\n    // If somewhere else has a reference to the old $el, it will cause a memory leak.\r\n    // So it's limited to use the $el reference by `getEl()`.\r\n    // The `getEl()` will always return the latest $el.\r\n\r\n    if (this.opts.onAfterRender) this.opts.onAfterRender()\r\n  }\r\n\r\n  /** 获取评论操作实例对象 */\r\n  public getActions() {\r\n    return this.actionInstance\r\n  }\r\n\r\n  /** 获取评论渲染器实例对象 */\r\n  public getRender() {\r\n    return this.renderInstance\r\n  }\r\n\r\n  /** 获取评论数据 */\r\n  public getData() {\r\n    return this.data\r\n  }\r\n\r\n  /** 设置数据 */\r\n  public setData(data: CommentData) {\r\n    this.data = data\r\n\r\n    this.render()\r\n    this.getRender().playFadeAnimForBody()\r\n  }\r\n\r\n  /** 获取父评论 */\r\n  public getParent() {\r\n    return this.parent\r\n  }\r\n\r\n  /** 获取所有子评论 */\r\n  public getChildren() {\r\n    return this.children\r\n  }\r\n\r\n  /** 获取当前嵌套层数 */\r\n  public getNestCurt() {\r\n    return this.nestCurt\r\n  }\r\n\r\n  /** 判断是否为根评论 */\r\n  public getIsRoot() {\r\n    return this.data.rid === 0\r\n  }\r\n\r\n  /** 获取评论 ID */\r\n  public getID() {\r\n    return this.data.id\r\n  }\r\n\r\n  /** 置入子评论 */\r\n  public putChild(childNode: CommentNode, insertMode: 'append' | 'prepend' = 'append') {\r\n    childNode.parent = this\r\n    childNode.nestCurt = this.nestCurt + 1 // 嵌套层数 +1\r\n    this.children.push(childNode)\r\n\r\n    const $childrenWrap = this.getChildrenWrapEl()\r\n    const $childComment = childNode.getEl()\r\n    if (insertMode === 'append') $childrenWrap.append($childComment)\r\n    else if (insertMode === 'prepend') $childrenWrap.prepend($childComment)\r\n\r\n    childNode.getRender().playFadeAnim()\r\n    childNode.getRender().checkHeightLimit() // 内容限高\r\n  }\r\n\r\n  /** 获取存放子评论的元素对象 */\r\n  public getChildrenWrapEl(): HTMLElement {\r\n    // console.log(this.nestCurt)\r\n    if (this.nestCurt >= this.opts.nestMax) {\r\n      return this.parent!.getChildrenWrapEl()\r\n    }\r\n    return this.getRender().getChildrenWrap()\r\n  }\r\n\r\n  /** 获取所有父评论 */\r\n  public getParents() {\r\n    const flattenParents: CommentNode[] = []\r\n    let parent = this.parent\r\n    while (parent) {\r\n      flattenParents.push(parent)\r\n      parent = parent.getParent()\r\n    }\r\n    return flattenParents\r\n  }\r\n\r\n  /**\r\n   * Get the element of the comment\r\n   *\r\n   * The `getEl()` will always return the latest $el after calling `render()`.\r\n   * Please be aware of the memory leak if you use the $el reference directly.\r\n   */\r\n  public getEl() {\r\n    if (!this.$el) throw new Error('comment element not initialized before `getEl()`')\r\n    return this.$el\r\n  }\r\n\r\n  /**\r\n   * Focus on the comment\r\n   *\r\n   * Scroll to the comment and perform flash animation\r\n   */\r\n  focus() {\r\n    if (!this.$el) throw new Error('comment element not initialized before `focus()`')\r\n\r\n    // 若父评论存在 “子评论部分” 限高，取消限高\r\n    this.getParents().forEach((p) => {\r\n      p.getRender().heightLimitRemoveForChildren()\r\n    })\r\n\r\n    // Scroll to comment\r\n    this.scrollIntoView()\r\n\r\n    // Perform flash animation\r\n    this.getRender().playFlashAnim()\r\n  }\r\n\r\n  scrollIntoView() {\r\n    this.$el &&\r\n      Ui.scrollIntoView(this.$el, false, this.opts.scrollRelativeTo && this.opts.scrollRelativeTo())\r\n  }\r\n\r\n  /**\r\n   * Remove the comment node\r\n   */\r\n  remove() {\r\n    this.$el?.remove()\r\n  }\r\n\r\n  /** 获取 Gravatar 头像 URL */\r\n  public getGravatarURL() {\r\n    return Utils.getGravatarURL({\r\n      mirror: this.opts.gravatar.mirror,\r\n      params: this.opts.gravatar.params,\r\n      emailHash: this.data.email_encrypted,\r\n    })\r\n  }\r\n\r\n  /** 获取评论 markdown 解析后的内容 */\r\n  public getContentMarked() {\r\n    return marked(this.data.content)\r\n  }\r\n\r\n  /** 获取格式化后的日期 */\r\n  public getDateFormatted() {\r\n    return Utils.timeAgo(new Date(this.data.date), $t)\r\n  }\r\n\r\n  /** 获取用户 UserAgent 信息 */\r\n  public getUserUA() {\r\n    const info = UADetect(this.data.ua)\r\n    return {\r\n      browser: `${info.browser} ${info.version}`,\r\n      os: `${info.os} ${info.osVersion}`,\r\n    }\r\n  }\r\n\r\n  /** 获取配置 */\r\n  public getOpts() {\r\n    return this.opts\r\n  }\r\n}\r\n","import type { ContextApi, CommentData } from '@/types'\r\nimport { CommentNode } from '@/comment'\r\n\r\ninterface CreateCommentNodeOptions {\r\n  forceFlatMode?: boolean\r\n}\r\n\r\nexport function createCommentNode(\r\n  ctx: ContextApi,\r\n  comment: CommentData,\r\n  replyComment?: CommentData,\r\n  opts?: CreateCommentNodeOptions,\r\n): CommentNode {\r\n  const instance = new CommentNode(comment, {\r\n    onAfterRender: () => {\r\n      ctx.trigger('comment-rendered', instance)\r\n    },\r\n    onDelete: (c: CommentNode) => {\r\n      ctx.getData().deleteComment(c.getID())\r\n    },\r\n\r\n    replyTo: replyComment,\r\n\r\n    // TODO simplify reference\r\n    flatMode:\r\n      typeof opts?.forceFlatMode === 'boolean'\r\n        ? opts?.forceFlatMode\r\n        : (ctx.conf.flatMode as boolean),\r\n    gravatar: ctx.conf.gravatar,\r\n    nestMax: ctx.conf.nestMax,\r\n    heightLimit: ctx.conf.heightLimit,\r\n    avatarURLBuilder: ctx.conf.avatarURLBuilder,\r\n    scrollRelativeTo: ctx.conf.scrollRelativeTo,\r\n    vote: ctx.conf.vote,\r\n    voteDown: ctx.conf.voteDown,\r\n    uaBadge: ctx.conf.uaBadge,\r\n\r\n    // TODO: move to plugin folder and remove from core\r\n    getApi: () => ctx.getApi(),\r\n    replyComment: (c, $el) => ctx.replyComment(c, $el),\r\n    editComment: (c, $el) => ctx.editComment(c, $el),\r\n  })\r\n\r\n  // 渲染元素\r\n  instance.render()\r\n\r\n  return instance\r\n}\r\n","import * as Utils from '../lib/utils'\r\n\r\nexport interface ReadMoreBtnOptions {\r\n  /** 回调函数 */\r\n  onClick: (offset: number) => void\r\n\r\n  pageSize: number\r\n\r\n  text?: string\r\n}\r\n\r\n/**\r\n * 阅读更多按钮\r\n */\r\nexport default class ReadMoreBtn {\r\n  public opts: ReadMoreBtnOptions\r\n  public $el: HTMLElement\r\n  private $loading: HTMLElement\r\n  private $text: HTMLElement\r\n  private offset: number = 0\r\n  private total: number = 0\r\n  private origText: string = 'Load More'\r\n\r\n  /** 是否有更多内容 */\r\n  get hasMore() {\r\n    return this.total > this.offset + this.opts.pageSize\r\n  }\r\n\r\n  public constructor(opts: ReadMoreBtnOptions) {\r\n    this.opts = opts\r\n    this.origText = this.opts.text || this.origText\r\n\r\n    this.$el = Utils.createElement(\r\n      `<div class=\"atk-list-read-more\" style=\"display: none;\">\r\n      <div class=\"atk-list-read-more-inner\">\r\n        <div class=\"atk-loading-icon\" style=\"display: none;\"></div>\r\n        <span class=\"atk-text\">${this.origText}</span>\r\n      </div>\r\n    </div>`,\r\n    )\r\n\r\n    this.$loading = this.$el.querySelector<HTMLElement>('.atk-loading-icon')!\r\n    this.$text = this.$el.querySelector<HTMLElement>('.atk-text')!\r\n\r\n    this.$el.onclick = () => {\r\n      this.click()\r\n    }\r\n  }\r\n\r\n  click() {\r\n    if (this.hasMore) this.opts.onClick(this.offset + this.opts.pageSize)\r\n    this.checkDisabled()\r\n  }\r\n\r\n  /** 显示 */\r\n  show() {\r\n    this.$el.style.display = ''\r\n  }\r\n\r\n  /** 隐藏 */\r\n  hide() {\r\n    this.$el.style.display = 'none'\r\n  }\r\n\r\n  /** 加载 */\r\n  setLoading(isLoading: boolean) {\r\n    this.$loading.style.display = isLoading ? '' : 'none'\r\n    this.$text.style.display = isLoading ? 'none' : ''\r\n  }\r\n\r\n  /** 错误提示 */\r\n  showErr(errMsg: string) {\r\n    this.setLoading(false)\r\n\r\n    this.$text.innerText = errMsg\r\n    this.$el.classList.add('atk-err')\r\n    window.setTimeout(() => {\r\n      this.$text.innerText = this.origText\r\n      this.$el.classList.remove('atk-err')\r\n    }, 2000) // 2s后错误提示复原\r\n  }\r\n\r\n  /** 更新数据 */\r\n  public update(offset: number, total: number) {\r\n    this.offset = offset\r\n    this.total = total\r\n\r\n    this.checkDisabled()\r\n  }\r\n\r\n  public checkDisabled() {\r\n    if (this.hasMore) this.show()\r\n    else this.hide()\r\n  }\r\n}\r\n","import type { Paginator, IPgHolderOpt } from '.'\r\nimport type { ListFetchParams } from '@/types'\r\nimport ReadMoreBtn from '@/components/read-more-btn'\r\nimport $t from '@/i18n'\r\n\r\n/**\r\n * 阅读更多形式的分页\r\n */\r\nexport default class ReadMorePaginator implements Paginator {\r\n  private instance!: ReadMoreBtn\r\n  private onReachedBottom: (() => void) | null = null\r\n  private opt!: IPgHolderOpt\r\n\r\n  create(opt: IPgHolderOpt) {\r\n    this.opt = opt\r\n\r\n    this.instance = new ReadMoreBtn({\r\n      pageSize: opt.pageSize,\r\n      onClick: async (o) => {\r\n        opt.ctx.fetch({\r\n          offset: o,\r\n        })\r\n      },\r\n      text: $t('loadMore'),\r\n    })\r\n\r\n    // 滚动到底部自动加载\r\n    if (opt.readMoreAutoLoad) {\r\n      this.onReachedBottom = () => {\r\n        if (!this.instance.hasMore || this.opt.ctx.getData().getLoading()) return\r\n        this.instance.click()\r\n      }\r\n      this.opt.ctx.on('list-reach-bottom', this.onReachedBottom)\r\n    }\r\n\r\n    return this.instance.$el\r\n  }\r\n\r\n  setLoading(val: boolean) {\r\n    this.instance.setLoading(val)\r\n  }\r\n\r\n  update(offset: number, total: number) {\r\n    this.instance.update(offset, total)\r\n  }\r\n\r\n  showErr(msg: string) {\r\n    this.instance.showErr(msg)\r\n  }\r\n\r\n  next() {\r\n    this.instance.click()\r\n  }\r\n\r\n  getHasMore(): boolean {\r\n    return this.instance.hasMore\r\n  }\r\n\r\n  getIsClearComments(params: { offset?: number }): boolean {\r\n    return params.offset === 0\r\n  }\r\n\r\n  dispose(): void {\r\n    this.onReachedBottom && this.opt.ctx.off('list-reach-bottom', this.onReachedBottom)\r\n    this.instance.$el.remove()\r\n  }\r\n}\r\n","import * as Utils from '../lib/utils'\r\nimport * as Ui from '../lib/ui'\r\n\r\nexport interface PaginationOptions {\r\n  /** 每页条数 */\r\n  pageSize: number\r\n\r\n  /** 回调函数 */\r\n  onChange: (offset: number) => void\r\n}\r\n\r\nexport default class Pagination {\r\n  private opts: PaginationOptions\r\n  public total: number\r\n  public $el: HTMLElement\r\n  public $input: HTMLInputElement\r\n  public inputTimer?: number\r\n  public $prevBtn: HTMLElement\r\n  public $nextBtn: HTMLElement\r\n\r\n  public page: number = 1\r\n  get pageSize(): number {\r\n    return this.opts.pageSize\r\n  }\r\n  get offset(): number {\r\n    return this.pageSize * (this.page - 1)\r\n  }\r\n  get maxPage(): number {\r\n    return Math.ceil(this.total / this.pageSize)\r\n  }\r\n\r\n  public constructor(total: number, opts: PaginationOptions) {\r\n    this.total = total\r\n    this.opts = opts\r\n\r\n    this.$el = Utils.createElement(\r\n      `<div class=\"atk-pagination-wrap\">\r\n        <div class=\"atk-pagination\">\r\n          <div class=\"atk-btn atk-btn-prev\" aria-label=\"Previous page\">\r\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M217.9 256L345 129c9.4-9.4 9.4-24.6 0-33.9-9.4-9.4-24.6-9.3-34 0L167 239c-9.1 9.1-9.3 23.7-.7 33.1L310.9 417c4.7 4.7 10.9 7 17 7s12.3-2.3 17-7c9.4-9.4 9.4-24.6 0-33.9L217.9 256z\"></path></svg>\r\n          </div>\r\n          <input type=\"text\" class=\"atk-input\" aria-label=\"Enter the number of page\" />\r\n          <div class=\"atk-btn atk-btn-next\" aria-label=\"Next page\">\r\n            <svg stroke=\"currentColor\" fill=\"currentColor\" stroke-width=\"0\" viewBox=\"0 0 512 512\" height=\"14px\" width=\"14px\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M294.1 256L167 129c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.3 34 0L345 239c9.1 9.1 9.3 23.7.7 33.1L201.1 417c-4.7 4.7-10.9 7-17 7s-12.3-2.3-17-7c-9.4-9.4-9.4-24.6 0-33.9l127-127.1z\"></path></svg>\r\n          </div>\r\n        </div>\r\n      </div>`,\r\n    )\r\n    this.$input = this.$el.querySelector('.atk-input')!\r\n    this.$input.value = `${this.page}`\r\n\r\n    this.$input.oninput = () => this.input()\r\n    this.$input.onkeydown = (e) => this.keydown(e)\r\n\r\n    this.$prevBtn = this.$el.querySelector('.atk-btn-prev')!\r\n    this.$nextBtn = this.$el.querySelector('.atk-btn-next')!\r\n\r\n    this.$prevBtn.onclick = () => this.prev()\r\n    this.$nextBtn.onclick = () => this.next()\r\n\r\n    this.checkDisabled()\r\n  }\r\n\r\n  public update(offset: number, total: number) {\r\n    this.page = Math.ceil(offset / this.pageSize) + 1\r\n    this.total = total\r\n\r\n    this.setInput(this.page)\r\n    this.checkDisabled()\r\n  }\r\n\r\n  public setInput(page: number) {\r\n    this.$input.value = `${page}`\r\n  }\r\n\r\n  public input(now: boolean = false) {\r\n    window.clearTimeout(this.inputTimer)\r\n\r\n    const value = this.$input.value.trim()\r\n\r\n    const modify = () => {\r\n      if (value === '') {\r\n        this.setInput(this.page)\r\n        return\r\n      }\r\n      let page = Number(value)\r\n      if (Number.isNaN(page)) {\r\n        this.setInput(this.page)\r\n        return\r\n      }\r\n      if (page < 1) {\r\n        this.setInput(this.page)\r\n        return\r\n      }\r\n      if (page > this.maxPage) {\r\n        this.setInput(this.maxPage)\r\n        page = this.maxPage\r\n      }\r\n      this.change(page)\r\n    }\r\n\r\n    // 延迟 800ms 执行\r\n    if (!now) this.inputTimer = window.setTimeout(() => modify(), 800)\r\n    else modify()\r\n  }\r\n\r\n  public prev() {\r\n    const page = this.page - 1\r\n    if (page < 1) {\r\n      return\r\n    }\r\n    this.change(page)\r\n  }\r\n\r\n  public next() {\r\n    const page = this.page + 1\r\n    if (page > this.maxPage) {\r\n      return\r\n    }\r\n    this.change(page)\r\n  }\r\n\r\n  public getHasMore() {\r\n    return this.page + 1 <= this.maxPage\r\n  }\r\n\r\n  public change(page: number) {\r\n    this.page = page\r\n    this.opts.onChange(this.offset)\r\n    this.setInput(page)\r\n    this.checkDisabled()\r\n  }\r\n\r\n  public checkDisabled() {\r\n    if (this.page + 1 > this.maxPage) {\r\n      this.$nextBtn.classList.add('atk-disabled')\r\n    } else {\r\n      this.$nextBtn.classList.remove('atk-disabled')\r\n    }\r\n\r\n    if (this.page - 1 < 1) {\r\n      this.$prevBtn.classList.add('atk-disabled')\r\n    } else {\r\n      this.$prevBtn.classList.remove('atk-disabled')\r\n    }\r\n  }\r\n\r\n  public keydown(e: KeyboardEvent) {\r\n    const keyCode = e.keyCode || e.which\r\n\r\n    if (keyCode === 38) {\r\n      // 上键\r\n      const page = Number(this.$input.value) + 1\r\n      if (page > this.maxPage) {\r\n        return\r\n      }\r\n      this.setInput(page)\r\n      this.input()\r\n    } else if (keyCode === 40) {\r\n      // 下键\r\n      const page = Number(this.$input.value) - 1\r\n      if (page < 1) {\r\n        return\r\n      }\r\n      this.setInput(page)\r\n      this.input()\r\n    } else if (keyCode === 13) {\r\n      // 回车\r\n      this.input(true)\r\n    }\r\n  }\r\n\r\n  /** 加载 */\r\n  setLoading(isLoading: boolean) {\r\n    if (isLoading) Ui.showLoading(this.$el)\r\n    else Ui.hideLoading(this.$el)\r\n  }\r\n}\r\n","import type { Paginator, IPgHolderOpt } from '.'\r\nimport PaginationComponent from '@/components/pagination'\r\n\r\n/**\r\n * 翻页形式的分页\r\n */\r\nexport default class UpDownPaginator implements Paginator {\r\n  private instance!: PaginationComponent\r\n\r\n  create(opt: IPgHolderOpt) {\r\n    this.instance = new PaginationComponent(opt.total, {\r\n      pageSize: opt.pageSize,\r\n      onChange: async (o) => {\r\n        opt.ctx.editorResetState() // 防止评论框被吞\r\n\r\n        opt.ctx.fetch({\r\n          offset: o,\r\n          onSuccess: () => {\r\n            opt.ctx.listGotoFirst()\r\n          },\r\n        })\r\n      },\r\n    })\r\n\r\n    return this.instance.$el\r\n  }\r\n\r\n  setLoading(val: boolean) {\r\n    this.instance.setLoading(val)\r\n  }\r\n\r\n  update(offset: number, total: number) {\r\n    this.instance.update(offset, total)\r\n  }\r\n\r\n  next() {\r\n    this.instance.next()\r\n  }\r\n\r\n  getHasMore(): boolean {\r\n    return this.instance.getHasMore()\r\n  }\r\n\r\n  getIsClearComments(): boolean {\r\n    return true\r\n  }\r\n\r\n  dispose(): void {\r\n    this.instance.$el.remove()\r\n  }\r\n}\r\n","import { Paginator } from './paginator'\r\nimport ReadMorePaginator from './paginator/read-more'\r\nimport UpDownPaginator from './paginator/up-down'\r\nimport $t from '@/i18n'\r\nimport type { ArtalkConfig, ContextApi } from '@/types'\r\n\r\nfunction createPaginatorByConf(conf: Pick<ArtalkConfig, 'pagination'>): Paginator {\r\n  if (conf.pagination.readMore) return new ReadMorePaginator()\r\n  return new UpDownPaginator()\r\n}\r\n\r\nfunction getPageDataByLastData(ctx: ContextApi): {\r\n  offset: number\r\n  total: number\r\n} {\r\n  const last = ctx.getData().getListLastFetch()\r\n  const r = { offset: 0, total: 0 }\r\n  if (!last) return r\r\n\r\n  r.offset = last.params.offset\r\n  if (last.data) r.total = last.params.flatMode ? last.data.count : last.data.roots_count\r\n\r\n  return r\r\n}\r\n\r\nexport const initListPaginatorFunc = (ctx: ContextApi) => {\r\n  let paginator: Paginator | null = null\r\n\r\n  // Init paginator when conf loaded\r\n  ctx.watchConf(['pagination', 'locale'], (conf) => {\r\n    const list = ctx.get('list')\r\n\r\n    if (paginator) paginator.dispose() // if had been init, dispose it\r\n\r\n    // create paginator instance\r\n    paginator = createPaginatorByConf(conf)\r\n\r\n    // create paginator dom\r\n    const { offset, total } = getPageDataByLastData(ctx)\r\n    const $paginator = paginator.create({\r\n      ctx,\r\n      pageSize: conf.pagination.pageSize,\r\n      total,\r\n\r\n      readMoreAutoLoad: conf.pagination.autoLoad,\r\n    })\r\n\r\n    // mount paginator dom\r\n    list.$commentsWrap.after($paginator)\r\n\r\n    // update paginator info\r\n    paginator?.update(offset, total)\r\n  })\r\n\r\n  // When list loaded\r\n  ctx.on('list-loaded', (comments) => {\r\n    // update paginator info\r\n    const { offset, total } = getPageDataByLastData(ctx)\r\n    paginator?.update(offset, total)\r\n  })\r\n\r\n  // When list fetch\r\n  ctx.on('list-fetch', (params) => {\r\n    // if clear comments when fetch new page data\r\n    if (ctx.getData().getComments().length > 0 && paginator?.getIsClearComments(params)) {\r\n      ctx.getData().clearComments()\r\n    }\r\n  })\r\n\r\n  // When list error\r\n  ctx.on('list-failed', () => {\r\n    paginator?.showErr?.($t('loadFail'))\r\n  })\r\n\r\n  // loading\r\n  ctx.on('list-fetch', (params) => {\r\n    paginator?.setLoading(true)\r\n  })\r\n  ctx.on('list-fetched', ({ params }) => {\r\n    paginator?.setLoading(false)\r\n  })\r\n}\r\n","import ListHTML from './list.html?raw'\r\nimport { ListLayout } from './layout'\r\nimport { createCommentNode } from './comment'\r\nimport { initListPaginatorFunc } from './page'\r\nimport type { ContextApi } from '@/types'\r\nimport Component from '@/lib/component'\r\nimport * as Utils from '@/lib/utils'\r\nimport { CommentNode } from '@/comment'\r\n\r\nexport default class List extends Component {\r\n  /** 列表评论集区域元素 */\r\n  $commentsWrap!: HTMLElement\r\n  public getCommentsWrapEl() {\r\n    return this.$commentsWrap\r\n  }\r\n\r\n  protected commentNodes: CommentNode[] = []\r\n  getCommentNodes() {\r\n    return this.commentNodes\r\n  }\r\n\r\n  constructor(ctx: ContextApi) {\r\n    super(ctx)\r\n\r\n    // Init base element\r\n    this.$el = Utils.createElement(ListHTML)\r\n    this.$commentsWrap = this.$el.querySelector('.atk-list-comments-wrap')!\r\n\r\n    // Init paginator\r\n    initListPaginatorFunc(ctx)\r\n\r\n    // Bind events\r\n    this.initCrudEvents()\r\n  }\r\n\r\n  getListLayout({ forceFlatMode }: { forceFlatMode?: boolean } = {}) {\r\n    return new ListLayout({\r\n      $commentsWrap: this.$commentsWrap,\r\n      nestSortBy: this.ctx.conf.nestSort,\r\n      nestMax: this.ctx.conf.nestMax,\r\n      flatMode:\r\n        typeof forceFlatMode === 'boolean' ? forceFlatMode : (this.ctx.conf.flatMode as boolean),\r\n      // flatMode must be boolean because it had been handled when Artalk.init\r\n      createCommentNode: (d, r) => {\r\n        const node = createCommentNode(this.ctx, d, r, { forceFlatMode })\r\n        this.commentNodes.push(node) // store node instance\r\n        return node\r\n      },\r\n      findCommentNode: (id) => this.commentNodes.find((c) => c.getID() === id),\r\n    })\r\n  }\r\n\r\n  private initCrudEvents() {\r\n    this.ctx.on('list-load', (comments) => {\r\n      // 导入数据\r\n      this.getListLayout().import(comments)\r\n    })\r\n\r\n    this.ctx.on('list-loaded', (comments) => {\r\n      if (comments.length === 0) {\r\n        this.commentNodes = []\r\n        this.$commentsWrap.innerHTML = ''\r\n      }\r\n    })\r\n\r\n    // When comment insert\r\n    this.ctx.on('comment-inserted', (comment) => {\r\n      const replyComment = comment.rid\r\n        ? this.commentNodes.find((c) => c.getID() === comment.rid)?.getData()\r\n        : undefined\r\n      this.getListLayout().insert(comment, replyComment)\r\n    })\r\n\r\n    // When comment delete\r\n    this.ctx.on('comment-deleted', (comment) => {\r\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\r\n      if (!node) {\r\n        console.error(`comment node id=${comment.id} not found`)\r\n        return\r\n      }\r\n      node.remove()\r\n      this.commentNodes = this.commentNodes.filter((c) => c.getID() !== comment.id)\r\n      // TODO: remove child nodes\r\n    })\r\n\r\n    // When comment update\r\n    this.ctx.on('comment-updated', (comment) => {\r\n      const node = this.commentNodes.find((c) => c.getID() === comment.id)\r\n      node && node.setData(comment)\r\n    })\r\n  }\r\n}\r\n","import * as Ui from '@/lib/ui'\r\n\r\nlet bodyOrgOverflow: string\r\nlet bodyOrgPaddingRight: string\r\n\r\nexport function getScrollbarHelper() {\r\n  return {\r\n    init() {\r\n      bodyOrgOverflow = document.body.style.overflow\r\n      bodyOrgPaddingRight = document.body.style.paddingRight\r\n    },\r\n\r\n    unlock() {\r\n      document.body.style.overflow = bodyOrgOverflow\r\n      document.body.style.paddingRight = bodyOrgPaddingRight\r\n    },\r\n\r\n    lock() {\r\n      document.body.style.overflow = 'hidden'\r\n      const barPaddingRight = parseInt(\r\n        window.getComputedStyle(document.body, null).getPropertyValue('padding-right'),\r\n        10,\r\n      )\r\n      document.body.style.paddingRight = `${Ui.getScrollBarWidth() + barPaddingRight || 0}px`\r\n    },\r\n  }\r\n}\r\n","export interface LayerOptions {\r\n  onShow: () => void\r\n  onHide: () => void\r\n}\r\n\r\nexport class Layer {\r\n  private allowMaskClose = true\r\n  private onAfterHide?: () => void\r\n\r\n  constructor(\r\n    private $el: HTMLElement,\r\n    private opts: LayerOptions,\r\n  ) {}\r\n\r\n  setOnAfterHide(func: () => void) {\r\n    this.onAfterHide = func\r\n  }\r\n\r\n  setAllowMaskClose(allow: boolean) {\r\n    this.allowMaskClose = allow\r\n  }\r\n\r\n  getAllowMaskClose() {\r\n    return this.allowMaskClose\r\n  }\r\n\r\n  getEl() {\r\n    return this.$el\r\n  }\r\n\r\n  show() {\r\n    this.opts.onShow()\r\n    this.$el.style.display = ''\r\n  }\r\n\r\n  async hide() {\r\n    this.opts.onHide()\r\n    this.$el.style.display = 'none'\r\n    this.onAfterHide && this.onAfterHide()\r\n  }\r\n\r\n  async destroy() {\r\n    this.opts.onHide()\r\n    this.$el.remove()\r\n    this.onAfterHide && this.onAfterHide()\r\n  }\r\n}\r\n","import { getScrollbarHelper } from './scrollbar-helper'\r\nimport { Layer } from './layer'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport class LayerWrap {\r\n  private $wrap: HTMLElement\r\n  private $mask: HTMLElement\r\n  private items: Layer[] = []\r\n\r\n  constructor() {\r\n    this.$wrap = Utils.createElement(\r\n      `<div class=\"atk-layer-wrap\" style=\"display: none;\"><div class=\"atk-layer-mask\"></div></div>`,\r\n    )\r\n    this.$mask = this.$wrap.querySelector<HTMLElement>('.atk-layer-mask')!\r\n  }\r\n\r\n  createItem(name: string, el?: HTMLElement) {\r\n    // init element\r\n    el = el || this.createItemElement(name)\r\n    el.setAttribute('data-layer-name', name)\r\n    this.$wrap.appendChild(el)\r\n\r\n    // create layer instance\r\n    const layer = new Layer(el, {\r\n      onHide: () => this.hideWrap(el!),\r\n      onShow: () => this.showWrap(),\r\n    })\r\n\r\n    // register mask click event\r\n    this.getMask().addEventListener('click', () => {\r\n      layer.getAllowMaskClose() && layer.hide()\r\n    })\r\n\r\n    // add to items\r\n    this.items.push(layer)\r\n\r\n    return layer\r\n  }\r\n\r\n  private createItemElement(name: string) {\r\n    const el = document.createElement('div')\r\n    el.classList.add('atk-layer-item')\r\n    el.style.display = 'none'\r\n    this.$wrap.appendChild(el)\r\n    return el\r\n  }\r\n\r\n  getWrap() {\r\n    return this.$wrap\r\n  }\r\n\r\n  getMask() {\r\n    return this.$mask\r\n  }\r\n\r\n  showWrap() {\r\n    this.$wrap.style.display = 'block'\r\n    this.$mask.style.display = 'block'\r\n    this.$mask.classList.add('atk-fade-in')\r\n    getScrollbarHelper().lock()\r\n  }\r\n\r\n  hideWrap($el: HTMLElement) {\r\n    // if wrap contains more than one item, do not hide entire wrap\r\n    if (\r\n      this.items\r\n        .map((l) => l.getEl())\r\n        .filter((e) => e !== $el && e.isConnected && e.style.display !== 'none').length > 0\r\n    ) {\r\n      return\r\n    }\r\n\r\n    this.$wrap.style.display = 'none'\r\n    getScrollbarHelper().unlock()\r\n  }\r\n}\r\n","import { getScrollbarHelper } from './scrollbar-helper'\r\nimport { LayerWrap } from './wrap'\r\nimport type { ContextApi } from '@/types'\r\n\r\nexport class LayerManager {\r\n  private wrap: LayerWrap\r\n\r\n  constructor(ctx: ContextApi) {\r\n    this.wrap = new LayerWrap()\r\n    document.body.appendChild(this.wrap.getWrap())\r\n\r\n    ctx.on('unmounted', () => {\r\n      this.wrap.getWrap().remove()\r\n    })\r\n\r\n    // 记录页面原始 CSS 属性\r\n    getScrollbarHelper().init()\r\n  }\r\n\r\n  getEl() {\r\n    return this.wrap.getWrap()\r\n  }\r\n\r\n  create(name: string, el?: HTMLElement) {\r\n    return this.wrap.createItem(name, el)\r\n  }\r\n}\r\n","import type { LocalUser } from '@/types'\r\n\r\nconst LOCAL_USER_KEY = 'ArtalkUser'\r\n\r\ninterface UserOpts {\r\n  onUserChanged?: (user: LocalUser) => void\r\n}\r\n\r\nclass User {\r\n  private data: LocalUser\r\n\r\n  constructor(private opts: UserOpts) {\r\n    // Import from localStorage\r\n    const localUser = JSON.parse(window.localStorage.getItem(LOCAL_USER_KEY) || '{}')\r\n\r\n    // Initialize\r\n    this.data = {\r\n      nick: localUser.nick || '',\r\n      email: localUser.email || '',\r\n      link: localUser.link || '',\r\n      token: localUser.token || '',\r\n      isAdmin: localUser.isAdmin || false,\r\n    }\r\n  }\r\n\r\n  getData() {\r\n    return this.data\r\n  }\r\n\r\n  /** Update user data and save to localStorage */\r\n  update(obj: Partial<LocalUser> = {}) {\r\n    Object.entries(obj).forEach(([key, value]) => {\r\n      this.data[key] = value\r\n    })\r\n\r\n    window.localStorage.setItem(LOCAL_USER_KEY, JSON.stringify(this.data))\r\n    this.opts.onUserChanged && this.opts.onUserChanged(this.data)\r\n  }\r\n\r\n  /**\r\n   * Logout\r\n   *\r\n   * @description Logout will clear login status, but not clear user data (nick, email, link)\r\n   */\r\n  logout() {\r\n    this.update({\r\n      token: '',\r\n      isAdmin: false,\r\n    })\r\n  }\r\n\r\n  /** Check if user has filled basic data */\r\n  checkHasBasicUserInfo() {\r\n    return !!this.data.nick && !!this.data.email\r\n  }\r\n}\r\n\r\nexport default User\r\n","import CheckerLauncher from './components/checker'\r\nimport Editor from './editor/editor'\r\nimport SidebarLayer from './layer/sidebar-layer'\r\n\r\nimport List from './list/list'\r\n\r\nimport * as I18n from './i18n'\r\nimport { PlugManager } from './plugins/editor-kit'\r\nimport { LayerManager } from './layer/layer-manager'\r\nimport User from './lib/user'\r\nimport type { ContextApi } from '@/types'\r\n\r\n/**\r\n * Services\r\n *\r\n * @description Call these services by `ctx.get('serviceName')` or `ctx.serviceName`\r\n */\r\nconst services = {\r\n  // I18n\r\n  i18n(ctx: ContextApi) {\r\n    I18n.setLocale(ctx.conf.locale)\r\n\r\n    ctx.watchConf(['locale'], (conf) => {\r\n      I18n.setLocale(conf.locale)\r\n    })\r\n  },\r\n\r\n  // User Store\r\n  user(ctx: ContextApi) {\r\n    const user = new User({\r\n      onUserChanged: (data) => {\r\n        ctx.trigger('user-changed', data)\r\n      },\r\n    })\r\n    return user\r\n  },\r\n\r\n  // 弹出层\r\n  layerManager(ctx: ContextApi) {\r\n    return new LayerManager(ctx)\r\n  },\r\n\r\n  // CheckerLauncher\r\n  checkerLauncher(ctx: ContextApi) {\r\n    const checkerLauncher = new CheckerLauncher({\r\n      getCtx: () => ctx,\r\n      getApi: () => ctx.getApi(),\r\n      onReload: () => ctx.reload(),\r\n\r\n      // make sure suffix with a slash, because it will be used as a base url when call `fetch`\r\n      getCaptchaIframeURL: () => `${ctx.conf.server}/api/v2/captcha/?t=${+new Date()}`,\r\n    })\r\n    return checkerLauncher\r\n  },\r\n\r\n  // 编辑器\r\n  editor(ctx: ContextApi) {\r\n    const editor = new Editor(ctx)\r\n    ctx.$root.appendChild(editor.$el)\r\n    return editor\r\n  },\r\n\r\n  // 评论列表\r\n  list(ctx: ContextApi): List {\r\n    const list = new List(ctx)\r\n    ctx.$root.appendChild(list.$el)\r\n    return list\r\n  },\r\n\r\n  // 侧边栏 Layer\r\n  sidebarLayer(ctx: ContextApi) {\r\n    const sidebarLayer = new SidebarLayer(ctx)\r\n    return sidebarLayer\r\n  },\r\n\r\n  // Extra Service\r\n  // -----------------------------------------\r\n  // Only for type check\r\n  // Not inject to ctx immediately,\r\n  // but can be injected by other occasions\r\n\r\n  editorPlugs(): PlugManager | undefined {\r\n    return undefined\r\n  },\r\n}\r\n\r\nexport default services\r\n\r\n// type tricks for dependency injection\r\ntype TServiceImps = typeof services\r\ntype TObjectWithFuncs = { [k: string]: (...args: any) => any }\r\ntype TKeysOnlyReturn<T extends TObjectWithFuncs, V> = {\r\n  [K in keyof T]: ReturnType<T[K]> extends V ? K : never\r\n}[keyof T]\r\ntype TOmitConditions = TKeysOnlyReturn<TServiceImps, void>\r\ntype TServiceInjectors = Omit<TServiceImps, TOmitConditions>\r\nexport type TInjectedServices = {\r\n  [K in keyof TServiceInjectors]: ReturnType<TServiceInjectors[K]>\r\n}\r\n","import type { ContextApi, ArtalkPlugin, ArtalkConfig } from '@/types'\r\nimport { Api } from '@/api'\r\n\r\ntype CountCache = { [pageKey: string]: number }\r\n\r\nexport interface CountOptions {\r\n  getApi(): Api\r\n\r\n  siteName: string\r\n  pageKey?: string\r\n  pageTitle?: string\r\n  countEl: string\r\n  pvEl: string\r\n  pageKeyAttr: string\r\n\r\n  /** Whether to add PV count when initializing */\r\n  pvAdd?: boolean\r\n}\r\n\r\nexport const PvCountWidget: ArtalkPlugin = (ctx: ContextApi) => {\r\n  ctx.watchConf(['site', 'pageKey', 'pageTitle', 'countEl', 'pvEl', 'statPageKeyAttr'], (conf) => {\r\n    initCountWidget({\r\n      getApi: () => ctx.getApi(),\r\n      siteName: conf.site,\r\n      pageKey: conf.pageKey,\r\n      pageTitle: conf.pageTitle,\r\n      countEl: conf.countEl,\r\n      pvEl: conf.pvEl,\r\n      pageKeyAttr: conf.statPageKeyAttr,\r\n      pvAdd: typeof ctx.conf.pvAdd === 'boolean' ? ctx.conf.pvAdd : true,\r\n    })\r\n  })\r\n}\r\n\r\n/** Initialize count widgets */\r\nexport async function initCountWidget(opt: CountOptions) {\r\n  // Load comment count\r\n  await loadCommentCount(opt)\r\n\r\n  // Increment PV count\r\n  const cacheData = await incrementPvCount(opt)\r\n\r\n  // Load PV count\r\n  await loadPvCount(opt, cacheData)\r\n}\r\n\r\n/** Increment PV count and get cache data that contains PV count */\r\nasync function incrementPvCount(opt: CountOptions) {\r\n  if (!opt.pvAdd || !opt.pageKey) return undefined\r\n\r\n  const pvCount = (\r\n    await opt.getApi().pages.logPv({\r\n      page_key: opt.pageKey,\r\n      page_title: opt.pageTitle,\r\n      site_name: opt.siteName,\r\n    })\r\n  ).data.pv // pv+1 and get pv count\r\n\r\n  return {\r\n    [opt.pageKey]: pvCount,\r\n  }\r\n}\r\n\r\n/** Load comment count */\r\nasync function loadCommentCount(opt: CountOptions) {\r\n  await loadStatCount({ opt, query: 'page_comment', containers: [opt.countEl, '#ArtalkCount'] })\r\n}\r\n\r\n/** Load PV count */\r\nasync function loadPvCount(opt: CountOptions, cache?: CountCache) {\r\n  await loadStatCount({ opt, query: 'page_pv', containers: [opt.pvEl, '#ArtalkPv'], cache })\r\n}\r\n\r\nasync function loadStatCount(args: {\r\n  opt: CountOptions\r\n  query: 'page_pv' | 'page_comment'\r\n  containers: string[]\r\n  cache?: CountCache\r\n}) {\r\n  const { opt } = args\r\n  let cache: CountCache = args.cache || {}\r\n\r\n  // Retrieve elements\r\n  const els = retrieveElements(args.containers)\r\n\r\n  // Get page keys which will be queried\r\n  const pageKeys = getPageKeys(els, opt.pageKeyAttr, opt.pageKey, cache)\r\n\r\n  // Fetch count data from server\r\n  if (pageKeys.length > 0) {\r\n    const res = (\r\n      await opt.getApi().stats.getStats(args.query, {\r\n        page_keys: pageKeys.join(','),\r\n        site_name: opt.siteName,\r\n      })\r\n    ).data.data as CountCache\r\n    cache = { ...cache, ...res }\r\n  }\r\n\r\n  updateElementsText(els, cache, opt.pageKey)\r\n}\r\n\r\n/** Retrieve elements based on selectors */\r\nfunction retrieveElements(containers: string[]): Set<HTMLElement> {\r\n  const els = new Set<HTMLElement>()\r\n  new Set(containers).forEach((selector) => {\r\n    document.querySelectorAll<HTMLElement>(selector).forEach((el) => els.add(el))\r\n  })\r\n  return els\r\n}\r\n\r\n/** Get page keys to be queried */\r\nfunction getPageKeys(\r\n  els: Set<HTMLElement>,\r\n  pageKeyAttr: string,\r\n  pageKey: string | undefined,\r\n  cache: CountCache,\r\n): string[] {\r\n  const pageKeys = Array.from(els)\r\n    .map((el) => el.getAttribute(pageKeyAttr) || pageKey)\r\n    .filter((key) => key && typeof cache[key] !== 'number') // filter out keys that already have data\r\n\r\n  return [...new Set(pageKeys as string[])] // deduplicate\r\n}\r\n\r\n/** Update elements text content with the count data */\r\nfunction updateElementsText(els: Set<HTMLElement>, data: CountCache, defaultPageKey?: string) {\r\n  els.forEach((el) => {\r\n    const pageKey = el.getAttribute('data-page-key')\r\n    const count = (pageKey && data[pageKey]) || (defaultPageKey && data[defaultPageKey]) || 0 // if pageKey is not set, use defaultCount\r\n    el.innerText = `${Number(count)}`\r\n  })\r\n}\r\n\r\nexport const exportedForTesting = {\r\n  incrementPvCount,\r\n  loadCommentCount,\r\n  loadPvCount,\r\n  retrieveElements,\r\n  getPageKeys,\r\n  updateElementsText,\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as marked from '@/lib/marked'\r\n\r\nexport const Markdown: ArtalkPlugin = (ctx) => {\r\n  ctx.watchConf(['imgLazyLoad', 'markedOptions'], (conf) => {\r\n    marked.initMarked({\r\n      markedOptions: ctx.getConf().markedOptions,\r\n      imgLazyLoad: ctx.getConf().imgLazyLoad,\r\n    })\r\n  })\r\n\r\n  ctx.watchConf(['markedReplacers'], (conf) => {\r\n    conf.markedReplacers && marked.setReplacers(conf.markedReplacers)\r\n  })\r\n}\r\n","import type PlugKit from './_kit'\r\nimport EditorPlug from './_plug'\r\nimport $t from '@/i18n'\r\n\r\nconst LocalStorageKey = 'ArtalkContent'\r\n\r\nexport default class LocalStorage extends EditorPlug {\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const onContentUpdated = () => {\r\n      this.save()\r\n    }\r\n\r\n    this.kit.useMounted(() => {\r\n      // load editor content from localStorage when init\r\n      const localContent = window.localStorage.getItem(LocalStorageKey) || ''\r\n      if (localContent.trim() !== '') {\r\n        this.kit.useEditor().showNotify($t('restoredMsg'), 'i')\r\n        this.kit.useEditor().setContent(localContent)\r\n      }\r\n\r\n      // bind event\r\n      this.kit.useEvents().on('content-updated', onContentUpdated)\r\n    })\r\n\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useEvents().off('content-updated', onContentUpdated)\r\n    })\r\n  }\r\n\r\n  // Save editor content to localStorage\r\n  public save() {\r\n    window.localStorage.setItem(LocalStorageKey, this.kit.useEditor().getContentRaw().trim())\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport $t from '@/i18n'\r\n\r\nexport default class Textarea extends EditorPlug {\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const onKeydown = (e: KeyboardEvent) => this.onKeydown(e)\r\n    const onInput = () => this.onInput()\r\n\r\n    this.kit.useMounted(() => {\r\n      // 占位符\r\n      this.kit.useUI().$textarea.placeholder = this.kit.useConf().placeholder || $t('placeholder')\r\n\r\n      // bind the event\r\n      this.kit.useUI().$textarea.addEventListener('keydown', onKeydown)\r\n      this.kit.useUI().$textarea.addEventListener('input', onInput)\r\n    })\r\n\r\n    this.kit.useUnmounted(() => {\r\n      // unmount the event\r\n      this.kit.useUI().$textarea.removeEventListener('keydown', onKeydown)\r\n      this.kit.useUI().$textarea.removeEventListener('input', onInput)\r\n    })\r\n\r\n    this.kit.useEvents().on('content-updated', () => {\r\n      // delay 80ms to prevent invalid execution\r\n      window.setTimeout(() => {\r\n        this.adaptiveHeightByContent()\r\n      }, 80)\r\n    })\r\n  }\r\n\r\n  // 按下 Tab 输入内容，而不是失去焦距\r\n  private onKeydown(e: KeyboardEvent) {\r\n    const keyCode = e.keyCode || e.which\r\n\r\n    if (keyCode === 9) {\r\n      e.preventDefault()\r\n      this.kit.useEditor().insertContent('\\t')\r\n    }\r\n  }\r\n\r\n  private onInput() {\r\n    this.kit.useEvents().trigger('content-updated', this.kit.useEditor().getContentRaw())\r\n  }\r\n\r\n  // Resize the textarea height by content\r\n  public adaptiveHeightByContent() {\r\n    const diff = this.kit.useUI().$textarea.offsetHeight - this.kit.useUI().$textarea.clientHeight\r\n    this.kit.useUI().$textarea.style.height = '0px' // it's a magic. 若不加此行，内容减少，高度回不去\r\n    this.kit.useUI().$textarea.style.height = `${this.kit.useUI().$textarea.scrollHeight + diff}px`\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport $t from '@/i18n'\r\n\r\nexport default class SubmitBtn extends EditorPlug {\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const onClick = () => {\r\n      this.kit.useEditor().submit()\r\n    }\r\n\r\n    this.kit.useMounted(() => {\r\n      // apply the submit button text from user custom config\r\n      this.kit.useUI().$submitBtn.innerText = this.kit.useConf().sendBtn || $t('send')\r\n\r\n      // bind the event when click the submit button\r\n      this.kit.useUI().$submitBtn.addEventListener('click', onClick)\r\n    })\r\n\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useUI().$submitBtn.removeEventListener('click', onClick)\r\n    })\r\n  }\r\n}\r\n","import type PlugKit from './_kit'\r\nimport type { CommentData } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport default class SubmitAddPreset {\r\n  constructor(private kit: PlugKit) {}\r\n\r\n  async reqAdd() {\r\n    const nComment = (\r\n      await this.kit.useApi().comments.createComment({\r\n        ...(await this.getSubmitAddParams()),\r\n      })\r\n    ).data\r\n    return nComment\r\n  }\r\n\r\n  async getSubmitAddParams() {\r\n    const { nick, email, link } = this.kit.useUser().getData()\r\n    const conf = this.kit.useConf()\r\n\r\n    return {\r\n      content: this.kit.useEditor().getContentFinal(),\r\n      name: nick,\r\n      email,\r\n      link,\r\n      rid: 0,\r\n      page_key: conf.pageKey,\r\n      page_title: conf.pageTitle,\r\n      site_name: conf.site,\r\n      ua: await Utils.getCorrectUserAgent(), // Get the corrected UA\r\n    }\r\n  }\r\n\r\n  postSubmitAdd(commentNew: CommentData) {\r\n    // insert the new comment to list\r\n    this.kit.useGlobalCtx().getData().insertComment(commentNew)\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport SubmitAddPreset from './submit-add'\r\nimport $t from '@/i18n'\r\nimport type { CommentData } from '@/types'\r\n\r\ninterface CustomSubmit {\r\n  activeCond: () => void\r\n  pre?: () => void\r\n  req?: () => Promise<CommentData>\r\n  /** The `post` method is called after the comment is successfully submitted */\r\n  post?: (nComment: CommentData) => void\r\n}\r\n\r\nexport default class Submit extends EditorPlug {\r\n  private customs: CustomSubmit[] = []\r\n  private defaultPreset: SubmitAddPreset\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    this.defaultPreset = new SubmitAddPreset(this.kit)\r\n\r\n    const onEditorSubmit = () => this.do()\r\n\r\n    this.kit.useMounted(() => {\r\n      // invoke `do()` when event `editor-submit` is triggered\r\n      this.kit.useGlobalCtx().on('editor-submit', onEditorSubmit)\r\n    })\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useGlobalCtx().off('editor-submit', onEditorSubmit)\r\n    })\r\n  }\r\n\r\n  registerCustom(c: CustomSubmit) {\r\n    this.customs.push(c)\r\n  }\r\n\r\n  private async do() {\r\n    if (this.kit.useEditor().getContentFinal().trim() === '') {\r\n      this.kit.useEditor().focus()\r\n      return\r\n    }\r\n\r\n    const custom = this.customs.find((o) => o.activeCond())\r\n\r\n    this.kit.useEditor().showLoading()\r\n\r\n    try {\r\n      // pre submit\r\n      if (custom?.pre) custom.pre()\r\n\r\n      let nComment: CommentData\r\n\r\n      // submit request\r\n      if (custom?.req) nComment = await custom.req()\r\n      else nComment = await this.defaultPreset.reqAdd()\r\n\r\n      // post submit\r\n      if (custom?.post) custom.post(nComment)\r\n      else this.defaultPreset.postSubmitAdd(nComment)\r\n    } catch (err: any) {\r\n      // submit error\r\n      console.error(err)\r\n      this.kit.useEditor().showNotify(`${$t('commentFail')}: ${err.message || String(err)}`, 'e')\r\n      return\r\n    } finally {\r\n      this.kit.useEditor().hideLoading()\r\n    }\r\n\r\n    this.kit.useEditor().reset() // 复原编辑器\r\n    this.kit.useGlobalCtx().trigger('editor-submitted')\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport Submit from './submit'\r\nimport SubmitAddPreset from './submit-add'\r\nimport type { CommentData } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\nimport * as Ui from '@/lib/ui'\r\nimport $t from '@/i18n'\r\n\r\nexport default class StateReply extends EditorPlug {\r\n  private comment?: CommentData\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    // add effect when state switch to `reply`\r\n    this.useEditorStateEffect('reply', (commentData) => {\r\n      this.setReply(commentData)\r\n\r\n      return () => {\r\n        this.cancelReply()\r\n      }\r\n    })\r\n\r\n    // register submit preset\r\n    this.kit.useEvents().on('mounted', () => {\r\n      const submitPlug = this.kit.useDeps(Submit)\r\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\r\n\r\n      const defaultPreset = new SubmitAddPreset(this.kit)\r\n\r\n      submitPlug.registerCustom({\r\n        activeCond: () => !!this.comment, // active this custom submit when reply mode\r\n        req: async () => {\r\n          if (!this.comment) throw new Error('reply comment cannot be empty')\r\n\r\n          const nComment = (\r\n            await this.kit.useApi().comments.createComment({\r\n              ...(await defaultPreset.getSubmitAddParams()),\r\n              rid: this.comment.id,\r\n              page_key: this.comment.page_key,\r\n              page_title: undefined,\r\n              site_name: this.comment.site_name,\r\n            })\r\n          ).data\r\n\r\n          return nComment\r\n        },\r\n        post: (nComment: CommentData) => {\r\n          // open another page when reply comment is not the same pageKey\r\n          const conf = this.kit.useConf()\r\n          if (nComment.page_key !== conf.pageKey) {\r\n            window.open(`${nComment.page_url}#atk-comment-${nComment.id}`)\r\n          }\r\n\r\n          defaultPreset.postSubmitAdd(nComment)\r\n        },\r\n      })\r\n    })\r\n  }\r\n\r\n  private setReply(commentData: CommentData) {\r\n    const ui = this.kit.useUI()\r\n    if (!ui.$sendReplyBtn) {\r\n      const $btn = Utils.createElement(\r\n        `<span class=\"atk-state-btn\">` +\r\n          `<span class=\"atk-text-wrap\">` +\r\n          `${$t('reply')} <span class=\"atk-text\"></span>` +\r\n          `</span>` +\r\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\r\n          `</span>`,\r\n      )\r\n      $btn.querySelector<HTMLElement>('.atk-text')!.innerText = `@${commentData.nick}`\r\n      $btn.addEventListener('click', () => {\r\n        this.kit.useEditor().resetState()\r\n      })\r\n      ui.$stateWrap.append($btn)\r\n      ui.$sendReplyBtn = $btn\r\n    }\r\n\r\n    this.comment = commentData\r\n\r\n    ui.$textarea.focus()\r\n  }\r\n\r\n  private cancelReply() {\r\n    if (!this.comment) return\r\n\r\n    const ui = this.kit.useUI()\r\n    if (ui.$sendReplyBtn) {\r\n      ui.$sendReplyBtn.remove()\r\n      ui.$sendReplyBtn = undefined\r\n    }\r\n    this.comment = undefined\r\n  }\r\n}\r\n","import type PlugKit from './_kit'\r\nimport EditorPlug from './_plug'\r\nimport Submit from './submit'\r\nimport type { CommentData } from '@/types'\r\nimport $t from '@/i18n'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport default class StateEdit extends EditorPlug {\r\n  private comment?: CommentData\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    // add effect when state switch to `edit`\r\n    this.useEditorStateEffect('edit', (comment) => {\r\n      this.edit(comment)\r\n\r\n      return () => {\r\n        this.cancelEdit()\r\n      }\r\n    })\r\n\r\n    // register submit preset\r\n    this.kit.useMounted(() => {\r\n      const submitPlug = this.kit.useDeps(Submit)\r\n      if (!submitPlug) throw Error('SubmitPlug not initialized')\r\n\r\n      submitPlug.registerCustom({\r\n        activeCond: () => !!this.comment, // active this custom submit when edit mode\r\n        req: async () => {\r\n          const saveData = {\r\n            content: this.kit.useEditor().getContentFinal(),\r\n            nick: this.kit.useUI().$nick.value,\r\n            email: this.kit.useUI().$email.value,\r\n            link: this.kit.useUI().$link.value,\r\n          }\r\n          const comment = this.comment!\r\n          const nComment = await this.kit.useApi().comments.updateComment(comment.id, {\r\n            ...comment,\r\n            ...saveData,\r\n          })\r\n          return nComment.data\r\n        },\r\n        post: (nComment: CommentData) => {\r\n          this.kit.useGlobalCtx().getData().updateComment(nComment)\r\n        },\r\n      })\r\n    })\r\n  }\r\n\r\n  private edit(comment: CommentData) {\r\n    const ui = this.kit.useUI()\r\n    if (!ui.$editCancelBtn) {\r\n      const $btn = Utils.createElement(\r\n        `<span class=\"atk-state-btn\">` +\r\n          `<span class=\"atk-text-wrap\">` +\r\n          `${$t('editCancel')}` +\r\n          `</span>` +\r\n          `<span class=\"atk-cancel atk-icon-close atk-icon\"></span>` +\r\n          `</span>`,\r\n      )\r\n      $btn.onclick = () => {\r\n        this.kit.useEditor().resetState()\r\n      }\r\n      ui.$stateWrap.append($btn)\r\n      ui.$editCancelBtn = $btn\r\n    }\r\n    this.comment = comment\r\n\r\n    ui.$header.style.display = 'none' // TODO: support modify header information\r\n\r\n    ui.$nick.value = comment.nick || ''\r\n    ui.$email.value = comment.email || ''\r\n    // ui.$link.value = comment.link || ''\r\n\r\n    this.kit.useEditor().setContent(comment.content)\r\n    ui.$textarea.focus()\r\n\r\n    this.updateSubmitBtnText($t('save'))\r\n  }\r\n\r\n  private cancelEdit() {\r\n    if (!this.comment) return\r\n\r\n    const ui = this.kit.useUI()\r\n\r\n    if (ui.$editCancelBtn) {\r\n      ui.$editCancelBtn.remove()\r\n      ui.$editCancelBtn = undefined\r\n    }\r\n\r\n    this.comment = undefined\r\n\r\n    const { nick, email, link } = this.kit.useUser().getData()\r\n    ui.$nick.value = nick\r\n    ui.$email.value = email\r\n    // ui.$link.value = link\r\n\r\n    this.kit.useEditor().setContent('')\r\n    this.restoreSubmitBtnText()\r\n\r\n    ui.$header.style.display = '' // TODO: support modify header information\r\n  }\r\n\r\n  // -------------------------------------------------------------------\r\n  //  Submit Btn Text Modifier\r\n  // -------------------------------------------------------------------\r\n\r\n  private originalSubmitBtnText = 'Send'\r\n\r\n  private updateSubmitBtnText(text: string) {\r\n    this.originalSubmitBtnText = this.kit.useUI().$submitBtn.innerText\r\n    this.kit.useUI().$submitBtn.innerText = text\r\n  }\r\n\r\n  private restoreSubmitBtnText() {\r\n    this.kit.useUI().$submitBtn.innerText = this.originalSubmitBtnText\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport * as Utils from '@/lib/utils'\r\nimport $t from '@/i18n'\r\n\r\nexport default class Closable extends EditorPlug {\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const onOpen = () => this.open()\r\n    const onClose = () => this.close()\r\n\r\n    this.kit.useMounted(() => {\r\n      this.kit.useEvents().on('editor-open', onOpen)\r\n      this.kit.useEvents().on('editor-close', onClose)\r\n    })\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useEvents().off('editor-open', onOpen)\r\n      this.kit.useEvents().off('editor-close', onClose)\r\n    })\r\n  }\r\n\r\n  private open() {\r\n    this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed')?.remove()\r\n    this.kit.useUI().$textarea.style.display = ''\r\n    this.kit.useUI().$bottom.style.display = ''\r\n  }\r\n\r\n  private close() {\r\n    if (!this.kit.useUI().$textareaWrap.querySelector('.atk-comment-closed'))\r\n      this.kit\r\n        .useUI()\r\n        .$textareaWrap.prepend(\r\n          Utils.createElement(`<div class=\"atk-comment-closed\">${$t('onlyAdminCanReply')}</div>`),\r\n        )\r\n\r\n    if (!this.kit.useUser().getData().isAdmin) {\r\n      this.kit.useUI().$textarea.style.display = 'none'\r\n      this.kit.useEvents().trigger('panel-close')\r\n      this.kit.useUI().$bottom.style.display = 'none'\r\n    } else {\r\n      // 管理员一直打开评论\r\n      this.kit.useUI().$textarea.style.display = ''\r\n      this.kit.useUI().$bottom.style.display = ''\r\n    }\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\n\r\nexport default class HeaderEvent extends EditorPlug {\r\n  private get $inputs() {\r\n    return this.kit.useEditor().getHeaderInputEls()\r\n  }\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const inputEventFns: { [name: string]: () => void } = {}\r\n    const changeEventFns: { [name: string]: () => void } = {}\r\n\r\n    const trigger =\r\n      (evt: 'header-input' | 'header-change', $input: HTMLInputElement, field: string) => () => {\r\n        this.kit.useEvents().trigger(evt, { field, $input })\r\n      }\r\n\r\n    this.kit.useMounted(() => {\r\n      // batch bind the events\r\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\r\n        $input.addEventListener(\r\n          'input',\r\n          (inputEventFns[key] = trigger('header-input', $input, key)),\r\n        )\r\n        $input.addEventListener(\r\n          'change',\r\n          (changeEventFns[key] = trigger('header-change', $input, key)),\r\n        )\r\n      })\r\n    })\r\n\r\n    this.kit.useUnmounted(() => {\r\n      // unmount the event\r\n      Object.entries(this.$inputs).forEach(([key, $input]) => {\r\n        $input.removeEventListener('input', inputEventFns[key])\r\n        $input.removeEventListener('change', changeEventFns[key])\r\n      })\r\n    })\r\n  }\r\n}\r\n","import EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport $t from '@/i18n'\r\nimport type { UserInfoApiResponseData } from '@/types'\r\n\r\nexport default class HeaderUser extends EditorPlug {\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    const onInput = ({ $input, field }: { $input: HTMLInputElement; field: string }) => {\r\n      if (this.kit.useEditor().getState() === 'edit') return // TODO: prevent execute when editing, since update comment.user not support\r\n\r\n      // update user data\r\n      this.kit.useUser().update({ [field]: $input.value.trim() })\r\n\r\n      // remote fetch user info\r\n      if (field === 'nick' || field === 'email') this.fetchUserInfo() // must after update user data, since fetchUserInfo() will use User.data\r\n    }\r\n\r\n    this.kit.useMounted(() => {\r\n      Object.entries(this.kit.useEditor().getHeaderInputEls()).forEach(([key, $input]) => {\r\n        // set placeholder\r\n        $input.placeholder = `${$t(key as any)}`\r\n\r\n        // sync header values from User.data\r\n        $input.value = this.kit.useUser().getData()[key] || ''\r\n      })\r\n\r\n      // bind events\r\n      this.kit.useEvents().on('header-input', onInput)\r\n    })\r\n\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useEvents().off('header-input', onInput)\r\n    })\r\n  }\r\n\r\n  private query = {\r\n    timer: <number | null>null,\r\n    abortFn: <(() => void) | null>null,\r\n  }\r\n\r\n  /**\r\n   * Fetch user info from server\r\n   */\r\n  private fetchUserInfo() {\r\n    this.kit.useUser().logout() // clear login status\r\n\r\n    if (this.query.timer) window.clearTimeout(this.query.timer) // clear the not executed timeout task\r\n    if (this.query.abortFn) this.query.abortFn() // abort the last request (if request is pending not finished)\r\n\r\n    this.query.timer = window.setTimeout(() => {\r\n      this.query.timer = null // clear the timer (clarify the timer is executing)\r\n\r\n      const api = this.kit.useApi()\r\n      const CANCEL_TOKEN = 'getUserCancelToken'\r\n      this.query.abortFn = () => api.abortRequest(CANCEL_TOKEN)\r\n\r\n      api.user\r\n        .getUser(\r\n          { ...api.getUserFields() },\r\n          {\r\n            cancelToken: CANCEL_TOKEN,\r\n          },\r\n        )\r\n        .then((res) => this.onUserInfoFetched(res.data))\r\n        .catch((err) => {})\r\n        .finally(() => {\r\n          this.query.abortFn = null // clear the abort function (clarify the request is finished)\r\n        })\r\n    }, 400) // delay to reduce request\r\n  }\r\n\r\n  /**\r\n   * Function called when user info fetched\r\n   *\r\n   * @param data The response data from server\r\n   */\r\n  private onUserInfoFetched(data: UserInfoApiResponseData) {\r\n    // If api response is not login, logout\r\n    if (!data.is_login) this.kit.useUser().logout()\r\n\r\n    // Update unread notifies\r\n    this.kit.useGlobalCtx().getData().updateNotifies(data.notifies)\r\n\r\n    // If user is admin and not login,\r\n    if (this.kit.useUser().checkHasBasicUserInfo() && !data.is_login && data.user?.is_admin) {\r\n      // then show login window\r\n      this.kit.useGlobalCtx().checkAdmin({\r\n        onSuccess: () => {},\r\n      })\r\n    }\r\n\r\n    // Auto fill user link from server\r\n    if (data.user && data.user.link) {\r\n      // this.kit.useUI().$link.value = data.user.link\r\n      this.kit.useUser().update({ link: data.user.link })\r\n    }\r\n  }\r\n}\r\n","import './emoticons.scss'\r\n\r\nimport EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport type { EmoticonListData, EmoticonGrpData } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\nimport * as Ui from '@/lib/ui'\r\nimport $t from '@/i18n'\r\n\r\ntype OwOFormatType = {\r\n  [key: string]: {\r\n    type: 'emoticon' | 'emoji' | 'image'\r\n    container: { icon: string; text: string }[]\r\n  }\r\n}\r\n\r\nexport default class Emoticons extends EditorPlug {\r\n  private emoticons: EmoticonListData = []\r\n  private loadingTask: Promise<void> | null = null\r\n\r\n  private $grpWrap!: HTMLElement\r\n  private $grpSwitcher!: HTMLElement\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    this.kit.useMounted(() => {\r\n      this.usePanel(`<div class=\"atk-editor-plug-emoticons\"></div>`)\r\n      this.useBtn(\r\n        `<i aria-label=\"${$t('emoticon')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m4.26829 5.29294c0-.94317.45893-1.7074 1.02439-1.7074.56547 0 1.02439.76423 1.02439 1.7074s-.45892 1.7074-1.02439 1.7074c-.56546 0-1.02439-.76423-1.02439-1.7074zm4.43903 1.7074c.56546 0 1.02439-.76423 1.02439-1.7074s-.45893-1.7074-1.02439-1.7074c-.56547 0-1.02439.76423-1.02439 1.7074s.45892 1.7074 1.02439 1.7074zm-1.70732 2.73184c-1.51883 0-2.06312-1.52095-2.08361-1.58173l-1.29551.43231c.03414.10244.868 2.51604 3.3798 2.51604 2.51181 0 3.34502-2.41291 3.37982-2.51604l-1.29484-.43573c-.02254.06488-.56683 1.58583-2.08498 1.58583zm7-2.73252c0 3.86004-3.1401 7.00034-7 7.00034s-7-3.1396-7-6.99966c0-3.86009 3.1401-7.00034 7-7.00034s7 3.14025 7 7.00034zm-1.3659 0c0-3.10679-2.5275-5.63442-5.6341-5.63442-3.10663 0-5.63415 2.52832-5.63415 5.6351 0 3.10676 2.52752 5.63446 5.63415 5.63446 3.1066 0 5.6341-2.5277 5.6341-5.63446z\"/></svg></i>`,\r\n      )\r\n    })\r\n    this.kit.useUnmounted(() => {})\r\n\r\n    this.useContentTransformer((raw) => this.transEmoticonImageText(raw))\r\n    this.usePanelShow(() => {\r\n      ;(async () => {\r\n        await this.loadEmoticonsData()\r\n\r\n        // 初始化元素\r\n        if (!this.isImgLoaded) {\r\n          this.initEmoticonsList()\r\n          this.isImgLoaded = true\r\n        }\r\n\r\n        // 延迟执行，防止无法读取高度\r\n        setTimeout(() => {\r\n          this.changeListHeight()\r\n        }, 30)\r\n      })()\r\n    })\r\n    this.usePanelHide(() => {\r\n      this.$panel!.parentElement!.style.height = ''\r\n    })\r\n\r\n    // 表情包预加载\r\n    window.setTimeout(() => {\r\n      this.loadEmoticonsData()\r\n    }, 1000) // 延迟 1s 加载\r\n  }\r\n\r\n  private isListLoaded = false\r\n  private isImgLoaded = false\r\n\r\n  public async loadEmoticonsData() {\r\n    if (this.isListLoaded) return\r\n    if (this.loadingTask !== null) {\r\n      await this.loadingTask\r\n      return\r\n    }\r\n\r\n    // 数据处理\r\n    this.loadingTask = (async () => {\r\n      Ui.showLoading(this.$panel!)\r\n      this.emoticons = await this.handleData(this.kit.useConf().emoticons)\r\n      Ui.hideLoading(this.$panel!)\r\n      this.loadingTask = null\r\n      this.isListLoaded = true\r\n    })()\r\n    await this.loadingTask\r\n  }\r\n\r\n  private async handleData(data: any): Promise<any[]> {\r\n    if (!Array.isArray(data) && ['object', 'string'].includes(typeof data)) {\r\n      data = [data]\r\n    }\r\n\r\n    if (!Array.isArray(data)) {\r\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] Data must be of Array/Object/String type`)\r\n      Ui.hideLoading(this.$panel!)\r\n      return []\r\n    }\r\n\r\n    const pushGrp = (grp: EmoticonGrpData) => {\r\n      if (typeof grp !== 'object') return\r\n      if (grp.name && data.find((o) => o.name === grp.name)) return\r\n      data.push(grp)\r\n    }\r\n\r\n    // 加载子内容\r\n    const remoteLoad = async (d: any[]) => {\r\n      await Promise.all(\r\n        d.map(async (grp, index) => {\r\n          if (typeof grp === 'object' && !Array.isArray(grp)) {\r\n            pushGrp(grp)\r\n          } else if (Array.isArray(grp)) {\r\n            await remoteLoad(grp)\r\n          } else if (typeof grp === 'string') {\r\n            const grpData = await this.remoteLoad(grp)\r\n\r\n            if (Array.isArray(grpData)) await remoteLoad(grpData)\r\n            else if (typeof grpData === 'object') pushGrp(grpData)\r\n          }\r\n        }),\r\n      )\r\n    }\r\n    await remoteLoad(data)\r\n\r\n    // 处理数组数据\r\n    data.forEach((item: any) => {\r\n      if (this.isOwOFormat(item)) {\r\n        const c = this.convertOwO(item)\r\n        c.forEach((grp) => {\r\n          pushGrp(grp)\r\n        })\r\n      } else if (Array.isArray(item)) {\r\n        item.forEach((grp) => {\r\n          pushGrp(grp)\r\n        })\r\n      }\r\n    })\r\n\r\n    // 剔除非法数据\r\n    data = data.filter(\r\n      (item: any) => typeof item === 'object' && !Array.isArray(item) && !!item && !!item.name,\r\n    )\r\n\r\n    // console.log(data)\r\n\r\n    this.solveNullKey(data)\r\n    this.solveSameKey(data)\r\n\r\n    return data\r\n  }\r\n\r\n  /** 远程加载 */\r\n  private async remoteLoad(url: string): Promise<any> {\r\n    if (!url) return []\r\n\r\n    try {\r\n      const resp = await fetch(url)\r\n      const json = await resp.json()\r\n      return json\r\n    } catch (err) {\r\n      Ui.hideLoading(this.$panel!)\r\n      console.error('[Emoticons] Load Failed:', err)\r\n      Ui.setError(this.$panel!, `[${$t('emoticon')}] ${$t('loadFail')}: ${String(err)}`)\r\n      return []\r\n    }\r\n  }\r\n\r\n  /** 避免表情 item.key 为 null 的情况 */\r\n  private solveNullKey(data: EmoticonGrpData[]) {\r\n    data.forEach((grp) => {\r\n      grp.items.forEach((item, index) => {\r\n        if (!item.key) item.key = `${grp.name} ${index + 1}`\r\n      })\r\n    })\r\n  }\r\n\r\n  /** 避免相同 item.key */\r\n  private solveSameKey(data: EmoticonGrpData[]) {\r\n    const tmp: { [key: string]: number } = {}\r\n    data.forEach((grp) => {\r\n      grp.items.forEach((item) => {\r\n        if (!item.key || String(item.key).trim() === '') return\r\n        if (!tmp[item.key]) tmp[item.key] = 1\r\n        else tmp[item.key]++\r\n\r\n        if (tmp[item.key] > 1) item.key = `${item.key} ${tmp[item.key]}`\r\n      })\r\n    })\r\n  }\r\n\r\n  /** 判断是否为 OwO 格式 */\r\n  private isOwOFormat(data: any) {\r\n    try {\r\n      return (\r\n        typeof data === 'object' &&\r\n        !!Object.values(data).length &&\r\n        Array.isArray(Object.keys(Object.values<any>(data)[0].container)) &&\r\n        Object.keys(Object.values<any>(data)[0].container[0]).includes('icon')\r\n      )\r\n    } catch {\r\n      return false\r\n    }\r\n  }\r\n\r\n  /** 转换 OwO 格式数据 */\r\n  private convertOwO(owoData: OwOFormatType): EmoticonListData {\r\n    const dest: EmoticonListData = []\r\n    Object.entries(owoData).forEach(([grpName, grp]) => {\r\n      const nGrp: EmoticonGrpData = { name: grpName, type: grp.type, items: [] }\r\n      grp.container.forEach((item, index) => {\r\n        // 图片标签提取 src 属性值\r\n        const iconStr = item.icon\r\n        if (/<(img|IMG)/.test(iconStr)) {\r\n          const find = /src=[\"'](.*?)[\"']/.exec(iconStr)\r\n          if (find && find.length > 1) item.icon = find[1]\r\n        }\r\n        nGrp.items.push({\r\n          key: item.text || `${grpName} ${index + 1}`,\r\n          val: item.icon,\r\n        })\r\n      })\r\n      dest.push(nGrp)\r\n    })\r\n    return dest\r\n  }\r\n\r\n  /** 初始化表情列表界面 */\r\n  private initEmoticonsList() {\r\n    // 表情列表\r\n    this.$grpWrap = Utils.createElement(`<div class=\"atk-grp-wrap\"></div>`)\r\n    this.$panel!.append(this.$grpWrap)\r\n\r\n    this.emoticons.forEach((grp, index) => {\r\n      const $grp = Utils.createElement(`<div class=\"atk-grp\" style=\"display: none;\"></div>`)\r\n      this.$grpWrap.append($grp)\r\n      $grp.setAttribute('data-index', String(index))\r\n      $grp.setAttribute('data-grp-name', grp.name)\r\n      $grp.setAttribute('data-type', grp.type)\r\n      grp.items.forEach((item) => {\r\n        const $item = Utils.createElement(`<span class=\"atk-item\"></span>`)\r\n        $grp.append($item)\r\n\r\n        if (!!item.key && !new RegExp(`^(${grp.name})?\\\\s?[0-9]+$`).test(item.key))\r\n          $item.setAttribute('title', item.key)\r\n\r\n        if (grp.type === 'image') {\r\n          const imgEl = document.createElement('img')\r\n          imgEl.src = item.val\r\n          imgEl.alt = item.key\r\n          $item.append(imgEl)\r\n        } else {\r\n          $item.innerText = item.val\r\n        }\r\n\r\n        $item.onclick = () => {\r\n          if (grp.type === 'image') {\r\n            this.kit.useEditor().insertContent(`:[${item.key}]`)\r\n          } else {\r\n            this.kit.useEditor().insertContent(item.val || '')\r\n          }\r\n        }\r\n      })\r\n    })\r\n\r\n    // 表情分类切换 bar\r\n    if (this.emoticons.length > 1) {\r\n      this.$grpSwitcher = Utils.createElement(`<div class=\"atk-grp-switcher\"></div>`)\r\n      this.$panel!.append(this.$grpSwitcher)\r\n      this.emoticons.forEach((grp, index) => {\r\n        const $item = Utils.createElement('<span />')\r\n        $item.innerText = grp.name\r\n        $item.setAttribute('data-index', String(index))\r\n        $item.onclick = () => this.openGrp(index)\r\n        this.$grpSwitcher.append($item)\r\n      })\r\n    }\r\n\r\n    // 默认打开第一个分类\r\n    if (this.emoticons.length > 0) this.openGrp(0)\r\n  }\r\n\r\n  /** 打开一个表情组 */\r\n  public openGrp(index: number) {\r\n    Array.from(this.$grpWrap.children).forEach((item) => {\r\n      const el = item as HTMLElement\r\n      if (el.getAttribute('data-index') !== String(index)) {\r\n        el.style.display = 'none'\r\n      } else {\r\n        el.style.display = ''\r\n      }\r\n    })\r\n\r\n    this.$grpSwitcher\r\n      ?.querySelectorAll('span.active')\r\n      .forEach((item) => item.classList.remove('active'))\r\n    this.$grpSwitcher?.querySelector(`span[data-index=\"${index}\"]`)?.classList.add('active')\r\n\r\n    this.changeListHeight()\r\n  }\r\n\r\n  private changeListHeight() {\r\n    /* const listWrapHeight = Utils.getHeight(this.$grpWrapem)\r\n    this.editor.plugWrapEl.style.height = `${listWrapHeight > 150 ? listWrapHeight : 150}px` */\r\n  }\r\n\r\n  /** 处理评论 content 中的表情内容 */\r\n  public transEmoticonImageText(text: string) {\r\n    if (!this.emoticons || !Array.isArray(this.emoticons)) return text\r\n\r\n    this.emoticons.forEach((grp) => {\r\n      if (grp.type !== 'image') return\r\n      Object.entries(grp.items).forEach(([index, item]) => {\r\n        text = text\r\n          .split(`:[${item.key}]`)\r\n          .join(`<img src=\"${item.val}\" atk-emoticon=\"${item.key}\">`) // replaceAll(...)\r\n      })\r\n    })\r\n\r\n    return text\r\n  }\r\n}\r\n","import type PlugKit from './_kit'\r\nimport EditorPlug from './_plug'\r\nimport * as Utils from '@/lib/utils'\r\nimport $t from '@/i18n'\r\n\r\n/** 允许的图片格式 */\r\nconst AllowImgExts = ['png', 'jpg', 'jpeg', 'gif', 'bmp', 'svg', 'webp']\r\n\r\nexport default class Upload extends EditorPlug {\r\n  private $imgUploadInput?: HTMLInputElement\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    this.kit.useMounted(() => this.init())\r\n\r\n    this.initDragImg()\r\n  }\r\n\r\n  private init() {\r\n    this.$imgUploadInput = document.createElement('input')\r\n    this.$imgUploadInput.type = 'file'\r\n    this.$imgUploadInput.style.display = 'none'\r\n    this.$imgUploadInput.accept = AllowImgExts.map((o) => `.${o}`).join(',')\r\n\r\n    // TODO: Use btn cannot refresh when mounted event is triggered\r\n    const $btn = this.useBtn(\r\n      `<i aria-label=\"${$t('uploadImage')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" height=\"14\" viewBox=\"0 0 14 14\" width=\"14\"><path d=\"m0 1.94444c0-1.074107.870333-1.94444 1.94444-1.94444h10.11116c1.0741 0 1.9444.870333 1.9444 1.94444v10.11116c0 1.0741-.8703 1.9444-1.9444 1.9444h-10.11116c-1.074107 0-1.94444-.8703-1.94444-1.9444zm1.94444-.38888c-.21466 0-.38888.17422-.38888.38888v7.06689l2.33333-2.33333 2.33333 2.33333 3.88888-3.88889 2.3333 2.33334v-5.51134c0-.21466-.1742-.38888-.3888-.38888zm10.49996 8.09977-2.3333-2.33333-3.88888 3.8889-2.33333-2.33334-2.33333 2.33334v.8447c0 .2146.17422.3888.38888.3888h10.11116c.2146 0 .3888-.1742.3888-.3888zm-7.1944-6.54422c-.75133 0-1.36111.60978-1.36111 1.36111 0 .75134.60978 1.36111 1.36111 1.36111s1.36111-.60977 1.36111-1.36111c0-.75133-.60978-1.36111-1.36111-1.36111z\"/></svg></i>`,\r\n    )\r\n    $btn.after(this.$imgUploadInput)\r\n    $btn.onclick = () => {\r\n      // 选择图片\r\n      const $input = this.$imgUploadInput!\r\n      $input.onchange = () => {\r\n        ;(async () => {\r\n          // 解决阻塞 UI 问题\r\n          if (!$input.files || $input.files.length === 0) return\r\n          const file = $input.files[0]\r\n          this.uploadImg(file)\r\n        })()\r\n      }\r\n      $input.click() // 显示选择图片对话框\r\n    }\r\n\r\n    if (!this.kit.useConf().imgUpload) {\r\n      this.$btn!.setAttribute('atk-only-admin-show', '')\r\n    }\r\n  }\r\n\r\n  private initDragImg() {\r\n    // 统一从 FileList 获取文件并上传图片方法\r\n    const uploadFromFileList = (files?: FileList) => {\r\n      if (!files) return\r\n\r\n      for (let i = 0; i < files.length; i++) {\r\n        const file = files[i]\r\n        this.uploadImg(file)\r\n      }\r\n    }\r\n\r\n    // 拖拽图片\r\n    // @link https://developer.mozilla.org/zh-CN/docs/Web/API/HTML_Drag_and_Drop_API/File_drag_and_drop\r\n    // 阻止浏览器的默认释放行为\r\n    const onDragover = (evt: Event) => {\r\n      evt.stopPropagation()\r\n      evt.preventDefault()\r\n    }\r\n\r\n    const onDrop = (evt: DragEvent) => {\r\n      const files = evt.dataTransfer?.files\r\n      if (files?.length) {\r\n        evt.preventDefault()\r\n        uploadFromFileList(files)\r\n      }\r\n    }\r\n\r\n    // 粘贴图片\r\n    const onPaste = (evt: ClipboardEvent) => {\r\n      const files = evt.clipboardData?.files\r\n      if (files?.length) {\r\n        evt.preventDefault()\r\n        uploadFromFileList(files)\r\n      }\r\n    }\r\n\r\n    this.kit.useMounted(() => {\r\n      this.kit.useUI().$textarea.addEventListener('dragover', onDragover)\r\n      this.kit.useUI().$textarea.addEventListener('drop', onDrop)\r\n      this.kit.useUI().$textarea.addEventListener('paste', onPaste)\r\n    })\r\n    this.kit.useUnmounted(() => {\r\n      this.kit.useUI().$textarea.removeEventListener('dragover', onDragover)\r\n      this.kit.useUI().$textarea.removeEventListener('drop', onDrop)\r\n      this.kit.useUI().$textarea.removeEventListener('paste', onPaste)\r\n    })\r\n  }\r\n\r\n  async uploadImg(file: File) {\r\n    const fileExt = /[^.]+$/.exec(file.name)\r\n    if (!fileExt || !AllowImgExts.includes(String(fileExt[0]).toLowerCase())) return\r\n\r\n    // 未登录提示\r\n    if (!this.kit.useUser().checkHasBasicUserInfo()) {\r\n      this.kit.useEditor().showNotify($t('uploadLoginMsg'), 'w')\r\n      return\r\n    }\r\n\r\n    // 插入图片前换一行\r\n    let insertPrefix = '\\n'\r\n    if (this.kit.useUI().$textarea.value.trim() === '') insertPrefix = ''\r\n\r\n    // 插入占位加载文字\r\n    const uploadPlaceholderTxt = `${insertPrefix}![](Uploading ${file.name}...)`\r\n    this.kit.useEditor().insertContent(uploadPlaceholderTxt)\r\n\r\n    // 上传图片\r\n    let resp: { public_url: string } | undefined\r\n    try {\r\n      const customUploaderFn = this.kit.useConf().imgUploader\r\n      if (!customUploaderFn) {\r\n        // 使用 Artalk 进行图片上传\r\n        resp = (await this.kit.useApi().upload.upload({ file })).data\r\n      } else {\r\n        // 使用自定义的图片上传器\r\n        resp = { public_url: await customUploaderFn(file) }\r\n      }\r\n    } catch (err: any) {\r\n      console.error(err)\r\n      this.kit.useEditor().showNotify(`${$t('uploadFail')}: ${err.message}`, 'e')\r\n    }\r\n    if (!!resp && resp.public_url) {\r\n      let imgURL = resp.public_url as string\r\n\r\n      // 若为相对路径，加上 artalk server\r\n      if (!Utils.isValidURL(imgURL))\r\n        imgURL = Utils.getURLBasedOnApi({\r\n          base: this.kit.useConf().server,\r\n          path: imgURL,\r\n        })\r\n\r\n      // 上传成功插入图片\r\n      this.kit\r\n        .useEditor()\r\n        .setContent(\r\n          this.kit\r\n            .useUI()\r\n            .$textarea.value.replace(uploadPlaceholderTxt, `${insertPrefix}![](${imgURL})`),\r\n        )\r\n    } else {\r\n      // 上传失败删除加载文字\r\n      this.kit\r\n        .useEditor()\r\n        .setContent(this.kit.useUI().$textarea.value.replace(uploadPlaceholderTxt, ''))\r\n    }\r\n  }\r\n}\r\n","import './preview.scss'\r\n\r\nimport EditorPlug from './_plug'\r\nimport type PlugKit from './_kit'\r\nimport * as marked from '@/lib/marked'\r\nimport $t from '@/i18n'\r\n\r\nexport default class Preview extends EditorPlug {\r\n  private isPlugPanelShow = false\r\n\r\n  constructor(kit: PlugKit) {\r\n    super(kit)\r\n\r\n    this.kit.useMounted(() => {\r\n      this.usePanel(`<div class=\"atk-editor-plug-preview\"></div>`)\r\n\r\n      // initialize plug button\r\n      this.useBtn(\r\n        `<i aria-label=\"${$t('preview')}\"><svg fill=\"currentColor\" aria-hidden=\"true\" viewBox=\"0 0 16 16\" width=\"16\" height=\"16\"><path fill-rule=\"evenodd\" d=\"M14.85 3H1.15C.52 3 0 3.52 0 4.15v7.69C0 12.48.52 13 1.15 13h13.69c.64 0 1.15-.52 1.15-1.15v-7.7C16 3.52 15.48 3 14.85 3zM9 11H7V8L5.5 9.92 4 8v3H2V5h2l1.5 2L7 5h2v6zm2.99.5L9.5 8H11V5h2v3h1.5l-2.51 3.5z\"></path></svg></i>`,\r\n      )\r\n    })\r\n    this.kit.useUnmounted(() => {})\r\n\r\n    // function to update content\r\n    this.kit.useEvents().on('content-updated', (content) => {\r\n      this.isPlugPanelShow && this.updateContent()\r\n    })\r\n\r\n    this.usePanelShow(() => {\r\n      this.isPlugPanelShow = true\r\n      this.updateContent()\r\n    })\r\n    this.usePanelHide(() => {\r\n      this.isPlugPanelShow = false\r\n    })\r\n  }\r\n\r\n  updateContent() {\r\n    this.$panel!.innerHTML = this.kit.useEditor().getContentMarked()\r\n  }\r\n}\r\n","import type EditorPlug from './_plug'\r\nimport LocalStorage from './local-storage'\r\nimport Textarea from './textarea'\r\nimport SubmitBtn from './submit-btn'\r\nimport Submit from './submit'\r\nimport StateReply from './state-reply'\r\nimport StateEdit from './state-edit'\r\nimport Closable from './closable'\r\nimport HeaderEvent from './header-event'\r\nimport HeaderUser from './header-user'\r\nimport HeaderLink from './header-link'\r\nimport Mover from './mover'\r\nimport Emoticons from './emoticons'\r\nimport Upload from './upload'\r\nimport Preview from './preview'\r\nimport type { ArtalkConfig } from '@/types'\r\n\r\n/** The default enabled plugs */\r\nconst EDITOR_PLUGS: (typeof EditorPlug)[] = [\r\n  // Core\r\n  LocalStorage,\r\n  HeaderEvent,\r\n  HeaderUser,\r\n  // HeaderLink,\r\n  Textarea,\r\n  Submit,\r\n  SubmitBtn,\r\n  Mover,\r\n  StateReply,\r\n  StateEdit,\r\n  Closable,\r\n\r\n  // Extensions\r\n  Emoticons,\r\n  Upload,\r\n  Preview,\r\n]\r\n\r\n/**\r\n * Get the enabled plugs by config\r\n */\r\nexport function getEnabledPlugs(\r\n  conf: Pick<ArtalkConfig, 'imgUpload' | 'emoticons' | 'preview' | 'editorTravel'>,\r\n): (typeof EditorPlug)[] {\r\n  // The reference map of config and plugs\r\n  // (for check if the plug is enabled)\r\n  const confRefs = new Map<typeof EditorPlug, any>()\r\n  confRefs.set(Upload, conf.imgUpload)\r\n  confRefs.set(Emoticons, conf.emoticons)\r\n  confRefs.set(Preview, conf.preview)\r\n  confRefs.set(Mover, conf.editorTravel)\r\n\r\n  return EDITOR_PLUGS.filter((p) => !confRefs.has(p) || !!confRefs.get(p))\r\n}\r\n","import type { PlugManager } from '../editor-kit'\r\nimport type EditorPlug from './_plug'\r\n\r\n/**\r\n * PlugKit provides a set of methods to help you develop editor plug\r\n */\r\nexport default class PlugKit {\r\n  constructor(private plugs: PlugManager) {}\r\n\r\n  /** Use the editor */\r\n  useEditor() {\r\n    return this.plugs.editor\r\n  }\r\n\r\n  /**\r\n   * Use the context of global\r\n   *\r\n   * @deprecated The calls to this function should be reduced as much as possible\r\n   */\r\n  useGlobalCtx() {\r\n    return this.plugs.editor.ctx\r\n  }\r\n\r\n  /** Use the config of Artalk */\r\n  useConf() {\r\n    return this.plugs.editor.ctx.conf\r\n  }\r\n\r\n  /** Use the http api client */\r\n  useApi() {\r\n    return this.plugs.editor.ctx.getApi()\r\n  }\r\n\r\n  /** Use the user manager */\r\n  useUser() {\r\n    return this.plugs.editor.ctx.get('user')\r\n  }\r\n\r\n  /** Use the ui of editor */\r\n  useUI() {\r\n    return this.plugs.editor.getUI()\r\n  }\r\n\r\n  /** Use the events in editor scope */\r\n  useEvents() {\r\n    return this.plugs.getEvents()\r\n  }\r\n\r\n  /** Listen the event when plug is mounted */\r\n  useMounted(func: () => void) {\r\n    this.useEvents().on('mounted', func)\r\n  }\r\n\r\n  /** Listen the event when plug is unmounted */\r\n  useUnmounted(func: () => void) {\r\n    this.useEvents().on('unmounted', func)\r\n  }\r\n\r\n  /** Use the deps of other plug */\r\n  useDeps<T extends typeof EditorPlug>(plug: T) {\r\n    return this.plugs.get(plug)\r\n  }\r\n}\r\n","import { getEnabledPlugs } from './editor'\r\nimport EditorPlug from './editor/_plug'\r\nimport PlugKit from './editor/_kit'\r\nimport EventManager from '@/lib/event-manager'\r\nimport type { EditorApi, ArtalkPlugin } from '@/types'\r\n\r\nexport interface EditorEventPayloadMap {\r\n  mounted: undefined\r\n  unmounted: undefined\r\n  'header-input': { field: string; $input: HTMLInputElement }\r\n  'header-change': { field: string; $input: HTMLInputElement }\r\n  'content-updated': string\r\n  'panel-show': EditorPlug\r\n  'panel-hide': EditorPlug\r\n  'panel-close': undefined\r\n\r\n  'editor-close': undefined\r\n  'editor-open': undefined\r\n}\r\n\r\nexport const EditorKit: ArtalkPlugin = (ctx) => {\r\n  const editor = ctx.get('editor')\r\n\r\n  const editorPlugs = new PlugManager(editor)\r\n  ctx.inject('editorPlugs', editorPlugs)\r\n}\r\n\r\nexport class PlugManager {\r\n  private plugs: EditorPlug[] = []\r\n  private openedPlug: EditorPlug | null = null\r\n  private events = new EventManager<EditorEventPayloadMap>()\r\n\r\n  getPlugs() {\r\n    return this.plugs\r\n  }\r\n  getEvents() {\r\n    return this.events\r\n  }\r\n\r\n  private clear() {\r\n    this.plugs = []\r\n    this.events = new EventManager()\r\n    if (this.openedPlug) this.closePlugPanel()\r\n  }\r\n\r\n  constructor(public editor: EditorApi) {\r\n    let confLoaded = false // config not loaded at first time\r\n    this.editor.ctx.watchConf(\r\n      ['imgUpload', 'emoticons', 'preview', 'editorTravel', 'locale'],\r\n      (conf) => {\r\n        // trigger unmount event will call all plugs' unmount function\r\n        // (this will only be called while conf reloaded, not be called at first time)\r\n        confLoaded && this.getEvents().trigger('unmounted')\r\n\r\n        // reset the plugs\r\n        this.clear()\r\n\r\n        // init the all enabled plugs\r\n        getEnabledPlugs(conf).forEach((Plug) => {\r\n          // create the plug instance\r\n          const kit = new PlugKit(this)\r\n          this.plugs.push(new Plug(kit))\r\n        })\r\n\r\n        // trigger event for plug initialization\r\n        this.getEvents().trigger('mounted')\r\n        confLoaded = true\r\n\r\n        // refresh the plug UI\r\n        this.loadPluginUI()\r\n      },\r\n    )\r\n\r\n    this.events.on('panel-close', () => this.closePlugPanel())\r\n  }\r\n\r\n  private loadPluginUI() {\r\n    // handle ui, clear and reset the plug btns and plug panels\r\n    this.editor.getUI().$plugPanelWrap.innerHTML = ''\r\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\r\n    this.editor.getUI().$plugBtnWrap.innerHTML = ''\r\n\r\n    // load the plug UI\r\n    this.plugs.forEach((plug) => this.loadPluginItem(plug))\r\n  }\r\n\r\n  /** Load the plug btn and plug panel on editor ui */\r\n  private loadPluginItem(plug: EditorPlug) {\r\n    const $btn = plug.$btn\r\n    if (!$btn) return\r\n    this.editor.getUI().$plugBtnWrap.appendChild($btn)\r\n\r\n    // bind the event when click plug btn\r\n    !$btn.onclick &&\r\n      ($btn.onclick = () => {\r\n        // removing the active class from all the buttons\r\n        this.editor\r\n          .getUI()\r\n          .$plugBtnWrap.querySelectorAll('.active')\r\n          .forEach((item) => item.classList.remove('active'))\r\n\r\n        // if the plug is not the same as the openedPlug,\r\n        if (plug !== this.openedPlug) {\r\n          // then open the plug current clicked plug panel\r\n          this.openPlugPanel(plug)\r\n\r\n          // add active class for current plug panel\r\n          $btn.classList.add('active')\r\n        } else {\r\n          // then close the plug\r\n          this.closePlugPanel()\r\n        }\r\n      })\r\n\r\n    // initialization of plug panel\r\n    const $panel = plug.$panel\r\n    if ($panel) {\r\n      $panel.style.display = 'none'\r\n      this.editor.getUI().$plugPanelWrap.appendChild($panel)\r\n    }\r\n  }\r\n\r\n  get<T extends typeof EditorPlug>(plug: T) {\r\n    return this.plugs.find((p) => p instanceof plug) as InstanceType<T> | undefined\r\n  }\r\n\r\n  /** Open the editor plug panel */\r\n  openPlugPanel(plug: EditorPlug) {\r\n    this.plugs.forEach((aPlug) => {\r\n      const plugPanel = aPlug.$panel\r\n      if (!plugPanel) return\r\n\r\n      if (aPlug === plug) {\r\n        plugPanel.style.display = ''\r\n        this.events.trigger('panel-show', plug)\r\n      } else {\r\n        plugPanel.style.display = 'none'\r\n        this.events.trigger('panel-hide', plug)\r\n      }\r\n    })\r\n\r\n    this.editor.getUI().$plugPanelWrap.style.display = ''\r\n    this.openedPlug = plug\r\n  }\r\n\r\n  /** Close the editor plug panel */\r\n  closePlugPanel() {\r\n    if (!this.openedPlug) return\r\n\r\n    this.editor.getUI().$plugPanelWrap.style.display = 'none'\r\n    this.events.trigger('panel-hide', this.openedPlug)\r\n    this.openedPlug = null\r\n  }\r\n\r\n  /** Get the content which is transformed by plugs */\r\n  getTransformedContent(rawContent: string) {\r\n    let result = rawContent\r\n    this.plugs.forEach((aPlug) => {\r\n      if (!aPlug.contentTransformer) return\r\n      result = aPlug.contentTransformer(result)\r\n    })\r\n    return result\r\n  }\r\n}\r\n","import type { ContextApi, ArtalkPlugin, PageData } from '@/types'\r\nimport $t from '@/i18n'\r\n\r\nexport const WithEditor: ArtalkPlugin = (ctx) => {\r\n  let $closeCommentBtn: HTMLElement | undefined\r\n\r\n  // on Artalk mounted\r\n  // (after all components had mounted)\r\n  ctx.on('mounted', () => {\r\n    const list = ctx.get('list')\r\n\r\n    $closeCommentBtn = list.$el.querySelector<HTMLElement>('[data-action=\"admin-close-comment\"]')!\r\n\r\n    // bind editor close button click event\r\n    $closeCommentBtn.addEventListener('click', () => {\r\n      const page = ctx.getData().getPage()\r\n      if (!page) throw new Error('Page data not found')\r\n\r\n      page.admin_only = !page.admin_only\r\n      adminPageEditSave(ctx, page)\r\n    })\r\n  })\r\n\r\n  // on comment list loaded (it will include page data update)\r\n  ctx.on('page-loaded', (page) => {\r\n    const editor = ctx.get('editor')\r\n\r\n    // if page comment is closed\r\n    if (page?.admin_only === true) {\r\n      // then close editor\r\n      editor.getPlugs()?.getEvents().trigger('editor-close')\r\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('openComment'))\r\n    } else {\r\n      // the open editor\r\n      editor.getPlugs()?.getEvents().trigger('editor-open')\r\n      $closeCommentBtn && ($closeCommentBtn.innerText = $t('closeComment'))\r\n    }\r\n  })\r\n\r\n  ctx.on('list-loaded', (comments) => {\r\n    // 防止评论框被吞\r\n    ctx.editorResetState()\r\n  })\r\n}\r\n\r\n/** 管理员设置页面信息 */\r\nfunction adminPageEditSave(ctx: ContextApi, page: PageData) {\r\n  ctx.editorShowLoading()\r\n  ctx\r\n    .getApi()\r\n    .pages.updatePage(page.id, page)\r\n    .then(({ data }) => {\r\n      ctx.getData().updatePage(data)\r\n    })\r\n    .catch((err) => {\r\n      ctx.editorShowNotify(`${$t('editFail')}: ${err.message || String(err)}`, 'e')\r\n    })\r\n    .finally(() => {\r\n      ctx.editorHideLoading()\r\n    })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport const Unread: ArtalkPlugin = (ctx) => {\r\n  ctx.on('comment-rendered', (comment) => {\r\n    // comment unread highlight\r\n    if (ctx.conf.listUnreadHighlight === true) {\r\n      const notifies = ctx.getData().getNotifies()\r\n      const notify = notifies.find((o) => o.comment_id === comment.getID())\r\n\r\n      if (notify) {\r\n        // if comment contains in unread list\r\n        comment.getRender().setUnread(true)\r\n        comment.getRender().setOpenAction(() => {\r\n          window.open(notify.read_link)\r\n\r\n          // remove notify which has been read\r\n          ctx.getData().updateNotifies(notifies.filter((o) => o.comment_id !== comment.getID()))\r\n        })\r\n      } else {\r\n        // comment not in unread list\r\n        comment.getRender().setUnread(false)\r\n      }\r\n    }\r\n  })\r\n\r\n  ctx.on('list-goto', (commentID) => {\r\n    const notifyKey = Utils.getQueryParam('atk_notify_key')\r\n    if (notifyKey) {\r\n      // mark as read\r\n      ctx\r\n        .getApi()\r\n        .notifies.markNotifyRead(commentID, notifyKey)\r\n        .then(() => {\r\n          // remove from unread list\r\n          ctx.getData().updateNotifies(\r\n            ctx\r\n              .getData()\r\n              .getNotifies()\r\n              .filter((o) => o.comment_id !== commentID),\r\n          )\r\n        })\r\n    }\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\nimport $t from '@/i18n'\r\n\r\nexport const Count: ArtalkPlugin = (ctx) => {\r\n  const refreshCountNumEl = () => {\r\n    const list = ctx.get('list')\r\n\r\n    const $count = list.$el.querySelector('.atk-comment-count .atk-text')\r\n    if (!$count) return\r\n\r\n    const text = Utils.htmlEncode(\r\n      $t('counter', {\r\n        count: `${Number(ctx.getData().getListLastFetch()?.data?.count) || 0}`,\r\n      }),\r\n    )\r\n    $count.innerHTML = text.replace(/(\\d+)/, '<span class=\"atk-comment-count-num\">$1</span>')\r\n  }\r\n\r\n  ctx.on('list-loaded', () => {\r\n    refreshCountNumEl()\r\n  })\r\n\r\n  ctx.on('comment-inserted', () => {\r\n    // 评论数增加 1\r\n    const last = ctx.getData().getListLastFetch()\r\n    if (last?.data) last.data.count += 1\r\n  })\r\n\r\n  ctx.on('comment-deleted', () => {\r\n    // 评论数减 1\r\n    const last = ctx.getData().getListLastFetch()\r\n    if (last?.data) last.data.count -= 1\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\nexport const UnreadBadge: ArtalkPlugin = (ctx) => {\r\n  let $unreadBadge: HTMLElement | null = null\r\n\r\n  const showUnreadBadge = (count: number) => {\r\n    if (!$unreadBadge) return\r\n\r\n    if (count > 0) {\r\n      $unreadBadge.innerText = `${Number(count || 0)}`\r\n      $unreadBadge.style.display = 'block'\r\n    } else {\r\n      $unreadBadge.style.display = 'none'\r\n    }\r\n  }\r\n\r\n  ctx.on('mounted', () => {\r\n    const list = ctx.get('list')\r\n\r\n    $unreadBadge = list.$el.querySelector<HTMLElement>('.atk-unread-badge')\r\n  })\r\n\r\n  ctx.on('notifies-updated', (notifies) => {\r\n    showUnreadBadge(notifies.length || 0)\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\nexport const GotoDispatcher: ArtalkPlugin = (ctx) => {\r\n  let lastID = 0\r\n  const check = ({ locker }: { locker: boolean }) => {\r\n    const commentID = extractCommentID()\r\n    if (!commentID) return\r\n\r\n    if (locker && lastID === commentID) return // if the commentID is the same as the last one, do nothing\r\n    lastID = commentID // record the last commentID\r\n\r\n    ctx.trigger('list-goto', commentID) // trigger event\r\n  }\r\n\r\n  const hashChangeHandler = () => check({ locker: false })\r\n  const listLoadedHandler = () => check({ locker: true })\r\n  ctx.on('mounted', () => {\r\n    window.addEventListener('hashchange', hashChangeHandler)\r\n    ctx.on('list-loaded', listLoadedHandler)\r\n  })\r\n  ctx.on('unmounted', () => {\r\n    window.removeEventListener('hashchange', hashChangeHandler)\r\n    ctx.off('list-loaded', listLoadedHandler)\r\n  })\r\n}\r\n\r\nfunction extractCommentID(): number | null {\r\n  // Try get from hash\r\n  // Hash retrieval priority is higher than query,\r\n  // Because click goto will change hash.\r\n  const match = window.location.hash.match(/#atk-comment-([0-9]+)/)\r\n  let commentId =\r\n    match && match[1] && !Number.isNaN(parseFloat(match[1])) ? parseFloat(match[1]) : null\r\n\r\n  // Fail over to get from query\r\n  if (!commentId) {\r\n    commentId = Number(Utils.getQueryParam('atk_comment')) // same as backend GetReplyLink()\r\n  }\r\n\r\n  return commentId || null\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\nexport const GotoFocus: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-goto', async (commentID) => {\r\n    // find the comment node\r\n    let comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\r\n    if (!comment) {\r\n      // fetch and insert the comment from the server\r\n      const data = (await ctx.getApi().comments.getComment(commentID)).data\r\n      ctx\r\n        .get('list')\r\n        .getListLayout({ forceFlatMode: true })\r\n        .insert(data.comment, data.reply_comment)\r\n      comment = ctx.getCommentNodes().find((c) => c.getID() === commentID)\r\n    }\r\n    if (!comment) return\r\n    comment.focus()\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport { version as ARTALK_VERSION } from '~/package.json'\r\n\r\nexport const Copyright: ArtalkPlugin = (ctx) => {\r\n  ctx.on('mounted', () => {\r\n    const list = ctx.get('list')\r\n\r\n    const $copyright = list.$el.querySelector<HTMLElement>('.atk-copyright')\r\n    if (!$copyright) return\r\n\r\n    $copyright.innerHTML =\r\n      `Powered By <a href=\"https://artalk.js.org\" ` +\r\n      `target=\"_blank\" title=\"Artalk v${ARTALK_VERSION}\">` +\r\n      `Artalk</a>`\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\nimport { sanitize } from '@/lib/sanitizer'\r\n\r\nexport const NoComment: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-loaded', (comments) => {\r\n    const list = ctx.get('list')!\r\n\r\n    // 无评论\r\n    const isNoComment = comments.length <= 0\r\n    let $noComment = list.getCommentsWrapEl().querySelector<HTMLElement>('.atk-list-no-comment')\r\n\r\n    if (isNoComment) {\r\n      if (!$noComment) {\r\n        $noComment = Utils.createElement('<div class=\"atk-list-no-comment\"></div>')\r\n\r\n        // sanitize before set innerHTML\r\n        $noComment.innerHTML = sanitize(list.ctx.conf.noComment || list.ctx.$t('noComment'))\r\n        list.getCommentsWrapEl().appendChild($noComment)\r\n      }\r\n    } else {\r\n      $noComment?.remove()\r\n    }\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\nimport $t from '@/i18n'\r\n\r\nexport const Dropdown: ArtalkPlugin = (ctx) => {\r\n  const reloadUseParamsEditor = (func: (p: any) => void) => {\r\n    ctx.conf.listFetchParamsModifier = func\r\n    ctx.reload()\r\n  }\r\n\r\n  const initDropdown = ($dropdownOn: HTMLElement) => {\r\n    renderDropdown({\r\n      $dropdownWrap: $dropdownOn,\r\n      dropdownList: [\r\n        [\r\n          $t('sortLatest'),\r\n          () => {\r\n            reloadUseParamsEditor((p) => {\r\n              p.sort_by = 'date_desc'\r\n            })\r\n          },\r\n        ],\r\n        [\r\n          $t('sortBest'),\r\n          () => {\r\n            reloadUseParamsEditor((p) => {\r\n              p.sort_by = 'vote'\r\n            })\r\n          },\r\n        ],\r\n        [\r\n          $t('sortOldest'),\r\n          () => {\r\n            reloadUseParamsEditor((p) => {\r\n              p.sort_by = 'date_asc'\r\n            })\r\n          },\r\n        ],\r\n        [\r\n          $t('sortAuthor'),\r\n          () => {\r\n            reloadUseParamsEditor((p) => {\r\n              p.view_only_admin = true\r\n            })\r\n          },\r\n        ],\r\n      ],\r\n    })\r\n  }\r\n\r\n  ctx.watchConf(['listSort', 'locale'], (conf) => {\r\n    const list = ctx.get('list')\r\n\r\n    const $count = list.$el.querySelector<HTMLElement>('.atk-comment-count')\r\n    if (!$count) return\r\n\r\n    // 评论列表排序 Dropdown 下拉选择层\r\n    if (conf.listSort) {\r\n      initDropdown($count)\r\n    } else {\r\n      removeDropdown({\r\n        $dropdownWrap: $count,\r\n      })\r\n    }\r\n  })\r\n}\r\n\r\n/** 评论排序方式选择下拉菜单 */\r\nfunction renderDropdown(conf: {\r\n  $dropdownWrap: HTMLElement\r\n  dropdownList: [string, () => void][]\r\n}) {\r\n  const { $dropdownWrap, dropdownList } = conf\r\n  if ($dropdownWrap.querySelector('.atk-dropdown')) return\r\n\r\n  // 修改 class\r\n  $dropdownWrap.classList.add('atk-dropdown-wrap')\r\n\r\n  // 插入图标\r\n  $dropdownWrap.append(Utils.createElement(`<span class=\"atk-arrow-down-icon\"></span>`))\r\n\r\n  // 列表项点击事件\r\n  let curtActive = 0 // 当前选中\r\n  const onItemClick = (i: number, $item: HTMLElement, name: string, action: () => void) => {\r\n    action()\r\n\r\n    // set active\r\n    curtActive = i\r\n    $dropdown.querySelectorAll('.active').forEach((e) => {\r\n      e.classList.remove('active')\r\n    })\r\n    $item.classList.add('active')\r\n\r\n    // 关闭层 (临时消失，取消 :hover)\r\n    $dropdown.style.display = 'none'\r\n    setTimeout(() => {\r\n      $dropdown.style.display = ''\r\n    }, 80)\r\n  }\r\n\r\n  // 生成列表元素\r\n  const $dropdown = Utils.createElement(`<ul class=\"atk-dropdown atk-fade-in\"></ul>`)\r\n  dropdownList.forEach((item, i) => {\r\n    const [name, action] = item\r\n\r\n    const $item = Utils.createElement(`<li class=\"atk-dropdown-item\"><span></span></li>`)\r\n    const $link = $item.querySelector<HTMLElement>('span')!\r\n    $link.innerText = name\r\n    $link.onclick = () => {\r\n      onItemClick(i, $item, name, action)\r\n    }\r\n    $dropdown.append($item)\r\n\r\n    if (i === curtActive) $item.classList.add('active') // 默认选中项\r\n  })\r\n\r\n  $dropdownWrap.append($dropdown)\r\n}\r\n\r\n/** 删除评论排序方式选择下拉菜单 */\r\nfunction removeDropdown(conf: { $dropdownWrap: HTMLElement }) {\r\n  const { $dropdownWrap } = conf\r\n  $dropdownWrap.classList.remove('atk-dropdown-wrap')\r\n  $dropdownWrap.querySelector('.atk-arrow-down-icon')?.remove()\r\n  $dropdownWrap.querySelector('.atk-dropdown')?.remove()\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\n/** 评论时间自动更新 */\r\nexport const TimeTicking: ArtalkPlugin = (ctx) => {\r\n  let timer: number | null = null\r\n\r\n  ctx.on('mounted', () => {\r\n    timer = window.setInterval(() => {\r\n      const list = ctx.get('list')\r\n\r\n      list.$el.querySelectorAll<HTMLElement>('[data-atk-comment-date]').forEach((el) => {\r\n        const date = el.getAttribute('data-atk-comment-date')\r\n        el.innerText = Utils.timeAgo(new Date(Number(date)), ctx.$t)\r\n      })\r\n    }, 30 * 1000) // 30s 更新一次\r\n  })\r\n\r\n  ctx.on('unmounted', () => {\r\n    timer && window.clearInterval(timer)\r\n  })\r\n}\r\n","import * as Utils from '@/lib/utils'\r\nimport * as Ui from '@/lib/ui'\r\nimport $t from '@/i18n'\r\n\r\nexport interface ErrorDialogOptions {\r\n  $err: HTMLElement\r\n\r\n  errMsg: string\r\n  errData?: any\r\n  retryFn?: () => void\r\n\r\n  onOpenSidebar?: () => void\r\n}\r\n\r\nexport function showErrorDialog(opts: ErrorDialogOptions) {\r\n  const errEl = Utils.createElement(`<span><span class=\"error-message\"></span><br/><br/></span>`)\r\n  errEl.querySelector<HTMLElement>('.error-message')!.innerText =\r\n    `${$t('listLoadFailMsg')}\\n${opts.errMsg}`\r\n\r\n  if (opts.retryFn) {\r\n    const $retryBtn = Utils.createElement(`<span style=\"cursor:pointer;\">${$t('listRetry')}</span>`)\r\n    $retryBtn.onclick = () => opts.retryFn && opts.retryFn()\r\n    errEl.appendChild($retryBtn)\r\n  }\r\n\r\n  if (opts.onOpenSidebar) {\r\n    const $openSidebar = Utils.createElement(\r\n      `<span atk-only-admin-show> | <span style=\"cursor:pointer;\">${$t('openName', { name: $t('ctrlCenter') })}</span></span>`,\r\n    )\r\n    errEl.appendChild($openSidebar)\r\n    $openSidebar.onclick = () => opts.onOpenSidebar && opts.onOpenSidebar()\r\n  }\r\n\r\n  Ui.setError(opts.$err, errEl)\r\n}\r\n","import * as Ui from '../../lib/ui'\r\nimport type { ArtalkPlugin, ContextApi } from '@/types'\r\nimport { showErrorDialog } from '@/components/error-dialog'\r\n\r\nexport const ErrorDialog: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-fetch', () => {\r\n    const list = ctx.get('list')\r\n\r\n    // clear the original error when a new fetch is triggered\r\n    Ui.setError(list.$el, null)\r\n  })\r\n\r\n  ctx.on('list-failed', (err) => {\r\n    showErrorDialog({\r\n      $err: ctx.get('list').$el,\r\n      errMsg: err.msg,\r\n      errData: err.data,\r\n      retryFn: () => ctx.fetch({ offset: 0 }),\r\n    })\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Ui from '@/lib/ui'\r\n\r\nexport const Loading: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-fetch', (p) => {\r\n    const list = ctx.get('list')\r\n\r\n    if (p.offset === 0)\r\n      // only show loading when fetch first page\r\n      Ui.setLoading(true, list.$el)\r\n    // else if not first page, show loading in paginator (code not there)\r\n  })\r\n\r\n  ctx.on('list-fetched', () => {\r\n    const list = ctx.get('list')\r\n    Ui.setLoading(false, list.$el)\r\n  })\r\n}\r\n","import type { ListFetchParams, ArtalkPlugin } from '@/types'\r\n\r\nexport const Fetch: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-fetch', (_params) => {\r\n    if (ctx.getData().getLoading()) return\r\n    ctx.getData().setLoading(true)\r\n\r\n    const params: ListFetchParams = {\r\n      // default params\r\n      offset: 0,\r\n      limit: ctx.conf.pagination.pageSize,\r\n      flatMode: ctx.conf.flatMode as boolean, // always be boolean because had been handled in Artalk.init\r\n      paramsModifier: ctx.conf.listFetchParamsModifier,\r\n      ..._params,\r\n    }\r\n\r\n    // must before other function call\r\n    ctx.getData().setListLastFetch({\r\n      params,\r\n    })\r\n\r\n    // prepare params for request\r\n    const reqParams = {\r\n      limit: params.limit,\r\n      offset: params.offset,\r\n      flat_mode: params.flatMode,\r\n      page_key: ctx.getConf().pageKey,\r\n      site_name: ctx.getConf().site,\r\n    }\r\n\r\n    // call the modifier function\r\n    if (params.paramsModifier) params.paramsModifier(reqParams)\r\n\r\n    // start request\r\n    ctx\r\n      .getApi()\r\n      .comments.getComments({\r\n        ...reqParams,\r\n        ...ctx.getApi().getUserFields(),\r\n      })\r\n      .then(({ data }) => {\r\n        // Must before all other function call and event trigger,\r\n        // because it will depend on the lastData\r\n        // TODO: this is global variable, easy to use, but not good, consider to refactor.\r\n        // refactor work is hard, because it is used in many places.\r\n        ctx.getData().setListLastFetch({ params, data })\r\n\r\n        // 装置评论\r\n        ctx.getData().loadComments(data.comments)\r\n\r\n        // 更新页面数据\r\n        ctx.getData().updatePage(data.page)\r\n\r\n        // trigger events when success\r\n        params.onSuccess && params.onSuccess(data)\r\n\r\n        ctx.trigger('list-fetched', { params, data })\r\n      })\r\n      .catch((e) => {\r\n        // 显示错误对话框\r\n        const error = {\r\n          msg: e.msg || String(e),\r\n          data: e.data,\r\n        }\r\n\r\n        params.onError && params.onError(error)\r\n\r\n        // trigger events when error\r\n        ctx.trigger('list-failed', error)\r\n        ctx.trigger('list-fetched', { params, error })\r\n\r\n        throw e\r\n      })\r\n      .finally(() => {\r\n        ctx.getData().setLoading(false)\r\n      })\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\nexport const ReachBottom: ArtalkPlugin = (ctx) => {\r\n  let observer: IntersectionObserver | null = null\r\n\r\n  const setupObserver = ($target: HTMLElement) => {\r\n    const scrollEvtAt = (ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()) || null\r\n\r\n    observer = new IntersectionObserver(\r\n      ([entries]) => {\r\n        if (entries.isIntersecting) {\r\n          clearObserver() // clear before trigger event to avoid trigger twice `list-reach-bottom`\r\n\r\n          // note that this event will be triggered only once\r\n          // until the next list is loaded\r\n          ctx.trigger('list-reach-bottom')\r\n        }\r\n      },\r\n      {\r\n        threshold: 0.9, // when the target is 90% visible\r\n\r\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver/root\r\n        // If the root is null, then the bounds of the actual document viewport are used.\r\n        root: scrollEvtAt,\r\n      },\r\n    )\r\n    observer.observe($target)\r\n  }\r\n\r\n  const clearObserver = () => {\r\n    observer?.disconnect()\r\n    observer = null\r\n  }\r\n\r\n  ctx.on('list-loaded', () => {\r\n    clearObserver()\r\n\r\n    const list = ctx.get('list')\r\n\r\n    // get the second last child\r\n    const children = list.getCommentsWrapEl().childNodes\r\n    const $target = children.length > 2 ? (children[children.length - 2] as HTMLElement) : null\r\n    if (!$target) return\r\n\r\n    // check IntersectionObserver support\r\n    if (!('IntersectionObserver' in window)) {\r\n      console.warn('IntersectionObserver api not supported')\r\n      return\r\n    }\r\n\r\n    // use IntersectionObserver to detect reach bottom\r\n    setupObserver($target)\r\n  })\r\n\r\n  ctx.on('unmounted', () => {\r\n    clearObserver()\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport * as Utils from '@/lib/utils'\r\n\r\n/** List scroll to the first comment */\r\nexport const GotoFirst: ArtalkPlugin = (ctx) => {\r\n  const handler = () => {\r\n    const list = ctx.get('list')\r\n\r\n    const $relative = ctx.conf.scrollRelativeTo && ctx.conf.scrollRelativeTo()\r\n    ;($relative || window).scroll({\r\n      top: Utils.getOffset(list.$el, $relative).top,\r\n      left: 0,\r\n    })\r\n  }\r\n\r\n  ctx.on('mounted', () => {\r\n    ctx.on('list-goto-first', handler)\r\n  })\r\n\r\n  ctx.on('unmounted', () => {\r\n    ctx.off('list-goto-first', handler)\r\n  })\r\n}\r\n","import { WithEditor } from './with-editor'\r\nimport { Unread } from './unread'\r\nimport { Count } from './count'\r\nimport { SidebarBtn } from './sidebar-btn'\r\nimport { UnreadBadge } from './unread-badge'\r\nimport { GotoDispatcher } from './goto-dispatcher'\r\nimport { GotoFocus } from './goto-focus'\r\nimport { Copyright } from './copyright'\r\nimport { NoComment } from './no-comment'\r\nimport { Dropdown } from './dropdown'\r\nimport { TimeTicking } from './time-ticking'\r\nimport { ErrorDialog } from './error-dialog'\r\nimport { Loading } from './loading'\r\nimport { Fetch } from './fetch'\r\nimport { ReachBottom } from './reach-bottom'\r\nimport { GotoFirst } from './goto-first'\r\nimport type { ArtalkPlugin } from '@/types'\r\n\r\nconst ListPlugins: ArtalkPlugin[] = [\r\n  Fetch,\r\n  Loading,\r\n  Unread,\r\n  WithEditor,\r\n  Count,\r\n  // SidebarBtn,\r\n  UnreadBadge,\r\n  Dropdown,\r\n  GotoDispatcher,\r\n  GotoFocus,\r\n  NoComment,\r\n  Copyright,\r\n  TimeTicking,\r\n  ErrorDialog,\r\n  ReachBottom,\r\n  GotoFirst,\r\n]\r\n\r\nexport { ListPlugins }\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\nexport const Notifies: ArtalkPlugin = (ctx) => {\r\n  ctx.on('list-fetch', (params) => {\r\n    if (params.offset !== 0) return\r\n\r\n    const user = ctx.getApi().getUserFields()\r\n    if (!user) return\r\n\r\n    // Fetch all unread notifies\r\n    ctx\r\n      .getApi()\r\n      .notifies.getNotifies(user)\r\n      .then((res) => {\r\n        ctx.getData().updateNotifies(res.data.notifies)\r\n      })\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\nimport { version as ARTALK_VERSION } from '~/package.json'\r\nimport type List from '~/src/list/list'\r\nimport * as Ui from '@/lib/ui'\r\nimport * as Utils from '@/lib/utils'\r\nimport $t from '@/i18n'\r\n\r\nlet IgnoreVersionCheck = false\r\n\r\nexport const VersionCheck: ArtalkPlugin = (ctx) => {\r\n  ctx.watchConf(['apiVersion', 'versionCheck'], (conf) => {\r\n    const list = ctx.get('list')\r\n    if (conf.apiVersion && conf.versionCheck && !IgnoreVersionCheck)\r\n      versionCheck(list, ARTALK_VERSION, conf.apiVersion)\r\n  })\r\n}\r\n\r\nfunction versionCheck(list: List, feVer: string, beVer: string) {\r\n  const comp = Utils.versionCompare(feVer, beVer)\r\n  const sameVer = comp === 0\r\n  if (sameVer) return\r\n\r\n  const errEl = Utils.createElement(\r\n    `<div class=\"atk-version-check-notice\">${$t('updateMsg', {\r\n      name: comp < 0 ? $t('frontend') : $t('backend'),\r\n    })} <span class=\"atk-info\">` +\r\n      `${$t('currentVersion')}: ${$t('frontend')} ${feVer} / ${$t('backend')} ${beVer}` +\r\n      `</span></div>`,\r\n  )\r\n  const ignoreBtn = Utils.createElement(`<span class=\"atk-ignore-btn\">${$t('ignore')}</span>`)\r\n  ignoreBtn.onclick = () => {\r\n    errEl.remove()\r\n    IgnoreVersionCheck = true\r\n  }\r\n  errEl.append(ignoreBtn)\r\n  list.$el.parentElement!.prepend(errEl)\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\nexport const AdminOnlyElem: ArtalkPlugin = (ctx) => {\r\n  const scanApply = () => {\r\n    applyAdminOnlyEls(\r\n      ctx.get('user').getData().isAdmin,\r\n      getAdminOnlyEls({\r\n        $root: ctx.$root,\r\n      }),\r\n    )\r\n  }\r\n\r\n  ctx.on('list-loaded', () => {\r\n    scanApply()\r\n  })\r\n\r\n  ctx.on('user-changed', (user) => {\r\n    scanApply()\r\n  })\r\n}\r\n\r\nfunction getAdminOnlyEls(opts: { $root: HTMLElement }): HTMLElement[] {\r\n  const els: HTMLElement[] = []\r\n\r\n  // elements in $root\r\n  opts.$root\r\n    .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\r\n    .forEach((item) => els.push(item))\r\n\r\n  // TODO: provide a Artalk.conf hook to set whitelist of admin-only elements,\r\n  // and move following code to that hook (move into @artalk/artalk-sidebar)\r\n\r\n  // elements in sidebar\r\n  const $sidebarEl = document.querySelector<HTMLElement>('.atk-sidebar')\r\n  if ($sidebarEl)\r\n    $sidebarEl\r\n      .querySelectorAll<HTMLElement>(`[atk-only-admin-show]`)\r\n      .forEach((item) => els.push(item))\r\n\r\n  return els\r\n}\r\n\r\nfunction applyAdminOnlyEls(isAdmin: boolean, els: HTMLElement[]) {\r\n  els.forEach(($item: HTMLElement) => {\r\n    if (isAdmin) $item.classList.remove('atk-hide')\r\n    else $item.classList.add('atk-hide')\r\n  })\r\n}\r\n","import type { ArtalkPlugin } from '@/types'\r\n\r\n// Notice: Singleton pattern needs to be loaded as lazy as possible,\r\n//         because the SSG application does not have a `window` context.\r\nlet darkModeMedia: MediaQueryList | undefined\r\n\r\nfunction updateClassnames($els: HTMLElement[], darkMode: boolean) {\r\n  const DarkModeClassName = 'atk-dark-mode'\r\n\r\n  $els.forEach(($el) => {\r\n    if (darkMode) $el.classList.add(DarkModeClassName)\r\n    else $el.classList.remove(DarkModeClassName)\r\n  })\r\n}\r\n\r\nexport const DarkMode: ArtalkPlugin = (ctx) => {\r\n  // the handler bind to Artalk instance, don't forget to remove it when Artalk instance destroyed\r\n  let darkModeAutoHandler: ((evt: MediaQueryListEvent) => void) | undefined\r\n\r\n  const sync = (darkMode: boolean | 'auto') => {\r\n    // the elements that classnames need to be updated when darkMode changed\r\n    const $els = [ctx.$root, ctx.get('layerManager').getEl()]\r\n\r\n    // init darkModeMedia if not exists, and only create once\r\n    if (!darkModeMedia) {\r\n      darkModeMedia = window.matchMedia('(prefers-color-scheme: dark)')\r\n    }\r\n\r\n    if (darkMode === 'auto') {\r\n      // if darkMode is 'auto', add handler\r\n      if (!darkModeAutoHandler) {\r\n        // the handler that will be called when darkModeMedia changed\r\n        darkModeAutoHandler = (evt) => updateClassnames($els, evt.matches)\r\n        darkModeMedia.addEventListener('change', darkModeAutoHandler)\r\n      }\r\n\r\n      // update classnames immediately\r\n      updateClassnames($els, darkModeMedia.matches)\r\n    } else {\r\n      // if darkMode is boolean, remove handler\r\n      if (darkModeAutoHandler) {\r\n        darkModeMedia.removeEventListener('change', darkModeAutoHandler)\r\n        darkModeAutoHandler = undefined\r\n      }\r\n\r\n      // update classnames immediately\r\n      updateClassnames($els, darkMode)\r\n    }\r\n  }\r\n\r\n  ctx.watchConf(['darkMode'], (conf) => sync(conf.darkMode))\r\n  ctx.on('created', () => sync(ctx.conf.darkMode))\r\n  ctx.on('unmounted', () => {\r\n    // if handler exists, don't forget to remove it, or it will cause memory leak\r\n    darkModeAutoHandler && darkModeMedia?.removeEventListener('change', darkModeAutoHandler)\r\n    darkModeAutoHandler = undefined\r\n  })\r\n}\r\n","import { Markdown } from './markdown'\r\nimport { EditorKit } from './editor-kit'\r\nimport { ListPlugins } from './list'\r\nimport { Notifies } from './notifies'\r\nimport { PvCountWidget } from './stat'\r\nimport { VersionCheck } from './version-check'\r\nimport { AdminOnlyElem } from './admin-only-elem'\r\nimport { DarkMode } from './dark-mode'\r\nimport type { ArtalkPlugin } from '@/types'\r\n\r\nexport const DefaultPlugins: ArtalkPlugin[] = [\r\n  Markdown,\r\n  EditorKit,\r\n  AdminOnlyElem,\r\n  ...ListPlugins,\r\n  Notifies,\r\n  PvCountWidget,\r\n  VersionCheck,\r\n  DarkMode,\r\n]\r\n","import { DefaultPlugins } from './plugins'\r\nimport type { ArtalkConfig, ArtalkPlugin, ContextApi } from '@/types'\r\nimport { handleConfFormServer } from '@/config'\r\nimport { showErrorDialog } from '@/components/error-dialog'\r\n\r\n/**\r\n * Global Plugins for all Artalk instances\r\n */\r\nexport const GlobalPlugins: Set<ArtalkPlugin> = new Set([...DefaultPlugins])\r\n\r\n/**\r\n * Plugin options for plugin initialization\r\n */\r\nexport const PluginOptions: WeakMap<ArtalkPlugin, any> = new WeakMap()\r\n\r\nexport async function load(ctx: ContextApi) {\r\n  const loadedPlugins = new Set<ArtalkPlugin>()\r\n  const loadPlugins = (plugins: Set<ArtalkPlugin>) => {\r\n    plugins.forEach((plugin) => {\r\n      if (typeof plugin === 'function' && !loadedPlugins.has(plugin)) {\r\n        plugin(ctx, PluginOptions.get(plugin))\r\n        loadedPlugins.add(plugin)\r\n      }\r\n    })\r\n  }\r\n\r\n  // Load local plugins\r\n  loadPlugins(GlobalPlugins)\r\n\r\n  // Get conf from server\r\n  const { data } = await ctx\r\n    .getApi()\r\n    .conf.conf()\r\n    .catch((err) => {\r\n      onLoadErr(ctx, err)\r\n      throw err\r\n    })\r\n\r\n  // Initial config\r\n  let conf: Partial<ArtalkConfig> = {\r\n    apiVersion: data.version?.version, // version info\r\n  }\r\n\r\n  // Reference conf from backend\r\n  if (ctx.conf.useBackendConf) {\r\n    if (!data.frontend_conf)\r\n      throw new Error(\r\n        'The remote backend does not respond to the frontend conf, but `useBackendConf` conf is enabled',\r\n      )\r\n    conf = { ...conf, ...handleConfFormServer(data.frontend_conf) }\r\n  }\r\n\r\n  // Apply conf modifier\r\n  ctx.conf.remoteConfModifier && ctx.conf.remoteConfModifier(conf)\r\n\r\n  // Dynamically load network plugins\r\n  conf.pluginURLs &&\r\n    (await loadNetworkPlugins(conf.pluginURLs, ctx.conf.server)\r\n      .then((plugins) => {\r\n        loadPlugins(plugins)\r\n      })\r\n      .catch((err) => {\r\n        console.error('Failed to load plugin', err)\r\n      }))\r\n\r\n  // After all plugins are loaded\r\n  ctx.trigger('created')\r\n\r\n  // Apply conf updating\r\n  ctx.updateConf(conf)\r\n\r\n  // Trigger mounted event\r\n  ctx.trigger('mounted')\r\n\r\n  // Load comment list\r\n  if (!ctx.conf.remoteConfModifier) {\r\n    // only auto fetch when no remoteConfModifier\r\n    ctx.fetch({ offset: 0 })\r\n  }\r\n}\r\n\r\n/**\r\n * Dynamically load plugins from Network\r\n */\r\nasync function loadNetworkPlugins(scripts: string[], apiBase: string): Promise<Set<ArtalkPlugin>> {\r\n  const networkPlugins = new Set<ArtalkPlugin>()\r\n  if (!scripts || !Array.isArray(scripts)) return networkPlugins\r\n\r\n  const tasks: Promise<void>[] = []\r\n\r\n  scripts.forEach((url) => {\r\n    // check url valid\r\n    if (!/^(http|https):\\/\\//.test(url))\r\n      url = `${apiBase.replace(/\\/$/, '')}/${url.replace(/^\\//, '')}`\r\n\r\n    tasks.push(\r\n      new Promise<void>((resolve, reject) => {\r\n        // check if loaded\r\n        if (document.querySelector(`script[src=\"${url}\"]`)) {\r\n          resolve()\r\n          return\r\n        }\r\n\r\n        // load script\r\n        const script = document.createElement('script')\r\n        script.src = url\r\n        document.head.appendChild(script)\r\n        script.onload = () => resolve()\r\n        script.onerror = (err) => reject(err)\r\n      }),\r\n    )\r\n  })\r\n\r\n  await Promise.all(tasks)\r\n\r\n  // Read ArtalkPlugins object from window\r\n  Object.values(window.ArtalkPlugins || {}).forEach((plugin) => {\r\n    if (typeof plugin === 'function') networkPlugins.add(plugin)\r\n  })\r\n\r\n  return networkPlugins\r\n}\r\n\r\nexport function onLoadErr(ctx: ContextApi, err: any) {\r\n  let sidebarOpenView = ''\r\n\r\n  // if response err_no_site, modify the sidebar open view to create site\r\n  if (err.data?.err_no_site) {\r\n    const viewLoadParam = {\r\n      create_name: ctx.conf.site,\r\n      create_urls: `${window.location.protocol}//${window.location.host}`,\r\n    }\r\n    sidebarOpenView = `sites|${JSON.stringify(viewLoadParam)}`\r\n  }\r\n\r\n  showErrorDialog({\r\n    $err: ctx.get('list').$el,\r\n    errMsg: err.msg || String(err),\r\n    errData: err.data,\r\n    retryFn: () => load(ctx),\r\n    onOpenSidebar: ctx.get('user').getData().isAdmin\r\n      ? () =>\r\n          ctx.showSidebar({\r\n            view: sidebarOpenView as any,\r\n          })\r\n      : undefined, // only show open sidebar button when user is admin\r\n  })\r\n}\r\n","import './style/main.scss'\r\n\r\nimport type { EventHandler } from './lib/event-manager'\r\nimport Context from './context'\r\nimport { handelCustomConf, convertApiOptions } from './config'\r\nimport Services from './service'\r\nimport * as Stat from './plugins/stat'\r\nimport { Api } from './api'\r\nimport type { TInjectedServices } from './service'\r\nimport { GlobalPlugins, PluginOptions, load } from './load'\r\nimport type { ArtalkConfig, EventPayloadMap, ArtalkPlugin, ContextApi } from '@/types'\r\n\r\n/**\r\n * Artalk\r\n *\r\n * @see https://artalk.js.org\r\n */\r\nexport default class Artalk {\r\n  public ctx!: ContextApi\r\n\r\n  constructor(conf: Partial<ArtalkConfig>) {\r\n    // Init Config\r\n    const handledConf = handelCustomConf(conf, true)\r\n\r\n    // Init Context\r\n    this.ctx = new Context(handledConf)\r\n\r\n    // Init Services\r\n    Object.entries(Services).forEach(([name, initService]) => {\r\n      const obj = initService(this.ctx)\r\n      obj && this.ctx.inject(name as keyof TInjectedServices, obj) // auto inject deps to ctx\r\n    })\r\n\r\n    if (import.meta.env.DEV && import.meta.env.VITEST) {\r\n      global.devLoadArtalk = () => load(this.ctx)\r\n    } else {\r\n      load(this.ctx)\r\n    }\r\n  }\r\n\r\n  /** Get the config of Artalk */\r\n  public getConf() {\r\n    return this.ctx.getConf()\r\n  }\r\n\r\n  /** Get the root element of Artalk */\r\n  public getEl() {\r\n    return this.ctx.$root\r\n  }\r\n\r\n  /** Update config of Artalk */\r\n  public update(conf: Partial<ArtalkConfig>) {\r\n    this.ctx.updateConf(conf)\r\n    return this\r\n  }\r\n\r\n  /** Reload comment list of Artalk */\r\n  public reload() {\r\n    this.ctx.reload()\r\n  }\r\n\r\n  /** Destroy instance of Artalk */\r\n  public destroy() {\r\n    this.ctx.trigger('unmounted')\r\n    while (this.ctx.$root.firstChild) {\r\n      this.ctx.$root.removeChild(this.ctx.$root.firstChild)\r\n    }\r\n  }\r\n\r\n  /** Add an event listener */\r\n  public on<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\r\n    this.ctx.on(name, handler)\r\n  }\r\n\r\n  /** Remove an event listener */\r\n  public off<K extends keyof EventPayloadMap>(name: K, handler: EventHandler<EventPayloadMap[K]>) {\r\n    this.ctx.off(name, handler)\r\n  }\r\n\r\n  /** Trigger an event */\r\n  public trigger<K extends keyof EventPayloadMap>(name: K, payload?: EventPayloadMap[K]) {\r\n    this.ctx.trigger(name, payload)\r\n  }\r\n\r\n  /** Set dark mode */\r\n  public setDarkMode(darkMode: boolean) {\r\n    this.ctx.setDarkMode(darkMode)\r\n  }\r\n\r\n  // ===========================\r\n  //       Static Members\r\n  // ===========================\r\n\r\n  /** Init Artalk */\r\n  public static init(conf: Partial<ArtalkConfig>): Artalk {\r\n    return new Artalk(conf)\r\n  }\r\n\r\n  /** Use plugin, the plugin will be used when Artalk.init */\r\n  public static use<T = any>(plugin: ArtalkPlugin<T>, options?: T) {\r\n    GlobalPlugins.add(plugin)\r\n    PluginOptions.set(plugin, options)\r\n  }\r\n\r\n  /** Load count widget */\r\n  public static loadCountWidget(c: Partial<ArtalkConfig>) {\r\n    const conf = handelCustomConf(c, true)\r\n\r\n    Stat.initCountWidget({\r\n      getApi: () => new Api(convertApiOptions(conf)),\r\n      siteName: conf.site,\r\n      countEl: conf.countEl,\r\n      pvEl: conf.pvEl,\r\n      pageKeyAttr: conf.statPageKeyAttr,\r\n      pvAdd: false,\r\n    })\r\n  }\r\n\r\n  // ===========================\r\n  //         Deprecated\r\n  // ===========================\r\n\r\n  /** @deprecated Please use `getEl()` instead */\r\n  public get $root() {\r\n    return this.ctx.$root\r\n  }\r\n\r\n  /** @description Please use `getConf()` instead */\r\n  public get conf() {\r\n    return this.ctx.getConf()\r\n  }\r\n}\r\n","import Artalk from './artalk'\r\nimport type * as ArtalkType from './types'\r\n\r\nexport type * from './types'\r\nexport { ArtalkType }\r\n\r\nexport default Artalk\r\n\r\n// Expose the static methods from the Artalk class\r\n// because direct export of static methods is not supported\r\n// for adapting to different environments like CommonJS and browser IIFE\r\n// for example, we can use `Artalk.init()` rather than `Artalk.default.init()`\r\n// therefore, we need to manually expose the static methods in the Artalk class.\r\nexport const init = Artalk.init\r\nexport const use = Artalk.use\r\nexport const loadCountWidget = Artalk.loadCountWidget\r\n"],"names":["abortController","data","Fetch","init","Api","ApiV2","html","link","list","t","tag","text","block","parser","tokens","args","ret","src","marked","lowercase","toMap","require$$0","attributes","elements","he","require$$1","require$$3","require$$2","sanitizer","start","defaults","require$$4","insane","global","this","module","index","libMarked","Utils.htmlEncode","Defaults","I18n.t","marked.getInstance","Utils.createElement","$t","Ui.showLoading","Ui.hideLoading","render.iframeBody","render.imgBody","Ui.scrollIntoView","Utils.getURLBasedOnApi","ListNest.makeNestCommentNodeList","version","Utils.getHeight","render","Ui.playFadeInAnim","Avatar","Header","Content","ReplyAt","ReplyTo","Pending","Actions","HeightLimit.check","HeightLimit.disposeHeightLimit","CommentUI","Utils.getGravatarURL","Utils.timeAgo","UADetect","instance","PaginationComponent","Ui.getScrollBarWidth","I18n.setLocale","marked.initMarked","marked.setReplacers","Utils.getCorrectUserAgent","Ui.setError","Utils.isValidURL","Utils.getQueryParam","check","ARTALK_VERSION","Ui.setLoading","Utils.getOffset","Utils.versionCompare","Services","Stat.initCountWidget"],"mappings":"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","x_google_ignoreList":[4,5,6,7,8,9,10,11,12,13,14,16]}